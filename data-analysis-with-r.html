<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Data Analysis with R | R Manual</title>
  <meta name="description" content="R and Manul" />
  <meta name="generator" content="bookdown 0.30 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Data Analysis with R | R Manual" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/fig/MWULogo.jpeg" />
  <meta property="og:description" content="R and Manul" />
  <meta name="github-repo" content="Chapter 3 Data Analysis with R | R Manual" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Data Analysis with R | R Manual" />
  
  <meta name="twitter:description" content="R and Manul" />
  <meta name="twitter:image" content="/fig/MWULogo.jpeg" />



<meta name="date" content="2022-11-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-cleaning-with-openrefine.html"/>
<link rel="next" href="data-visualization-with-r.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.1.1/leaflet-providers-plugin.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software-information-and-conventions"><i class="fa fa-check"></i>Software information and conventions</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="data-organization-with-spreadsheet.html"><a href="data-organization-with-spreadsheet.html"><i class="fa fa-check"></i><b>1</b> Data Organization with Spreadsheet</a>
<ul>
<li class="chapter" data-level="1.1" data-path="data-organization-with-spreadsheet.html"><a href="data-organization-with-spreadsheet.html#spreadsheet-programs"><i class="fa fa-check"></i><b>1.1</b> Spreadsheet Programs</a></li>
<li class="chapter" data-level="1.2" data-path="data-organization-with-spreadsheet.html"><a href="data-organization-with-spreadsheet.html#formatting-data-tables"><i class="fa fa-check"></i><b>1.2</b> Formatting data tables</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="data-organization-with-spreadsheet.html"><a href="data-organization-with-spreadsheet.html#problems-with-spreadsheets"><i class="fa fa-check"></i><b>1.2.1</b> Problems with Spreadsheets</a></li>
<li class="chapter" data-level="1.2.2" data-path="data-organization-with-spreadsheet.html"><a href="data-organization-with-spreadsheet.html#use-of-spreadsheets-for-data-entery-and-cleaning"><i class="fa fa-check"></i><b>1.2.2</b> Use of Spreadsheets for Data Entery and Cleaning</a></li>
<li class="chapter" data-level="1.2.3" data-path="data-organization-with-spreadsheet.html"><a href="data-organization-with-spreadsheet.html#keeping-track-of-your-analyses"><i class="fa fa-check"></i><b>1.2.3</b> Keeping track of your analyses</a></li>
<li class="chapter" data-level="1.2.4" data-path="data-organization-with-spreadsheet.html"><a href="data-organization-with-spreadsheet.html#structuring-data-in-spreadsheets"><i class="fa fa-check"></i><b>1.2.4</b> Structuring data in spreadsheets</a></li>
<li class="chapter" data-level="1.2.5" data-path="data-organization-with-spreadsheet.html"><a href="data-organization-with-spreadsheet.html#columns-for-variables-and-rows-for-observations"><i class="fa fa-check"></i><b>1.2.5</b> Columns for variables and rows for observations</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="data-organization-with-spreadsheet.html"><a href="data-organization-with-spreadsheet.html#common-spreadsheet-errors"><i class="fa fa-check"></i><b>1.3</b> Common Spreadsheet Errors</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="data-organization-with-spreadsheet.html"><a href="data-organization-with-spreadsheet.html#using-multiple-tabs"><i class="fa fa-check"></i><b>1.3.1</b> Using multiple tabs</a></li>
<li class="chapter" data-level="1.3.2" data-path="data-organization-with-spreadsheet.html"><a href="data-organization-with-spreadsheet.html#not-filling-in-zeros"><i class="fa fa-check"></i><b>1.3.2</b> Not filling in zeros</a></li>
<li class="chapter" data-level="1.3.3" data-path="data-organization-with-spreadsheet.html"><a href="data-organization-with-spreadsheet.html#using-problematic-null-values"><i class="fa fa-check"></i><b>1.3.3</b> Using problematic null values</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="data-organization-with-spreadsheet.html"><a href="data-organization-with-spreadsheet.html#date-as-data"><i class="fa fa-check"></i><b>1.4</b> Date as data</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html"><i class="fa fa-check"></i><b>2</b> Data Cleaning with OpenRefine</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#layout"><i class="fa fa-check"></i><b>2.1</b> Layout</a></li>
<li class="chapter" data-level="2.2" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#records-and-rows"><i class="fa fa-check"></i><b>2.2</b> Records and Rows</a></li>
<li class="chapter" data-level="2.3" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#changing-the-grid-view"><i class="fa fa-check"></i><b>2.3</b> Changing the Grid View</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#permanent-changes"><i class="fa fa-check"></i><b>2.3.1</b> Permanent Changes</a></li>
<li class="chapter" data-level="2.3.2" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#non-permanent-changes"><i class="fa fa-check"></i><b>2.3.2</b> Non-Permanent Changes</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#data-mining-and-discovery"><i class="fa fa-check"></i><b>2.4</b> Data Mining and Discovery</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#reordering-columns"><i class="fa fa-check"></i><b>2.4.1</b> Reordering Columns</a></li>
<li class="chapter" data-level="2.4.2" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#sorting-data"><i class="fa fa-check"></i><b>2.4.2</b> Sorting Data</a></li>
<li class="chapter" data-level="2.4.3" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#text-based-discovery"><i class="fa fa-check"></i><b>2.4.3</b> Text Based Discovery</a></li>
<li class="chapter" data-level="2.4.4" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#number-and-data-based-discovery"><i class="fa fa-check"></i><b>2.4.4</b> Number and Data Based Discovery</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#data-preparation-and-normalization"><i class="fa fa-check"></i><b>2.5</b> Data Preparation and Normalization</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#common-transformations"><i class="fa fa-check"></i><b>2.5.1</b> Common Transformations</a></li>
<li class="chapter" data-level="2.5.2" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#removing-duplicates"><i class="fa fa-check"></i><b>2.5.2</b> Removing Duplicates</a></li>
<li class="chapter" data-level="2.5.3" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#splitting-cell-values"><i class="fa fa-check"></i><b>2.5.3</b> Splitting Cell Values</a></li>
<li class="chapter" data-level="2.5.4" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#combining-cell-values"><i class="fa fa-check"></i><b>2.5.4</b> Combining cell Values</a></li>
<li class="chapter" data-level="2.5.5" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#data-shaping"><i class="fa fa-check"></i><b>2.5.5</b> Data Shaping</a></li>
<li class="chapter" data-level="2.5.6" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#clustering"><i class="fa fa-check"></i><b>2.5.6</b> Clustering</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#how-to-cluster"><i class="fa fa-check"></i><b>2.6</b> How to Cluster</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html"><i class="fa fa-check"></i><b>3</b> Data Analysis with R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#what-is-r-what-is-rstudio"><i class="fa fa-check"></i><b>3.1</b> What is R? What is RStudio?</a></li>
<li class="chapter" data-level="3.2" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#why-learn-r"><i class="fa fa-check"></i><b>3.2</b> Why learn R?</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#r-does-not-involve-lots-of-pointing-and-clicking-and-thats-a-good-thing"><i class="fa fa-check"></i><b>3.2.1</b> R does not involve lots of pointing and clicking, and that’s a good thing</a></li>
<li class="chapter" data-level="3.2.2" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#r-code-is-great-for-reproducibility"><i class="fa fa-check"></i><b>3.2.2</b> R code is great for reproducibility</a></li>
<li class="chapter" data-level="3.2.3" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#r-is-interdisciplinary-and-extensible"><i class="fa fa-check"></i><b>3.2.3</b> R is interdisciplinary and extensible</a></li>
<li class="chapter" data-level="3.2.4" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#r-works-on-data-of-all-shapes-and-sizes"><i class="fa fa-check"></i><b>3.2.4</b> R works on data of all shapes and sizes</a></li>
<li class="chapter" data-level="3.2.5" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#r-produces-high-quality-graphics"><i class="fa fa-check"></i><b>3.2.5</b> R produces high-quality graphics</a></li>
<li class="chapter" data-level="3.2.6" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#r-has-a-large-and-welcoming-community"><i class="fa fa-check"></i><b>3.2.6</b> R has a large and welcoming community</a></li>
<li class="chapter" data-level="3.2.7" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#not-only-is-r-free-but-it-is-also-open-source-and-cross-platform"><i class="fa fa-check"></i><b>3.2.7</b> Not only is R free, but it is also open-source and cross-platform</a></li>
<li class="chapter" data-level="3.2.8" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#knowing-your-way-around-rstudio"><i class="fa fa-check"></i><b>3.2.8</b> Knowing your way around RStudio</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#introduction-to-r"><i class="fa fa-check"></i><b>3.3</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#comments"><i class="fa fa-check"></i><b>3.3.1</b> Comments</a></li>
<li class="chapter" data-level="3.3.2" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#functions-and-their-arguments"><i class="fa fa-check"></i><b>3.3.2</b> Functions and their arguments</a></li>
<li class="chapter" data-level="3.3.3" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#data-structure"><i class="fa fa-check"></i><b>3.3.3</b> Data Structure</a></li>
<li class="chapter" data-level="3.3.4" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#subsetting-vectors"><i class="fa fa-check"></i><b>3.3.4</b> Subsetting vectors</a></li>
<li class="chapter" data-level="3.3.5" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#conditional-subsetting"><i class="fa fa-check"></i><b>3.3.5</b> Conditional subsetting</a></li>
<li class="chapter" data-level="3.3.6" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#missing-data"><i class="fa fa-check"></i><b>3.3.6</b> Missing Data</a></li>
<li class="chapter" data-level="3.3.7" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#matrices"><i class="fa fa-check"></i><b>3.3.7</b> Matrices</a></li>
<li class="chapter" data-level="3.3.8" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#data-frames"><i class="fa fa-check"></i><b>3.3.8</b> Data Frames</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#starting-with-data"><i class="fa fa-check"></i><b>3.4</b> Starting with data</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#inspecting-data-frame-objects"><i class="fa fa-check"></i><b>3.4.1</b> Inspecting Data Frame Objects</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#indexing-and-subsetting-data-frames"><i class="fa fa-check"></i><b>3.5</b> Indexing and subsetting data frames</a></li>
<li class="chapter" data-level="3.6" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#factors-1"><i class="fa fa-check"></i><b>3.6</b> Factors</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#converting-factors"><i class="fa fa-check"></i><b>3.6.1</b> Converting factors</a></li>
<li class="chapter" data-level="3.6.2" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#renaming-factors"><i class="fa fa-check"></i><b>3.6.2</b> Renaming factors</a></li>
<li class="chapter" data-level="3.6.3" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#using-stringsasfactorsfalse"><i class="fa fa-check"></i><b>3.6.3</b> Using <code>stringsAsFactors=FALSE</code></a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#formatting-dates"><i class="fa fa-check"></i><b>3.7</b> Formatting Dates</a></li>
<li class="chapter" data-level="3.8" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#manipulating-and-analyzing-data-with-tidyverse"><i class="fa fa-check"></i><b>3.8</b> manipulating and analyzing data with tidyverse</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#data-manipulation-using-dplyr-and-tidyr"><i class="fa fa-check"></i><b>3.8.1</b> Data Manipulation using <strong><code>dplyr</code></strong> and <strong><code>tidyr</code></strong></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-visualization-with-r.html"><a href="data-visualization-with-r.html"><i class="fa fa-check"></i><b>4</b> Data Visualization with R</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-visualization-with-r.html"><a href="data-visualization-with-r.html#basics-of-ggplot2"><i class="fa fa-check"></i><b>4.1</b> Basics of ggplot2</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="data-visualization-with-r.html"><a href="data-visualization-with-r.html#importing-data"><i class="fa fa-check"></i><b>4.1.1</b> Importing data</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="data-visualization-with-r.html"><a href="data-visualization-with-r.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>4.2</b> Exploratory data analysis</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="data-visualization-with-r.html"><a href="data-visualization-with-r.html#statistical-variables-and-data"><i class="fa fa-check"></i><b>4.2.1</b> Statistical variables and data</a></li>
<li class="chapter" data-level="4.2.2" data-path="data-visualization-with-r.html"><a href="data-visualization-with-r.html#understanding-numerical-variables"><i class="fa fa-check"></i><b>4.2.2</b> Understanding numerical variables</a></li>
<li class="chapter" data-level="4.2.3" data-path="data-visualization-with-r.html"><a href="data-visualization-with-r.html#understanding-categorical-variables"><i class="fa fa-check"></i><b>4.2.3</b> Understanding categorical variables</a></li>
<li class="chapter" data-level="4.2.4" data-path="data-visualization-with-r.html"><a href="data-visualization-with-r.html#scatter-plot"><i class="fa fa-check"></i><b>4.2.4</b> Scatter plot</a></li>
<li class="chapter" data-level="4.2.5" data-path="data-visualization-with-r.html"><a href="data-visualization-with-r.html#bar-plot"><i class="fa fa-check"></i><b>4.2.5</b> Bar Plot</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="data-visualization-with-r.html"><a href="data-visualization-with-r.html#boxplots"><i class="fa fa-check"></i><b>4.3</b> Boxplots</a></li>
<li class="chapter" data-level="4.4" data-path="data-visualization-with-r.html"><a href="data-visualization-with-r.html#plotting-time-series-data"><i class="fa fa-check"></i><b>4.4</b> Plotting time series data</a></li>
<li class="chapter" data-level="4.5" data-path="data-visualization-with-r.html"><a href="data-visualization-with-r.html#line-plot"><i class="fa fa-check"></i><b>4.5</b> Line Plot</a></li>
<li class="chapter" data-level="4.6" data-path="data-visualization-with-r.html"><a href="data-visualization-with-r.html#histograpm"><i class="fa fa-check"></i><b>4.6</b> Histograpm</a></li>
<li class="chapter" data-level="4.7" data-path="data-visualization-with-r.html"><a href="data-visualization-with-r.html#arranging-plots-into-a-grid"><i class="fa fa-check"></i><b>4.7</b> Arranging plots into a grid</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="special-ggplot2-plotting-extensions.html"><a href="special-ggplot2-plotting-extensions.html"><i class="fa fa-check"></i><b>5</b> Special ggplot2 plotting extensions</a>
<ul>
<li class="chapter" data-level="5.1" data-path="special-ggplot2-plotting-extensions.html"><a href="special-ggplot2-plotting-extensions.html#ggcharts"><i class="fa fa-check"></i><b>5.1</b> ggcharts</a></li>
<li class="chapter" data-level="5.2" data-path="special-ggplot2-plotting-extensions.html"><a href="special-ggplot2-plotting-extensions.html#based-plots-with-statistical-details"><i class="fa fa-check"></i><b>5.2</b> Based Plots with Statistical Details</a></li>
<li class="chapter" data-level="5.3" data-path="special-ggplot2-plotting-extensions.html"><a href="special-ggplot2-plotting-extensions.html#gganimate"><i class="fa fa-check"></i><b>5.3</b> gganimate</a></li>
<li class="chapter" data-level="5.4" data-path="special-ggplot2-plotting-extensions.html"><a href="special-ggplot2-plotting-extensions.html#gggenes"><i class="fa fa-check"></i><b>5.4</b> gggenes</a></li>
<li class="chapter" data-level="5.5" data-path="special-ggplot2-plotting-extensions.html"><a href="special-ggplot2-plotting-extensions.html#mapping-with-r"><i class="fa fa-check"></i><b>5.5</b> Mapping with R</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="special-ggplot2-plotting-extensions.html"><a href="special-ggplot2-plotting-extensions.html#map-color"><i class="fa fa-check"></i><b>5.5.1</b> Map color</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="regression-with-r.html"><a href="regression-with-r.html"><i class="fa fa-check"></i><b>6</b> Regression with R</a>
<ul>
<li class="chapter" data-level="6.0.1" data-path="regression-with-r.html"><a href="regression-with-r.html#hypotheses-and-null-hypotheses"><i class="fa fa-check"></i><b>6.0.1</b> Hypotheses and null hypotheses</a></li>
<li class="chapter" data-level="6.0.2" data-path="regression-with-r.html"><a href="regression-with-r.html#linear-regression"><i class="fa fa-check"></i><b>6.0.2</b> Linear Regression</a></li>
<li class="chapter" data-level="6.0.3" data-path="regression-with-r.html"><a href="regression-with-r.html#generalized-linear-modelglm"><i class="fa fa-check"></i><b>6.0.3</b> Generalized Linear Model(GLM)</a></li>
<li class="chapter" data-level="6.0.4" data-path="regression-with-r.html"><a href="regression-with-r.html#logistic-regression"><i class="fa fa-check"></i><b>6.0.4</b> Logistic Regression</a></li>
<li class="chapter" data-level="6.1" data-path="regression-with-r.html"><a href="regression-with-r.html#anova-with-r"><i class="fa fa-check"></i><b>6.1</b> Anova with R</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="regression-with-r.html"><a href="regression-with-r.html#steps-to-conduct-an-anova"><i class="fa fa-check"></i><b>6.1.1</b> 3 Steps to conduct an ANOVA</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html"><i class="fa fa-check"></i><b>7</b> Scientific Publishing with Quarto in R</a>
<ul>
<li class="chapter" data-level="7.1" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#publishing-with-quarto"><i class="fa fa-check"></i><b>7.1</b> Publishing with Quarto</a></li>
<li class="chapter" data-level="7.2" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#markdown-basics"><i class="fa fa-check"></i><b>7.2</b> Markdown Basics</a></li>
<li class="chapter" data-level="7.3" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#r-markdown-syntax"><i class="fa fa-check"></i><b>7.3</b> R Markdown Syntax</a></li>
<li class="chapter" data-level="7.4" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#rendering-output"><i class="fa fa-check"></i><b>7.4</b> Rendering output</a></li>
<li class="chapter" data-level="7.5" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#how-it-works"><i class="fa fa-check"></i><b>7.5</b> How it works</a></li>
<li class="chapter" data-level="7.6" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#code-chunks"><i class="fa fa-check"></i><b>7.6</b> Code Chunks</a></li>
<li class="chapter" data-level="7.7" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#inline-code"><i class="fa fa-check"></i><b>7.7</b> Inline Code</a></li>
<li class="chapter" data-level="7.8" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#code-languages"><i class="fa fa-check"></i><b>7.8</b> Code Languages</a></li>
<li class="chapter" data-level="7.9" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#academic-journals"><i class="fa fa-check"></i><b>7.9</b> Academic Journals</a>
<ul>
<li class="chapter" data-level="7.9.1" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#get-started"><i class="fa fa-check"></i><b>7.9.1</b> Get started</a></li>
<li class="chapter" data-level="7.9.2" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#rticles-templates"><i class="fa fa-check"></i><b>7.9.2</b> rticles templates</a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#essential-commands-with-quarto"><i class="fa fa-check"></i><b>7.10</b> Essential commands with Quarto</a>
<ul>
<li class="chapter" data-level="7.10.1" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#rendering"><i class="fa fa-check"></i><b>7.10.1</b> Rendering</a></li>
<li class="chapter" data-level="7.10.2" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#authoring"><i class="fa fa-check"></i><b>7.10.2</b> Authoring</a></li>
</ul></li>
<li class="chapter" data-level="7.11" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#creating-journal-articles"><i class="fa fa-check"></i><b>7.11</b> Creating Journal Articles</a></li>
<li class="chapter" data-level="7.12" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#creating-books"><i class="fa fa-check"></i><b>7.12</b> Creating books</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="" data-path="appendex-1.html"><a href="appendex-1.html"><i class="fa fa-check"></i>Appendex 1</a>
<ul>
<li class="chapter" data-level="13" data-path="appendex-1.html"><a href="appendex-1.html#installing-r-and-rstudio"><i class="fa fa-check"></i><b>13</b> Installing R and Rstudio</a>
<ul>
<li class="chapter" data-level="13.1" data-path="appendex-1.html"><a href="appendex-1.html#installing-r"><i class="fa fa-check"></i><b>13.1</b> installing R</a></li>
<li class="chapter" data-level="13.2" data-path="appendex-1.html"><a href="appendex-1.html#installing-rstudio"><i class="fa fa-check"></i><b>13.2</b> Installing RStudio</a></li>
<li class="chapter" data-level="13.3" data-path="appendex-1.html"><a href="appendex-1.html#open-rstudio"><i class="fa fa-check"></i><b>13.3</b> Open RStudio</a></li>
<li class="chapter" data-level="13.4" data-path="appendex-1.html"><a href="appendex-1.html#installing-r-packages"><i class="fa fa-check"></i><b>13.4</b> Installing R packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="A" data-path="install-gdal-and-geos.html"><a href="install-gdal-and-geos.html"><i class="fa fa-check"></i><b>A</b> Install gdal and geos</a>
<ul>
<li class="chapter" data-level="A.1" data-path="install-gdal-and-geos.html"><a href="install-gdal-and-geos.html#on-windows"><i class="fa fa-check"></i><b>A.1</b> on Windows</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="install-mapping-library.html"><a href="install-mapping-library.html"><i class="fa fa-check"></i><b>B</b> Install Mapping Library</a></li>
<li class="chapter" data-level="C" data-path="download-spatial-data.html"><a href="download-spatial-data.html"><i class="fa fa-check"></i><b>C</b> Download spatial data</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://mesfind.github.io" target="blank">&copy Mesfin Diro</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><div class="line-block">Data Analysis , Visualization, and Scientfic Publishing with R &amp; Rstudio<br />
<br />
Participant Manual<br />
</div></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-analysis-with-r" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> Data Analysis with R<a href="data-analysis-with-r.html#data-analysis-with-r" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="what-is-r-what-is-rstudio" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> What is R? What is RStudio?<a href="data-analysis-with-r.html#what-is-r-what-is-rstudio" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The term <code>R</code> is used to refer to both the programming language and the software that interprets the scripts written using it.</p>
<p><code>RStudio</code> is a popular tool for not just writing R scripts but also interacting with the R software. RStudio requires R to function properly, thus both must be installed on your machine.</p>
</div>
<div id="why-learn-r" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Why learn R?<a href="data-analysis-with-r.html#why-learn-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="r-does-not-involve-lots-of-pointing-and-clicking-and-thats-a-good-thing" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> R does not involve lots of pointing and clicking, and that’s a good thing<a href="data-analysis-with-r.html#r-does-not-involve-lots-of-pointing-and-clicking-and-thats-a-good-thing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The learning curve may be longer than with other tools, but the outcomes of your research with R are based on a sequence of written commands rather than a series of pointing and clicking, which is a positive thing! So, if you want to redo your analysis because you gathered more data, you don’t need to remember which buttons you clicked in which order to get your results; all you have to do is rerun your script.</p>
<p>Working using scripts clarifies the steps you took in your investigation, and the code you write can be reviewed by another person who can provide input and point out errors.</p>
<p>Working with scripts challenges you to think more deeply about what you’re doing and makes it easier to learn and comprehend the approaches you utilize.</p>
</div>
<div id="r-code-is-great-for-reproducibility" class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> R code is great for reproducibility<a href="data-analysis-with-r.html#r-code-is-great-for-reproducibility" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When someone else (including your future self) can get the same results from the same dataset using the same analysis, it’s called reproducibility.</p>
<p>To generate manuscripts from your code, R interfaces with different technologies. The figures and statistical tests in your publication are automatically updated if you acquire more data or correct a mistake in your dataset.</p>
<p>Knowing R will offer you an advantage with these requirements, as an increasing number of journals and funding agencies seek repeatable analyses.</p>
</div>
<div id="r-is-interdisciplinary-and-extensible" class="section level3 hasAnchor" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> R is interdisciplinary and extensible<a href="data-analysis-with-r.html#r-is-interdisciplinary-and-extensible" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>R provides a framework that allows you to integrate statistical methodologies from various scientific disciplines to best suit the analytical framework you need to examine your data, with over 10,000+ packages that can be installed to increase its capabilities. R, for example, contains packages for image analysis, geographic information systems (GIS), time series, population genetics, and much more.</p>
</div>
<div id="r-works-on-data-of-all-shapes-and-sizes" class="section level3 hasAnchor" number="3.2.4">
<h3><span class="header-section-number">3.2.4</span> R works on data of all shapes and sizes<a href="data-analysis-with-r.html#r-works-on-data-of-all-shapes-and-sizes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The abilities you learn with R scale quickly as your dataset grows in size. It won’t make a difference to you if your dataset comprises hundreds or millions of lines.</p>
<p>R was created with data analysis in mind. It includes specific data structures and data types that simplify the handling of missing data and statistical elements.</p>
<p>R can connect to spreadsheets, databases, and a variety of other data formats, both locally and remotely.</p>
</div>
<div id="r-produces-high-quality-graphics" class="section level3 hasAnchor" number="3.2.5">
<h3><span class="header-section-number">3.2.5</span> R produces high-quality graphics<a href="data-analysis-with-r.html#r-produces-high-quality-graphics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>R’s plotting capabilities are limitless, allowing you to tweak every part of your graph to best convey the message from your data.</p>
</div>
<div id="r-has-a-large-and-welcoming-community" class="section level3 hasAnchor" number="3.2.6">
<h3><span class="header-section-number">3.2.6</span> R has a large and welcoming community<a href="data-analysis-with-r.html#r-has-a-large-and-welcoming-community" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>R is used by thousands of people every day. Many of them are prepared to help you through mailing lists and websites such as Stack Overflow, or on the RStudio community.</p>
</div>
<div id="not-only-is-r-free-but-it-is-also-open-source-and-cross-platform" class="section level3 hasAnchor" number="3.2.7">
<h3><span class="header-section-number">3.2.7</span> Not only is R free, but it is also open-source and cross-platform<a href="data-analysis-with-r.html#not-only-is-r-free-but-it-is-also-open-source-and-cross-platform" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Anyone can look at the source code to learn more about R. Because of this transparency, there are less chances for errors, and you (or someone else) can report and repair faults if you find them.</p>
<div class="figure">
<img src="image/rstudio_panels.png" width="600" alt="" />
<p class="caption">Rstudio Panels</p>
</div>
</div>
<div id="knowing-your-way-around-rstudio" class="section level3 hasAnchor" number="3.2.8">
<h3><span class="header-section-number">3.2.8</span> Knowing your way around RStudio<a href="data-analysis-with-r.html#knowing-your-way-around-rstudio" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s begin by learning about RStudio, an Integrated Development Environment (IDE) for R programming.</p>
<p>The Affero General Public License (AGPL) v3 covers the RStudio IDE open-source project. A commercial license and priority email assistance from RStudio, Inc. are also available for the RStudio IDE.</p>
<p>We’ll use the RStudio IDE to write code, navigate our computer’s files, analyze the variables we’ll create, and visualize the plots we’ll make. Other features of RStudio that we will not cover during the course include version management, package development, and writing Shiny apps.</p>
</div>
</div>
<div id="introduction-to-r" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Introduction to R<a href="data-analysis-with-r.html#introduction-to-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You can get output from R simply by typing math in the console:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="data-analysis-with-r.html#cb3-1" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> <span class="sc">+</span> <span class="dv">6</span></span></code></pre></div>
<pre><code>## [1] 11</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="data-analysis-with-r.html#cb5-1" aria-hidden="true" tabindex="-1"></a> <span class="dv">10</span> <span class="sc">/</span><span class="dv">3</span></span></code></pre></div>
<pre><code>## [1] 3.333333</code></pre>
<p>However, we must give values to objects in order to accomplish useful and interesting things. To make an object, we must first give it a name, then use the assignment operator. <code>&lt;-</code>, and the value we want to give it:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="data-analysis-with-r.html#cb7-1" aria-hidden="true" tabindex="-1"></a>weight_kg <span class="ot">&lt;-</span> <span class="dv">65</span></span></code></pre></div>
<p><code>&lt;-</code> is the assignment operator. It assigns values on the right to objects on the left. So, after executing <code>x &lt;- 3</code>, the value of x is 3. The arrow can be read as <strong>3 goes into x</strong>. For historical reasons, you can also use <code>=</code> for assignments, but not in every context. Because of the slight differences in syntax, it is good practice to always use <code>&lt;-</code> for assignments.</p>
<p>In RStudio, typing <code>Alt + -</code> (push Alt at the same time as the <code>-</code> key) will write <code>&lt;-</code> in a single keystroke in a PC, while typing Option <code>+ -</code> (push Option at the same time as the <code>-</code> key) does the same in a Mac.</p>
<p>When assigning a value to an object, R does not print anything. You can force R to print the value by using parentheses or by typing the object name:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="data-analysis-with-r.html#cb8-1" aria-hidden="true" tabindex="-1"></a>weight_kg <span class="ot">&lt;-</span> <span class="dv">65</span>    <span class="co"># doesn&#39;t print anything</span></span>
<span id="cb8-2"><a href="data-analysis-with-r.html#cb8-2" aria-hidden="true" tabindex="-1"></a>(weight_kg <span class="ot">&lt;-</span> <span class="dv">65</span>)  <span class="co"># but putting parenthesis around the call prints the value of `weight_kg`</span></span></code></pre></div>
<pre><code>## [1] 65</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="data-analysis-with-r.html#cb10-1" aria-hidden="true" tabindex="-1"></a>weight_kg          <span class="co"># and so does typing the name of the object</span></span></code></pre></div>
<pre><code>## [1] 65</code></pre>
<p>Now that R has weight_kg in memory, we can do arithmetic with it. For instance, we may want to convert this weight into pounds (weight in pounds is 2.2 times the weight in kg):</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="data-analysis-with-r.html#cb12-1" aria-hidden="true" tabindex="-1"></a>weight_lb <span class="ot">&lt;-</span> weight_kg <span class="sc">*</span> <span class="fl">2.2</span></span></code></pre></div>
<div id="comments" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Comments<a href="data-analysis-with-r.html#comments" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The comment character in R is <code>#</code>, and anything in a script to the right of a <code>#</code> is disregarded by <em>R</em>. Leaving notes and clarifications in your scripts is beneficial. To remark or uncomment a paragraph in RStudio, select the lines you want to comment and hit <code>Ctrl + Shift + C</code> on your keyboard at the same time. If you only want to comment out one line, place the cursor wherever on it (no need to select the entire line), then click <code>Ctrl + Shift + C.</code></p>
<p><strong>Exercise</strong></p>
<p>What are the values after each statement in the following?</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="data-analysis-with-r.html#cb13-1" aria-hidden="true" tabindex="-1"></a>mass <span class="ot">&lt;-</span> <span class="fl">65.5</span>            <span class="co"># mass?</span></span>
<span id="cb13-2"><a href="data-analysis-with-r.html#cb13-2" aria-hidden="true" tabindex="-1"></a>age  <span class="ot">&lt;-</span> <span class="dv">55</span>             <span class="co"># age?</span></span>
<span id="cb13-3"><a href="data-analysis-with-r.html#cb13-3" aria-hidden="true" tabindex="-1"></a>mass <span class="ot">&lt;-</span> mass <span class="sc">*</span> <span class="fl">2.0</span>      <span class="co"># mass?</span></span>
<span id="cb13-4"><a href="data-analysis-with-r.html#cb13-4" aria-hidden="true" tabindex="-1"></a>age  <span class="ot">&lt;-</span> age <span class="sc">-</span> <span class="dv">20</span>        <span class="co"># age?</span></span>
<span id="cb13-5"><a href="data-analysis-with-r.html#cb13-5" aria-hidden="true" tabindex="-1"></a>mass_index <span class="ot">&lt;-</span> mass<span class="sc">/</span>age  <span class="co"># mass_index?</span></span></code></pre></div>
</div>
<div id="functions-and-their-arguments" class="section level3 hasAnchor" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> Functions and their arguments<a href="data-analysis-with-r.html#functions-and-their-arguments" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Functions are “canned scripts” that automate more complex sets of commands, such as operations assignments and the like. Many functions are predefined or can be accessed by installing R packages (more on that later). A function typically takes one or more arguments as input. Most (but not all) functions return a value. The function <code>sqrt()</code> is an excellent example. The input (argument) must be an integer, and the output (return value) is the square root of that number. Calling a function (‘running it’) is the process of executing it. A function call might look like this:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="data-analysis-with-r.html#cb14-1" aria-hidden="true" tabindex="-1"></a>ten <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(weight_kg)</span></code></pre></div>
<p>The <strong>sqrt()</strong> method is given the value of weight kg, which calculates the square root and returns the value, which is then assigned to the object ten. Because it just accepts one argument, this function is incredibly basic.</p>
<p>Let’s try a function that can take multiple arguments: <code>round()</code></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="data-analysis-with-r.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fl">3.14159</span>)</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<p>We used <code>round()</code> with only one argument, <code>3.14159</code>, and it returned <code>3</code>. Because the default is to round to the nearest full number, this is the case. We can see how to gain extra digits by gathering knowledge about the round function. To find out what arguments it requires, we can use <code>args(round)</code> or search up the documentation for this method with <code>?round</code>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="data-analysis-with-r.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">args</span>(round)</span></code></pre></div>
<pre><code>## function (x, digits = 0) 
## NULL</code></pre>
<p>We see that if we want a different number of digits, we can type digits = 3 or however many we want.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="data-analysis-with-r.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fl">3.14159</span>, <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 3.142</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="data-analysis-with-r.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb21-2"><a href="data-analysis-with-r.html#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fl">3.14159</span>, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 3.142</code></pre>
</div>
<div id="data-structure" class="section level3 hasAnchor" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> Data Structure<a href="data-analysis-with-r.html#data-structure" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>R has several core data structures, and we’ll take a look at each.
* Vectors
* Factors
* Lists
* Matrices/arrays
* Data frames</p>
<div id="vectors" class="section level4 hasAnchor" number="3.3.3.1">
<h4><span class="header-section-number">3.3.3.1</span> Vectors<a href="data-analysis-with-r.html#vectors" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Vectors form the basis of R data structures. It is the most frequent and fundamental data type in R, and it is the workhorse of the language. A vector is made up of a collection of values that can be numbers or characters. The <code>c()</code> function can be used to assign a set of values to a vector. For instance, we may make a vector of animal weights and assign it to a new object called weight_g:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="data-analysis-with-r.html#cb23-1" aria-hidden="true" tabindex="-1"></a>weight_g <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">70</span>, <span class="dv">80</span>, <span class="dv">75</span>, <span class="dv">22</span>)</span>
<span id="cb23-2"><a href="data-analysis-with-r.html#cb23-2" aria-hidden="true" tabindex="-1"></a>weight_g</span></code></pre></div>
<pre><code>## [1] 70 80 75 22</code></pre>
<p>A vector can also contain characters:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="data-analysis-with-r.html#cb25-1" aria-hidden="true" tabindex="-1"></a>animals <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;rat&quot;</span>,<span class="st">&quot;mouse&quot;</span>,  <span class="st">&quot;dog&quot;</span>)</span>
<span id="cb25-2"><a href="data-analysis-with-r.html#cb25-2" aria-hidden="true" tabindex="-1"></a>animals</span></code></pre></div>
<pre><code>## [1] &quot;rat&quot;   &quot;mouse&quot; &quot;dog&quot;</code></pre>
<p>The quotation marks surrounding “mouse,” “rat,” and other words are crucial. Without the quotations, <code>R</code> will presume that objects named <strong>rat, mouse, and dog</strong> have been created. There will be an error message since these objects do not exist in R’s memory.</p>
<p>There are numerous functions for inspecting the content of a vector. <code>length()</code> returns the number of elements in a given vector:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="data-analysis-with-r.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(weight_g)</span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="data-analysis-with-r.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(animals)</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<p>An important feature of a vector, is that all of the elements are the same type of data. The function <code>class()</code> indicates the class (the type of element) of an object:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="data-analysis-with-r.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(animals)</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="data-analysis-with-r.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(weight_g)</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<p>The function <strong>str()</strong> provides an overview of the structure of an object and its elements. It is a useful function when working with large and complex objects:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="data-analysis-with-r.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(weight_g)</span></code></pre></div>
<pre><code>##  num [1:4] 70 80 75 22</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="data-analysis-with-r.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(animals)</span></code></pre></div>
<pre><code>##  chr [1:3] &quot;rat&quot; &quot;mouse&quot; &quot;dog&quot;</code></pre>
<p>You can use the <code>c()</code> function to add other elements to your vector:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="data-analysis-with-r.html#cb39-1" aria-hidden="true" tabindex="-1"></a>weight_g <span class="ot">&lt;-</span> <span class="fu">c</span>(weight_g, <span class="dv">10</span>) <span class="co"># add to the end of the vector</span></span>
<span id="cb39-2"><a href="data-analysis-with-r.html#cb39-2" aria-hidden="true" tabindex="-1"></a>weight_g <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>, weight_g) <span class="co"># add to the beginning of the vector</span></span>
<span id="cb39-3"><a href="data-analysis-with-r.html#cb39-3" aria-hidden="true" tabindex="-1"></a>weight_g</span></code></pre></div>
<pre><code>## [1] 20 70 80 75 22 10</code></pre>
<p>Elements of an atomic vector are the same type. Example types include:</p>
<ul>
<li>character</li>
<li>numeric (double)</li>
<li>integer</li>
<li>logical</li>
</ul>
</div>
</div>
<div id="subsetting-vectors" class="section level3 hasAnchor" number="3.3.4">
<h3><span class="header-section-number">3.3.4</span> Subsetting vectors<a href="data-analysis-with-r.html#subsetting-vectors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We must specify one or more indices in square brackets if we want to extract one or more values from a vector. Consider the following:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="data-analysis-with-r.html#cb41-1" aria-hidden="true" tabindex="-1"></a>animals <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;mouse&quot;</span>, <span class="st">&quot;rat&quot;</span>, <span class="st">&quot;dog&quot;</span>, <span class="st">&quot;cat&quot;</span>)</span>
<span id="cb41-2"><a href="data-analysis-with-r.html#cb41-2" aria-hidden="true" tabindex="-1"></a>animals[<span class="dv">2</span>]</span></code></pre></div>
<pre><code>## [1] &quot;rat&quot;</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="data-analysis-with-r.html#cb43-1" aria-hidden="true" tabindex="-1"></a>animals <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;mouse&quot;</span>, <span class="st">&quot;rat&quot;</span>, <span class="st">&quot;dog&quot;</span>, <span class="st">&quot;cat&quot;</span>)</span>
<span id="cb43-2"><a href="data-analysis-with-r.html#cb43-2" aria-hidden="true" tabindex="-1"></a>animals[<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>)]</span></code></pre></div>
<pre><code>## [1] &quot;dog&quot;   &quot;mouse&quot;</code></pre>
<p>We can also repeat the indices to create an object with more elements than the original one:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="data-analysis-with-r.html#cb45-1" aria-hidden="true" tabindex="-1"></a>animals <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;mouse&quot;</span>, <span class="st">&quot;rat&quot;</span>, <span class="st">&quot;dog&quot;</span>, <span class="st">&quot;cat&quot;</span>)</span>
<span id="cb45-2"><a href="data-analysis-with-r.html#cb45-2" aria-hidden="true" tabindex="-1"></a>animals[<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>,<span class="dv">4</span>)]</span></code></pre></div>
<pre><code>## [1] &quot;dog&quot;   &quot;mouse&quot; &quot;rat&quot;   &quot;mouse&quot; &quot;dog&quot;   &quot;mouse&quot; &quot;cat&quot;</code></pre>
<p>R indices start at 1. Programming languages like Fortran, MATLAB, Julia, and R start counting at 1, because that’s what human beings typically do. Languages in the C family (including C++, Java, Perl, and Python) count from 0 because that’s simpler for computers to do.</p>
</div>
<div id="conditional-subsetting" class="section level3 hasAnchor" number="3.3.5">
<h3><span class="header-section-number">3.3.5</span> Conditional subsetting<a href="data-analysis-with-r.html#conditional-subsetting" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Another common way of subsetting is by using a logical vector. TRUE will select the element with the same index, while FALSE will not:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="data-analysis-with-r.html#cb47-1" aria-hidden="true" tabindex="-1"></a>weight_g <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">10</span>, <span class="dv">39</span>, <span class="dv">54</span>, <span class="dv">65</span>)</span>
<span id="cb47-2"><a href="data-analysis-with-r.html#cb47-2" aria-hidden="true" tabindex="-1"></a>weight_g[<span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>)]</span></code></pre></div>
<pre><code>## [1] 20 54 65</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="data-analysis-with-r.html#cb49-1" aria-hidden="true" tabindex="-1"></a>weight_g <span class="sc">&gt;</span> <span class="dv">40</span></span></code></pre></div>
<pre><code>## [1] FALSE FALSE FALSE  TRUE  TRUE</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="data-analysis-with-r.html#cb51-1" aria-hidden="true" tabindex="-1"></a>weight_g[weight_g <span class="sc">&gt;</span> <span class="dv">40</span>]</span></code></pre></div>
<pre><code>## [1] 54 65</code></pre>
<p>You can combine multiple tests using <code>&amp;</code> (both conditions are true, AND) or <code>|</code> (at least one of the conditions is true, OR):</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="data-analysis-with-r.html#cb53-1" aria-hidden="true" tabindex="-1"></a>weight_g[weight_g <span class="sc">&lt;</span> <span class="dv">20</span> <span class="sc">|</span> weight_g <span class="sc">&gt;</span> <span class="dv">60</span>]</span></code></pre></div>
<pre><code>## [1] 10 65</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="data-analysis-with-r.html#cb55-1" aria-hidden="true" tabindex="-1"></a>weight_g[weight_g <span class="sc">&lt;</span> <span class="dv">20</span> <span class="sc">&amp;</span> weight_g <span class="sc">==</span> <span class="dv">60</span>]</span></code></pre></div>
<pre><code>## numeric(0)</code></pre>
</div>
<div id="missing-data" class="section level3 hasAnchor" number="3.3.6">
<h3><span class="header-section-number">3.3.6</span> Missing Data<a href="data-analysis-with-r.html#missing-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As R was designed to analyze datasets, it includes the concept of missing data (which is uncommon in other programming languages). Missing data are represented in vectors as NA.</p>
<p>When doing operations on numbers, most functions will return <code>NA</code> if the data you are working with include missing values. This feature makes it harder to overlook the cases where you are dealing with missing data. You can add the argument <code>na.rm = TRUE</code> to calculate the result while ignoring the missing values.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="data-analysis-with-r.html#cb57-1" aria-hidden="true" tabindex="-1"></a>heights <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="cn">NA</span>, <span class="dv">6</span>)</span>
<span id="cb57-2"><a href="data-analysis-with-r.html#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(heights)</span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="data-analysis-with-r.html#cb59-1" aria-hidden="true" tabindex="-1"></a>heights <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="cn">NA</span>, <span class="dv">6</span>)</span>
<span id="cb59-2"><a href="data-analysis-with-r.html#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(heights)</span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="data-analysis-with-r.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(heights)</span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="data-analysis-with-r.html#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(heights, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 6</code></pre>
<p>If your data include missing values, you may want to become familiar with the functions <code>is.na(), na.omit()</code>, and <code>complete.cases()</code>. See below for examples.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="data-analysis-with-r.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract those elements which are not missing values.</span></span>
<span id="cb65-2"><a href="data-analysis-with-r.html#cb65-2" aria-hidden="true" tabindex="-1"></a>heights[<span class="sc">!</span><span class="fu">is.na</span>(heights)]</span></code></pre></div>
<pre><code>## [1] 2 4 4 6</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="data-analysis-with-r.html#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Returns the object with incomplete cases removed. The returned object is an atomic vector of type `&quot;numeric&quot;` (or `&quot;double&quot;`).</span></span>
<span id="cb67-2"><a href="data-analysis-with-r.html#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">na.omit</span>(heights)</span></code></pre></div>
<pre><code>## [1] 2 4 4 6
## attr(,&quot;na.action&quot;)
## [1] 4
## attr(,&quot;class&quot;)
## [1] &quot;omit&quot;</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="data-analysis-with-r.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract those elements which are complete cases. The returned object is an atomic vector of type `&quot;numeric&quot;` (or `&quot;double&quot;`).</span></span>
<span id="cb69-2"><a href="data-analysis-with-r.html#cb69-2" aria-hidden="true" tabindex="-1"></a>heights[<span class="fu">complete.cases</span>(heights)]</span></code></pre></div>
<pre><code>## [1] 2 4 4 6</code></pre>
<div id="factors" class="section level4 hasAnchor" number="3.3.6.1">
<h4><span class="header-section-number">3.3.6.1</span> Factors<a href="data-analysis-with-r.html#factors" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>An important type of vector is a factor. Factors are used to represent categorical data structures. Although not exactly precise, one can think of factors as integers with labels. For example, the underlying representation of a variable for sex is <code>1:2</code> with labels “Male” and “Female”. They are a special class with attributes, or metadata, that contains the information about the levels.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="data-analysis-with-r.html#cb71-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;Male&quot;</span>,<span class="st">&quot;Female&quot;</span>,<span class="st">&quot;Female&quot;</span>,<span class="st">&quot;Male&quot;</span>,<span class="st">&quot;Male&quot;</span>))</span>
<span id="cb71-2"><a href="data-analysis-with-r.html#cb71-2" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>## [1] Male   Female Female Male   Male  
## Levels: Female Male</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="data-analysis-with-r.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(x)</span></code></pre></div>
<pre><code>## $levels
## [1] &quot;Female&quot; &quot;Male&quot;  
## 
## $class
## [1] &quot;factor&quot;</code></pre>
<p>The underlying representation is numeric, but it is important to remember that factors are categorical. Thus, they can’t be used as numbers would be, as the following demonstrates.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="data-analysis-with-r.html#cb75-1" aria-hidden="true" tabindex="-1"></a>x_num <span class="ot">=</span> <span class="fu">as.numeric</span>(x)  <span class="co"># convert to a numeric object</span></span>
<span id="cb75-2"><a href="data-analysis-with-r.html#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(x_num)</span></code></pre></div>
<pre><code>## [1] 8</code></pre>
<pre><code>Error in Summary.factor(c(1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L,  : 
  ‘sum’ not meaningful for factors
 Error in base::try(heights, silent = TRUE) : object &#39;heights&#39; not found</code></pre>
</div>
<div id="logicals" class="section level4 hasAnchor" number="3.3.6.2">
<h4><span class="header-section-number">3.3.6.2</span> Logicals<a href="data-analysis-with-r.html#logicals" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Logical scalar/vectors are those that take on one of two values: TRUE or FALSE. They are especially useful in flagging whether to run certain parts of code, and indexing certain parts of data structures (e.g. taking rows that correspond to TRUE). We’ll talk about the latter usage later.</p>
<p>Here is a logical vector.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="data-analysis-with-r.html#cb78-1" aria-hidden="true" tabindex="-1"></a>my_logic<span class="ot">=</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>)</span>
<span id="cb78-2"><a href="data-analysis-with-r.html#cb78-2" aria-hidden="true" tabindex="-1"></a>my_logic</span></code></pre></div>
<pre><code>## [1]  TRUE FALSE  TRUE FALSE  TRUE  TRUE</code></pre>
<p>Note also that logicals are also treated as binary 0:1, and so, for example, taking the mean will provide the proportion of TRUE values.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="data-analysis-with-r.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="sc">!</span>my_logic</span></code></pre></div>
<pre><code>## [1] FALSE  TRUE FALSE  TRUE FALSE FALSE</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="data-analysis-with-r.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(my_logic)</span></code></pre></div>
<pre><code>## [1] 1 0 1 0 1 1</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="data-analysis-with-r.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(my_logic)</span></code></pre></div>
<pre><code>## [1] 0.6666667</code></pre>
</div>
<div id="numeric-and-integer" class="section level4 hasAnchor" number="3.3.6.3">
<h4><span class="header-section-number">3.3.6.3</span> Numeric and Integer<a href="data-analysis-with-r.html#numeric-and-integer" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The most common type of data structure you’ll deal with are integer and numeric vectors.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="data-analysis-with-r.html#cb86-1" aria-hidden="true" tabindex="-1"></a>ints <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">3</span><span class="sc">:</span><span class="dv">3</span>   <span class="co"># integer sequences are easily constructed with the colon operator</span></span>
<span id="cb86-2"><a href="data-analysis-with-r.html#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(ints)</span></code></pre></div>
<pre><code>## [1] &quot;integer&quot;</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="data-analysis-with-r.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>) <span class="co"># fix the random numbers seed</span></span>
<span id="cb88-2"><a href="data-analysis-with-r.html#cb88-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">5</span>)  <span class="co"># 5 random values from the standard normal distribution</span></span>
<span id="cb88-3"><a href="data-analysis-with-r.html#cb88-3" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>## [1]  1.3709584 -0.5646982  0.3631284  0.6328626  0.4042683</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="data-analysis-with-r.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(x)</span></code></pre></div>
<pre><code>## [1] &quot;double&quot;</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="data-analysis-with-r.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(x)</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<p>The main difference between the two is that integers regard whole numbers only and are otherwise smaller in size in memory, but practically speaking you typically won’t distinguish them for most of your data science needs.</p>
</div>
<div id="dates" class="section level4 hasAnchor" number="3.3.6.4">
<h4><span class="header-section-number">3.3.6.4</span> Dates<a href="data-analysis-with-r.html#dates" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The common data structure you’ll deal with is a date variable. Typically dates require special treatment and to work as intended, but they can be stored as character strings or factors if desired. The following shows some of the base R functionality for this.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="data-analysis-with-r.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.Date</span>()</span></code></pre></div>
<pre><code>## [1] &quot;2022-11-21&quot;</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="data-analysis-with-r.html#cb96-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="fu">Sys.Date</span>(), <span class="st">&#39;2022-05-25&#39;</span>, <span class="fu">Sys.Date</span>()<span class="sc">+</span><span class="dv">2</span>))</span>
<span id="cb96-2"><a href="data-analysis-with-r.html#cb96-2" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>## [1] &quot;2022-11-21&quot; &quot;2022-05-25&quot; &quot;2022-11-23&quot;</code></pre>
<p>In almost every case however, a package like <code>lubridate</code> will make processing them much easier. The following shows how to strip out certain aspects of a date using it.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="data-analysis-with-r.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb98-2"><a href="data-analysis-with-r.html#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">month</span>(<span class="fu">Sys.Date</span>())</span></code></pre></div>
<pre><code>## [1] 11</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="data-analysis-with-r.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb100-2"><a href="data-analysis-with-r.html#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">day</span>(<span class="fu">Sys.Date</span>())</span></code></pre></div>
<pre><code>## [1] 21</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="data-analysis-with-r.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb102-2"><a href="data-analysis-with-r.html#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wday</span>(<span class="fu">Sys.Date</span>())  <span class="co"># week start day ( 1-Monday, 7-sunday)</span></span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="data-analysis-with-r.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quarter</span>(<span class="fu">Sys.Date</span>())</span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="data-analysis-with-r.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_date</span>(<span class="st">&#39;2022-01-01&#39;</span>) <span class="sc">+</span> <span class="dv">100</span></span></code></pre></div>
<pre><code>## [1] &quot;2022-04-11&quot;</code></pre>
<p>In general though, dates are treated as numeric variables, with consistent (but arbitrary) starting point. If you use these in analysis, you’ll probably want to make zero a useful value (e.g. the starting date)</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="data-analysis-with-r.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(<span class="fu">Sys.Date</span>())</span></code></pre></div>
<pre><code>## [1] 19317</code></pre>
</div>
</div>
<div id="matrices" class="section level3 hasAnchor" number="3.3.7">
<h3><span class="header-section-number">3.3.7</span> Matrices<a href="data-analysis-with-r.html#matrices" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>With multiple dimensions, we are dealing with arrays. Matrices are two dimensional (2-d) arrays, and extremely commonly used for scientific computing. The vectors making up a matrix must all be of the same type. For example, all values in a matrix might be numeric, or all character strings.</p>
<div id="creating-a-matrix" class="section level4 hasAnchor" number="3.3.7.1">
<h4><span class="header-section-number">3.3.7.1</span> Creating a matrix<a href="data-analysis-with-r.html#creating-a-matrix" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Creating a matrix can be done in a variety of ways.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="data-analysis-with-r.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create vectors</span></span>
<span id="cb110-2"><a href="data-analysis-with-r.html#cb110-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span></span>
<span id="cb110-3"><a href="data-analysis-with-r.html#cb110-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span>  <span class="dv">5</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb110-4"><a href="data-analysis-with-r.html#cb110-4" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span>  <span class="dv">9</span><span class="sc">:</span><span class="dv">12</span></span>
<span id="cb110-5"><a href="data-analysis-with-r.html#cb110-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-6"><a href="data-analysis-with-r.html#cb110-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(x, y, z)   <span class="co"># row bind</span></span></code></pre></div>
<pre><code>##   [,1] [,2] [,3] [,4]
## x    1    2    3    4
## y    5    6    7    8
## z    9   10   11   12</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="data-analysis-with-r.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(x, y, z)   <span class="co"># row bind</span></span></code></pre></div>
<pre><code>##      x y  z
## [1,] 1 5  9
## [2,] 2 6 10
## [3,] 3 7 11
## [4,] 4 8 12</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="data-analysis-with-r.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span>(</span>
<span id="cb114-2"><a href="data-analysis-with-r.html#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(x, y, z),</span>
<span id="cb114-3"><a href="data-analysis-with-r.html#cb114-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">3</span>,</span>
<span id="cb114-4"><a href="data-analysis-with-r.html#cb114-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">4</span>,</span>
<span id="cb114-5"><a href="data-analysis-with-r.html#cb114-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">byrow =</span> <span class="cn">TRUE</span></span>
<span id="cb114-6"><a href="data-analysis-with-r.html#cb114-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    1    2    3    4
## [2,]    5    6    7    8
## [3,]    9   10   11   12</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="data-analysis-with-r.html#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span>(</span>
<span id="cb116-2"><a href="data-analysis-with-r.html#cb116-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(x, y, z),</span>
<span id="cb116-3"><a href="data-analysis-with-r.html#cb116-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">3</span>,</span>
<span id="cb116-4"><a href="data-analysis-with-r.html#cb116-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">4</span>,</span>
<span id="cb116-5"><a href="data-analysis-with-r.html#cb116-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">byrow =</span> <span class="cn">FALSE</span></span>
<span id="cb116-6"><a href="data-analysis-with-r.html#cb116-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    1    4    7   10
## [2,]    2    5    8   11
## [3,]    3    6    9   12</code></pre>
</div>
</div>
<div id="data-frames" class="section level3 hasAnchor" number="3.3.8">
<h3><span class="header-section-number">3.3.8</span> Data Frames<a href="data-analysis-with-r.html#data-frames" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Data frames are a very commonly used data structure, and are essentially a representation of data in a table format with rows and columns. Elements of a data frame can be different types, and this is because the data.frame class is actually just a list. As such, everything about lists applies to them. But they can also be indexed by row or column as well, just like matrices. There are other very common types of object classes associated with packages that are both a data.frame and some other type of structure (e.g. tibbles in the tidyverse).</p>
<p>Usually your data frame will come directly from import or manipulation of other R objects (e.g. matrices). However, you should know how to create one from scratch.</p>
<div id="creating-a-data-frame" class="section level4 hasAnchor" number="3.3.8.1">
<h4><span class="header-section-number">3.3.8.1</span> Creating a data frame<a href="data-analysis-with-r.html#creating-a-data-frame" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The following will create a data frame with two columns, a and b.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="data-analysis-with-r.html#cb118-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">2</span>)</span>
<span id="cb118-2"><a href="data-analysis-with-r.html#cb118-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">8</span>, <span class="dv">1</span>)</span>
<span id="cb118-3"><a href="data-analysis-with-r.html#cb118-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(a,b)</span>
<span id="cb118-4"><a href="data-analysis-with-r.html#cb118-4" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>##   a b
## 1 1 3
## 2 5 8
## 3 2 1</code></pre>
<p>Much to the disdain of the tidyverse, we can add row names also</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="data-analysis-with-r.html#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(df) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;row&#39;</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb120-2"><a href="data-analysis-with-r.html#cb120-2" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>##      a b
## row1 1 3
## row2 5 8
## row3 2 1</code></pre>
<p>Everything about lists applies to data.frames, so we can add, select, and remove elements of a data frame just like lists. However we’ll visit this more in depth later, and see that we’ll have much more flexibility with data frames than we would lists for common data analysis and visualization.</p>
</div>
</div>
</div>
<div id="starting-with-data" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Starting with data<a href="data-analysis-with-r.html#starting-with-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We can read and load the data table from csv format:</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="data-analysis-with-r.html#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb122-2"><a href="data-analysis-with-r.html#cb122-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/combined.csv&quot;</span>)</span></code></pre></div>
<p>This statement doesn’t produce any output because, as you might recall, assignments don’t display anything. If we want to check that our data has been loaded, we can see the contents of the data frame by typing its name: <code>df</code></p>
<p>Wow… that was a lot of output. At least it means the data loaded properly. Let’s check the top (the first 6 lines) of this data frame using the function <code>head()</code>:</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="data-analysis-with-r.html#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 13
##   record_id month   day  year plot_id speci…¹ sex   hindf…² weight genus species
##       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;  
## 1         1     7    16  1977       2 NL      M          32     NA Neot… albigu…
## 2        72     8    19  1977       2 NL      M          31     NA Neot… albigu…
## 3       224     9    13  1977       2 NL      &lt;NA&gt;       NA     NA Neot… albigu…
## 4       266    10    16  1977       2 NL      &lt;NA&gt;       NA     NA Neot… albigu…
## 5       349    11    12  1977       2 NL      &lt;NA&gt;       NA     NA Neot… albigu…
## 6       363    11    12  1977       2 NL      &lt;NA&gt;       NA     NA Neot… albigu…
## # … with 2 more variables: taxa &lt;chr&gt;, plot_type &lt;chr&gt;, and abbreviated
## #   variable names ¹​species_id, ²​hindfoot_length</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="data-analysis-with-r.html#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df)</span></code></pre></div>
<pre><code>## spc_tbl_ [34,786 × 13] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
##  $ record_id      : num [1:34786] 1 72 224 266 349 363 435 506 588 661 ...
##  $ month          : num [1:34786] 7 8 9 10 11 11 12 1 2 3 ...
##  $ day            : num [1:34786] 16 19 13 16 12 12 10 8 18 11 ...
##  $ year           : num [1:34786] 1977 1977 1977 1977 1977 ...
##  $ plot_id        : num [1:34786] 2 2 2 2 2 2 2 2 2 2 ...
##  $ species_id     : chr [1:34786] &quot;NL&quot; &quot;NL&quot; &quot;NL&quot; &quot;NL&quot; ...
##  $ sex            : chr [1:34786] &quot;M&quot; &quot;M&quot; NA NA ...
##  $ hindfoot_length: num [1:34786] 32 31 NA NA NA NA NA NA NA NA ...
##  $ weight         : num [1:34786] NA NA NA NA NA NA NA NA 218 NA ...
##  $ genus          : chr [1:34786] &quot;Neotoma&quot; &quot;Neotoma&quot; &quot;Neotoma&quot; &quot;Neotoma&quot; ...
##  $ species        : chr [1:34786] &quot;albigula&quot; &quot;albigula&quot; &quot;albigula&quot; &quot;albigula&quot; ...
##  $ taxa           : chr [1:34786] &quot;Rodent&quot; &quot;Rodent&quot; &quot;Rodent&quot; &quot;Rodent&quot; ...
##  $ plot_type      : chr [1:34786] &quot;Control&quot; &quot;Control&quot; &quot;Control&quot; &quot;Control&quot; ...
##  - attr(*, &quot;spec&quot;)=
##   .. cols(
##   ..   record_id = col_double(),
##   ..   month = col_double(),
##   ..   day = col_double(),
##   ..   year = col_double(),
##   ..   plot_id = col_double(),
##   ..   species_id = col_character(),
##   ..   sex = col_character(),
##   ..   hindfoot_length = col_double(),
##   ..   weight = col_double(),
##   ..   genus = col_character(),
##   ..   species = col_character(),
##   ..   taxa = col_character(),
##   ..   plot_type = col_character()
##   .. )
##  - attr(*, &quot;problems&quot;)=&lt;externalptr&gt;</code></pre>
<div id="inspecting-data-frame-objects" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Inspecting Data Frame Objects<a href="data-analysis-with-r.html#inspecting-data-frame-objects" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We already saw how the functions <code>head()</code> and <code>str()</code> can be useful to check the content and the structure of a data frame. Here is a non-exhaustive list of functions to get a sense of the content/structure of the data. Let’s try them out!</p>
<ul>
<li>Size:
<ul>
<li><code>dim(df)</code> - returns a vector with the number of rows in the first element, and the number of columns as the second element (the dimensions of the object)</li>
<li><code>nrow(df)</code> - returns the number of rows</li>
<li><code>ncol(df)</code> - returns the number of columns</li>
</ul></li>
<li>Content:
<ul>
<li><code>head(df)</code> - shows the first 6 rows</li>
<li><code>tail(df)</code> - shows the last 6 rows</li>
</ul></li>
<li>Names:
<ul>
<li><code>names(df)</code> - returns the column names (synonym of colnames() for data.frame objects)</li>
<li><code>rownames(df)</code> - returns the row names
Summary:</li>
<li><code>str(df)</code> - structure of the object and information about the class, length and content of each column</li>
<li><code>summary(df)</code> - summary statistics for each column</li>
</ul></li>
</ul>
<p>Note: most of these functions are “generic”, they can be used on other types of objects besides data.frame.</p>
</div>
</div>
<div id="indexing-and-subsetting-data-frames" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Indexing and subsetting data frames<a href="data-analysis-with-r.html#indexing-and-subsetting-data-frames" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Our survey data frame has rows and columns (it has 2 dimensions), if we want to
extract some specific data from it, we need to specify the “coordinates” we
want from it. Row numbers come first, followed by column numbers. However, note
that different ways of specifying these coordinates lead to results with
different classes.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="data-analysis-with-r.html#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># first element in the first column of the data frame (as a vector)</span></span>
<span id="cb127-2"><a href="data-analysis-with-r.html#cb127-2" aria-hidden="true" tabindex="-1"></a>df[<span class="dv">1</span>, <span class="dv">1</span>]   </span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##   record_id
##       &lt;dbl&gt;
## 1         1</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="data-analysis-with-r.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># first element in the 6th column (as a vector)</span></span>
<span id="cb129-2"><a href="data-analysis-with-r.html#cb129-2" aria-hidden="true" tabindex="-1"></a>df[<span class="dv">1</span>, <span class="dv">6</span>]   </span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##   species_id
##   &lt;chr&gt;     
## 1 NL</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="data-analysis-with-r.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># first column of the data frame (as a vector)</span></span>
<span id="cb131-2"><a href="data-analysis-with-r.html#cb131-2" aria-hidden="true" tabindex="-1"></a>df[, <span class="dv">1</span>]    </span></code></pre></div>
<pre><code>## # A tibble: 34,786 × 1
##    record_id
##        &lt;dbl&gt;
##  1         1
##  2        72
##  3       224
##  4       266
##  5       349
##  6       363
##  7       435
##  8       506
##  9       588
## 10       661
## # … with 34,776 more rows</code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="data-analysis-with-r.html#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># first column of the data frame (as a data.frame)</span></span>
<span id="cb133-2"><a href="data-analysis-with-r.html#cb133-2" aria-hidden="true" tabindex="-1"></a>df[<span class="dv">1</span>]      </span></code></pre></div>
<pre><code>## # A tibble: 34,786 × 1
##    record_id
##        &lt;dbl&gt;
##  1         1
##  2        72
##  3       224
##  4       266
##  5       349
##  6       363
##  7       435
##  8       506
##  9       588
## 10       661
## # … with 34,776 more rows</code></pre>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="data-analysis-with-r.html#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># first three elements in the 7th column (as a vector)</span></span>
<span id="cb135-2"><a href="data-analysis-with-r.html#cb135-2" aria-hidden="true" tabindex="-1"></a>df[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">7</span>] </span></code></pre></div>
<pre><code>## # A tibble: 3 × 1
##   sex  
##   &lt;chr&gt;
## 1 M    
## 2 M    
## 3 &lt;NA&gt;</code></pre>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="data-analysis-with-r.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the 3rd row of the data frame (as a data.frame)</span></span>
<span id="cb137-2"><a href="data-analysis-with-r.html#cb137-2" aria-hidden="true" tabindex="-1"></a>df[<span class="dv">3</span>, ]    </span></code></pre></div>
<pre><code>## # A tibble: 1 × 13
##   record_id month   day  year plot_id speci…¹ sex   hindf…² weight genus species
##       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;  
## 1       224     9    13  1977       2 NL      &lt;NA&gt;       NA     NA Neot… albigu…
## # … with 2 more variables: taxa &lt;chr&gt;, plot_type &lt;chr&gt;, and abbreviated
## #   variable names ¹​species_id, ²​hindfoot_length</code></pre>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="data-analysis-with-r.html#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># equivalent to head_df &lt;- head(df)</span></span>
<span id="cb139-2"><a href="data-analysis-with-r.html#cb139-2" aria-hidden="true" tabindex="-1"></a>head_df <span class="ot">&lt;-</span> df[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, ] </span></code></pre></div>
<p><code>:</code> is a special function that creates numeric vectors of integers in increasing
or decreasing order, test <code>1:10</code> and <code>10:1</code> for instance.</p>
<p>You can also exclude certain indices of a data frame using the “<code>-</code>” sign:</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="data-analysis-with-r.html#cb140-1" aria-hidden="true" tabindex="-1"></a>df[, <span class="sc">-</span><span class="dv">1</span>]          <span class="co"># The whole data frame, except the first column</span></span></code></pre></div>
<pre><code>## # A tibble: 34,786 × 12
##    month   day  year plot_id species_id sex   hindf…¹ weight genus species taxa 
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;
##  1     7    16  1977       2 NL         M          32     NA Neot… albigu… Rode…
##  2     8    19  1977       2 NL         M          31     NA Neot… albigu… Rode…
##  3     9    13  1977       2 NL         &lt;NA&gt;       NA     NA Neot… albigu… Rode…
##  4    10    16  1977       2 NL         &lt;NA&gt;       NA     NA Neot… albigu… Rode…
##  5    11    12  1977       2 NL         &lt;NA&gt;       NA     NA Neot… albigu… Rode…
##  6    11    12  1977       2 NL         &lt;NA&gt;       NA     NA Neot… albigu… Rode…
##  7    12    10  1977       2 NL         &lt;NA&gt;       NA     NA Neot… albigu… Rode…
##  8     1     8  1978       2 NL         &lt;NA&gt;       NA     NA Neot… albigu… Rode…
##  9     2    18  1978       2 NL         M          NA    218 Neot… albigu… Rode…
## 10     3    11  1978       2 NL         &lt;NA&gt;       NA     NA Neot… albigu… Rode…
## # … with 34,776 more rows, 1 more variable: plot_type &lt;chr&gt;, and abbreviated
## #   variable name ¹​hindfoot_length</code></pre>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="data-analysis-with-r.html#cb142-1" aria-hidden="true" tabindex="-1"></a>df[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">7</span><span class="sc">:</span><span class="dv">34786</span>), ] <span class="co"># Equivalent to head(df)</span></span></code></pre></div>
<pre><code>## # A tibble: 6 × 13
##   record_id month   day  year plot_id speci…¹ sex   hindf…² weight genus species
##       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;  
## 1         1     7    16  1977       2 NL      M          32     NA Neot… albigu…
## 2        72     8    19  1977       2 NL      M          31     NA Neot… albigu…
## 3       224     9    13  1977       2 NL      &lt;NA&gt;       NA     NA Neot… albigu…
## 4       266    10    16  1977       2 NL      &lt;NA&gt;       NA     NA Neot… albigu…
## 5       349    11    12  1977       2 NL      &lt;NA&gt;       NA     NA Neot… albigu…
## 6       363    11    12  1977       2 NL      &lt;NA&gt;       NA     NA Neot… albigu…
## # … with 2 more variables: taxa &lt;chr&gt;, plot_type &lt;chr&gt;, and abbreviated
## #   variable names ¹​species_id, ²​hindfoot_length</code></pre>
<p>Data frames can be subset by calling indices (as shown previously), but also by calling their column names directly:</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="data-analysis-with-r.html#cb144-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&quot;species_id&quot;</span>]       <span class="co"># Result is a data.frame</span></span>
<span id="cb144-2"><a href="data-analysis-with-r.html#cb144-2" aria-hidden="true" tabindex="-1"></a>df[, <span class="st">&quot;species_id&quot;</span>]     <span class="co"># Result is a vector</span></span>
<span id="cb144-3"><a href="data-analysis-with-r.html#cb144-3" aria-hidden="true" tabindex="-1"></a>df[[<span class="st">&quot;species_id&quot;</span>]]     <span class="co"># Result is a vector</span></span>
<span id="cb144-4"><a href="data-analysis-with-r.html#cb144-4" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>species_id          <span class="co"># Result is a vector</span></span></code></pre></div>
<p>In RStudio, you can use the autocompletion feature to get the full and correct names of the columns.</p>
</div>
<div id="factors-1" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> Factors<a href="data-analysis-with-r.html#factors-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When we did <code>str(df)</code> we saw that several of the columns consist of
integers. The columns <code>genus</code>, <code>species</code>, <code>sex</code>, <code>plot_type</code>, … however, are
of a special class called <code>factor</code>. Factors are very useful and actually
contribute to making R particularly well suited to working with data. So we are
going to spend a little time introducing them.</p>
<p>Factors represent categorical data. They are stored as integers associated with labels and they can be ordered or unordered. While factors look (and often behave) like character vectors, they are actually treated as integer vectors by R. So you need to be very careful when treating them as strings.</p>
<p>Once created, factors can only contain a pre-defined set of values, known as
<em>levels</em>. By default, R always sorts levels in alphabetical order. For
instance, if you have a factor with 2 levels:</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="data-analysis-with-r.html#cb145-1" aria-hidden="true" tabindex="-1"></a>sex <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;male&quot;</span>, <span class="st">&quot;female&quot;</span>, <span class="st">&quot;female&quot;</span>, <span class="st">&quot;male&quot;</span>))</span></code></pre></div>
<p>R will assign <code>1</code> to the level <code>"female"</code> and <code>2</code> to the level <code>"male"</code> (because
<code>f</code> comes before <code>m</code>, even though the first element in this vector is
<code>"male"</code>). You can see this by using the function <code>levels()</code> and you can find the
number of levels using <code>nlevels()</code>:</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="data-analysis-with-r.html#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(sex)</span></code></pre></div>
<pre><code>## [1] &quot;female&quot; &quot;male&quot;</code></pre>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="data-analysis-with-r.html#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nlevels</span>(sex)</span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<p>Sometimes, the order of the factors does not matter, other times you might want
to specify the order because it is meaningful (e.g., “low”, “medium”, “high”),
it improves your visualization, or it is required by a particular type of
analysis. Here, one way to reorder our levels in the <code>sex</code> vector would be:</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="data-analysis-with-r.html#cb150-1" aria-hidden="true" tabindex="-1"></a>sex <span class="co"># current order</span></span></code></pre></div>
<pre><code>## [1] male   female female male  
## Levels: female male</code></pre>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="data-analysis-with-r.html#cb152-1" aria-hidden="true" tabindex="-1"></a>sex <span class="ot">&lt;-</span> <span class="fu">factor</span>(sex, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;male&quot;</span>, <span class="st">&quot;female&quot;</span>))</span>
<span id="cb152-2"><a href="data-analysis-with-r.html#cb152-2" aria-hidden="true" tabindex="-1"></a>sex <span class="co"># after re-ordering</span></span></code></pre></div>
<pre><code>## [1] male   female female male  
## Levels: male female</code></pre>
<p>In R’s memory, these factors are represented by integers (1, 2, 3), but are more
informative than integers because factors are self describing: <code>"female"</code>,
<code>"male"</code> is more descriptive than <code>1</code>, <code>2</code>. Which one is “male”? You wouldn’t
be able to tell just from the integer data. Factors, on the other hand, have
this information built in. It is particularly helpful when there are many levels
(like the species names in our example dataset).</p>
<div id="converting-factors" class="section level3 hasAnchor" number="3.6.1">
<h3><span class="header-section-number">3.6.1</span> Converting factors<a href="data-analysis-with-r.html#converting-factors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If you need to convert a factor to a character vector, you use
<code>as.character(x)</code>.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="data-analysis-with-r.html#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.character</span>(sex)</span></code></pre></div>
<pre><code>## [1] &quot;male&quot;   &quot;female&quot; &quot;female&quot; &quot;male&quot;</code></pre>
<p>In some cases, you may have to convert factors where the levels appear as
numbers (such as concentration levels or years) to a numeric vector. For
instance, in one part of your analysis the years might need to be encoded as
factors (e.g., comparing average weights across years) but in another part of
your analysis they may need to be stored as numeric values (e.g., doing math
operations on the years). This conversion from factor to numeric is a little
trickier. The <code>as.numeric()</code> function returns the index values of the factor,
not its levels, so it will result in an entirely new (and unwanted in this case)
set of numbers. One method to avoid this is to convert factors to characters,
and then to numbers.</p>
<p>Another method is to use the <code>levels()</code> function. Compare:</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="data-analysis-with-r.html#cb156-1" aria-hidden="true" tabindex="-1"></a>year_fct <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="dv">1990</span>, <span class="dv">1983</span>, <span class="dv">1977</span>, <span class="dv">1998</span>, <span class="dv">1990</span>))</span>
<span id="cb156-2"><a href="data-analysis-with-r.html#cb156-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(year_fct)               <span class="co"># Wrong! And there is no warning...</span></span></code></pre></div>
<pre><code>## [1] 3 2 1 4 3</code></pre>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="data-analysis-with-r.html#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(<span class="fu">as.character</span>(year_fct)) <span class="co"># Works...</span></span></code></pre></div>
<pre><code>## [1] 1990 1983 1977 1998 1990</code></pre>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="data-analysis-with-r.html#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(<span class="fu">levels</span>(year_fct))[year_fct]    <span class="co"># The recommended way.</span></span></code></pre></div>
<pre><code>## [1] 1990 1983 1977 1998 1990</code></pre>
<p>Notice that in the <code>levels()</code> approach, three important steps occur:</p>
<ul>
<li>We obtain all the factor levels using <code>levels(year_fct)</code></li>
<li>We convert these levels to numeric values using <code>as.numeric(levels(year_fct))</code></li>
<li>We then access these numeric values using the underlying integers of the
vector <code>year_fct</code> inside the square brackets</li>
</ul>
</div>
<div id="renaming-factors" class="section level3 hasAnchor" number="3.6.2">
<h3><span class="header-section-number">3.6.2</span> Renaming factors<a href="data-analysis-with-r.html#renaming-factors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In addition to males and females, there are about 1700 individuals for which the
sex information hasn’t been recorded. Additionally, for these individuals,
there is no label to indicate that the information is missing or undetermined. Let’s rename this
label to something more meaningful. Before doing that, we’re going to pull out
the data on sex and work with that data, so we’re not modifying the working copy
of the data frame:</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="data-analysis-with-r.html#cb162-1" aria-hidden="true" tabindex="-1"></a>sex <span class="ot">&lt;-</span> df<span class="sc">$</span>sex</span>
<span id="cb162-2"><a href="data-analysis-with-r.html#cb162-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sex)</span></code></pre></div>
<pre><code>## [1] &quot;M&quot; &quot;M&quot; NA  NA  NA  NA</code></pre>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="data-analysis-with-r.html#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(sex)</span></code></pre></div>
<pre><code>## NULL</code></pre>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="data-analysis-with-r.html#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(sex)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;undetermined&quot;</span></span>
<span id="cb166-2"><a href="data-analysis-with-r.html#cb166-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(sex)</span></code></pre></div>
<pre><code>## [1] &quot;undetermined&quot;</code></pre>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="data-analysis-with-r.html#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sex)</span></code></pre></div>
<pre><code>## [1] &quot;M&quot; &quot;M&quot; NA  NA  NA  NA</code></pre>
</div>
<div id="using-stringsasfactorsfalse" class="section level3 hasAnchor" number="3.6.3">
<h3><span class="header-section-number">3.6.3</span> Using <code>stringsAsFactors=FALSE</code><a href="data-analysis-with-r.html#using-stringsasfactorsfalse" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>By default, when building or importing a data frame, the columns that contain
characters (i.e. text) are coerced (= converted) into factors. Depending on what you want to do with the data, you may want to keep these
columns as <code>character</code>. To do so, <code>read.csv()</code> and <code>read.table()</code> have an
argument called <code>stringsAsFactors</code> which can be set to <code>FALSE</code>.</p>
<p>In most cases, it is preferable to set <code>stringsAsFactors = FALSE</code> when importing
data and to convert as a factor only the columns that require this data
type.</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="data-analysis-with-r.html#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compare the difference between our data read as `factor` vs `character`.</span></span>
<span id="cb170-2"><a href="data-analysis-with-r.html#cb170-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/combined.csv&quot;</span>, <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb170-3"><a href="data-analysis-with-r.html#cb170-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df)</span>
<span id="cb170-4"><a href="data-analysis-with-r.html#cb170-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/combined.csv&quot;</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb170-5"><a href="data-analysis-with-r.html#cb170-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df)</span>
<span id="cb170-6"><a href="data-analysis-with-r.html#cb170-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Convert the column &quot;plot_type&quot; into a factor</span></span>
<span id="cb170-7"><a href="data-analysis-with-r.html#cb170-7" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>plot_type <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>plot_type)</span></code></pre></div>
</div>
</div>
<div id="formatting-dates" class="section level2 hasAnchor" number="3.7">
<h2><span class="header-section-number">3.7</span> Formatting Dates<a href="data-analysis-with-r.html#formatting-dates" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>One of the most common issues that new (and experienced!) R users have is
converting date and time information into a variable that is appropriate and
usable during analyses. As a reminder from earlier in this lesson, the best
practice for dealing with date data is to ensure that each component of your
date is stored as a separate variable. Using <code>str()</code>, We can confirm that our
data frame has a separate column for day, month, and year, and that each contains
integer values.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="data-analysis-with-r.html#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df)</span></code></pre></div>
<p>We are going to use the <code>ymd()</code> function from the package <strong><code>lubridate</code></strong> (which belongs to the <strong><code>tidyverse</code></strong>; learn more <a href="https://www.tidyverse.org/">here</a>). . <strong><code>lubridate</code></strong> gets installed as part as the <strong><code>tidyverse</code></strong> installation. When you load the <strong><code>tidyverse</code></strong> (<code>library(tidyverse)</code>), the core packages (the packages used in most data analyses) get loaded. <strong><code>lubridate</code></strong> however does not belong to the core tidyverse, so you have to load it explicitly with <code>library(lubridate)</code></p>
<p>Start by loading the required package:</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="data-analysis-with-r.html#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span></code></pre></div>
<p><code>ymd()</code> takes a vector representing year, month, and day, and converts it to a
<code>Date</code> vector. <code>Date</code> is a class of data recognized by R as being a date and can
be manipulated as such. The argument that the function requires is flexible,
but, as a best practice, is a character vector formatted as “YYYY-MM-DD”.</p>
<p>Let’s create a date object and inspect the structure:</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="data-analysis-with-r.html#cb173-1" aria-hidden="true" tabindex="-1"></a>my_date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">&quot;2015-01-01&quot;</span>)</span>
<span id="cb173-2"><a href="data-analysis-with-r.html#cb173-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(my_date)</span></code></pre></div>
<pre><code>##  Date[1:1], format: &quot;2015-01-01&quot;</code></pre>
<p>Now let’s paste the year, month, and day separately - we get the same result:</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="data-analysis-with-r.html#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sep indicates the character to use to separate each component</span></span>
<span id="cb175-2"><a href="data-analysis-with-r.html#cb175-2" aria-hidden="true" tabindex="-1"></a>my_date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="fu">paste</span>(<span class="st">&quot;2015&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;-&quot;</span>)) </span>
<span id="cb175-3"><a href="data-analysis-with-r.html#cb175-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(my_date)</span></code></pre></div>
<pre><code>##  Date[1:1], format: &quot;2015-01-01&quot;</code></pre>
<p>Now we apply this function to the surveys dataset. Create a character vector from the <code>year</code>, <code>month</code>, and <code>day</code> columns of
<code>df</code> using <code>paste()</code>:</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="data-analysis-with-r.html#cb177-1" aria-hidden="true" tabindex="-1"></a>date <span class="ot">&lt;-</span> <span class="fu">paste</span>(df<span class="sc">$</span>year, df<span class="sc">$</span>month, df<span class="sc">$</span>day, <span class="at">sep =</span> <span class="st">&quot;-&quot;</span>)</span>
<span id="cb177-2"><a href="data-analysis-with-r.html#cb177-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(date)</span></code></pre></div>
<pre><code>## [1] &quot;1977-7-16&quot;  &quot;1977-8-19&quot;  &quot;1977-9-13&quot;  &quot;1977-10-16&quot; &quot;1977-11-12&quot;
## [6] &quot;1977-11-12&quot;</code></pre>
<p>This character vector can be used as the argument for <code>ymd()</code>:</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="data-analysis-with-r.html#cb179-1" aria-hidden="true" tabindex="-1"></a>date2 <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="fu">paste</span>(df<span class="sc">$</span>year, df<span class="sc">$</span>month, df<span class="sc">$</span>day, <span class="at">sep =</span> <span class="st">&quot;-&quot;</span>))</span></code></pre></div>
<p>The resulting <code>Date</code> vector can be added to <code>df</code> as a new column called <code>date</code>:</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="data-analysis-with-r.html#cb180-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="fu">paste</span>(df<span class="sc">$</span>year, df<span class="sc">$</span>month, df<span class="sc">$</span>day, <span class="at">sep =</span> <span class="st">&quot;-&quot;</span>))</span>
<span id="cb180-2"><a href="data-analysis-with-r.html#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df) <span class="co"># notice the new column, with &#39;date&#39; as the class</span></span></code></pre></div>
<pre><code>## spc_tbl_ [34,786 × 14] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
##  $ record_id      : num [1:34786] 1 72 224 266 349 363 435 506 588 661 ...
##  $ month          : num [1:34786] 7 8 9 10 11 11 12 1 2 3 ...
##  $ day            : num [1:34786] 16 19 13 16 12 12 10 8 18 11 ...
##  $ year           : num [1:34786] 1977 1977 1977 1977 1977 ...
##  $ plot_id        : num [1:34786] 2 2 2 2 2 2 2 2 2 2 ...
##  $ species_id     : chr [1:34786] &quot;NL&quot; &quot;NL&quot; &quot;NL&quot; &quot;NL&quot; ...
##  $ sex            : chr [1:34786] &quot;M&quot; &quot;M&quot; NA NA ...
##  $ hindfoot_length: num [1:34786] 32 31 NA NA NA NA NA NA NA NA ...
##  $ weight         : num [1:34786] NA NA NA NA NA NA NA NA 218 NA ...
##  $ genus          : chr [1:34786] &quot;Neotoma&quot; &quot;Neotoma&quot; &quot;Neotoma&quot; &quot;Neotoma&quot; ...
##  $ species        : chr [1:34786] &quot;albigula&quot; &quot;albigula&quot; &quot;albigula&quot; &quot;albigula&quot; ...
##  $ taxa           : chr [1:34786] &quot;Rodent&quot; &quot;Rodent&quot; &quot;Rodent&quot; &quot;Rodent&quot; ...
##  $ plot_type      : chr [1:34786] &quot;Control&quot; &quot;Control&quot; &quot;Control&quot; &quot;Control&quot; ...
##  $ date           : Date[1:34786], format: &quot;1977-07-16&quot; &quot;1977-08-19&quot; ...
##  - attr(*, &quot;spec&quot;)=
##   .. cols(
##   ..   record_id = col_double(),
##   ..   month = col_double(),
##   ..   day = col_double(),
##   ..   year = col_double(),
##   ..   plot_id = col_double(),
##   ..   species_id = col_character(),
##   ..   sex = col_character(),
##   ..   hindfoot_length = col_double(),
##   ..   weight = col_double(),
##   ..   genus = col_character(),
##   ..   species = col_character(),
##   ..   taxa = col_character(),
##   ..   plot_type = col_character()
##   .. )
##  - attr(*, &quot;problems&quot;)=&lt;externalptr&gt;</code></pre>
<p>Let’s make sure everything worked correctly. One way to inspect the new column is to use <code>summary()</code>:</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="data-analysis-with-r.html#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df<span class="sc">$</span>date)</span></code></pre></div>
<pre><code>##         Min.      1st Qu.       Median         Mean      3rd Qu.         Max. 
## &quot;1977-07-16&quot; &quot;1984-03-12&quot; &quot;1990-07-22&quot; &quot;1990-12-15&quot; &quot;1997-07-29&quot; &quot;2002-12-31&quot; 
##         NA&#39;s 
##        &quot;129&quot;</code></pre>
<p>Something went wrong: some dates have missing values. Let’s investigate where they are coming from.</p>
<p>We can use the functions we saw previously to deal with missing data to identify
the rows in our data frame that are failing. If we combine them with what we learned about subsetting data frames earlier, we can extract the columns “year,”month”, “day” from the records that have <code>NA</code> in our new column <code>date</code>. We will also use <code>head()</code> so we don’t clutter the output:</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="data-analysis-with-r.html#cb184-1" aria-hidden="true" tabindex="-1"></a>missing_dates <span class="ot">&lt;-</span> df[<span class="fu">is.na</span>(df<span class="sc">$</span>date), <span class="fu">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;month&quot;</span>, <span class="st">&quot;day&quot;</span>)]</span>
<span id="cb184-2"><a href="data-analysis-with-r.html#cb184-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-3"><a href="data-analysis-with-r.html#cb184-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(missing_dates)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 3
##    year month   day
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1  2000     9    31
## 2  2000     4    31
## 3  2000     4    31
## 4  2000     4    31
## 5  2000     4    31
## 6  2000     9    31</code></pre>
</div>
<div id="manipulating-and-analyzing-data-with-tidyverse" class="section level2 hasAnchor" number="3.8">
<h2><span class="header-section-number">3.8</span> manipulating and analyzing data with tidyverse<a href="data-analysis-with-r.html#manipulating-and-analyzing-data-with-tidyverse" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="data-manipulation-using-dplyr-and-tidyr" class="section level3 hasAnchor" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Data Manipulation using <strong><code>dplyr</code></strong> and <strong><code>tidyr</code></strong><a href="data-analysis-with-r.html#data-manipulation-using-dplyr-and-tidyr" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Bracket subsetting is handy, but it can be cumbersome and difficult to read,
especially for complicated operations. Enter <strong><code>dplyr</code></strong>. <strong><code>dplyr</code></strong> is a package for
making tabular data manipulation easier. It pairs nicely with <strong><code>tidyr</code></strong> which enables you to swiftly convert between different data formats for plotting and analysis.</p>
<p>Packages in R are basically sets of additional functions that let you do more
stuff. The functions we’ve been using so far, like <code>str()</code> or <code>data.frame()</code>,
come built into R; packages give you access to more of them. Before you use a
package for the first time you need to install it on your machine, and then you
should import it in every subsequent R session when you need it. You should
already have installed the <strong><code>tidyverse</code></strong> package. This is an
“umbrella-package” that installs several packages useful for data analysis which
work together well such as <strong><code>tidyr</code></strong>, <strong><code>dplyr</code></strong>, <strong><code>ggplot2</code></strong>, <strong><code>tibble</code></strong>, etc.</p>
<p>The <strong><code>tidyverse</code></strong> package tries to address 3 common issues that arise when
doing data analysis with some of the functions that come with R:</p>
<ol style="list-style-type: decimal">
<li>The results from a base R function sometimes depend on the type of data.</li>
<li>Using R expressions in a non standard way, which can be confusing for new
learners.</li>
<li>Hidden arguments, having default operations that new learners are not aware
of.</li>
</ol>
<p>We have seen in our previous lesson that when building or importing a data frame, the columns that contain characters (i.e., text) are coerced (=converted) into the <code>factor</code> data type. We had to set <strong><code>stringsAsFactors</code></strong> to <strong><code>FALSE</code></strong> to avoid this hidden argument to convert our data type.</p>
<p>This time we will use the <strong><code>tidyverse</code></strong> package to read the data and avoid having to set <strong><code>stringsAsFactors</code></strong> to <strong><code>FALSE</code></strong></p>
<p>To load the package type:</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="data-analysis-with-r.html#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="do">## load the tidyverse packages, incl. dplyr</span></span>
<span id="cb186-2"><a href="data-analysis-with-r.html#cb186-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;tidyverse&quot;</span>)</span></code></pre></div>
<div id="what-are-dplyr-and-tidyr" class="section level4 hasAnchor" number="3.8.1.1">
<h4><span class="header-section-number">3.8.1.1</span> What are <strong><code>dplyr</code></strong> and <strong><code>tidyr</code></strong>?<a href="data-analysis-with-r.html#what-are-dplyr-and-tidyr" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The package <strong><code>dplyr</code></strong> provides easy tools for the most common data manipulation
tasks. It is built to work directly with data frames, with many common tasks
optimized by being written in a compiled language (C++). An additional feature is the
ability to work directly with data stored in an external database. The benefits of
doing this are that the data can be managed natively in a relational database,
queries can be conducted on that database, and only the results of the query are
returned.</p>
<p>This addresses a common problem with R in that all operations are conducted
in-memory and thus the amount of data you can work with is limited by available
memory. The database connections essentially remove that limitation in that you
can connect to a database of many hundreds of GB, conduct queries on it directly, and pull
back into R only what you need for analysis.</p>
<p>The package <strong><code>tidyr</code></strong> addresses the common problem of wanting to reshape your data for plotting and use by different R functions. Sometimes we want data sets where we have one row per measurement. Sometimes we want a data frame where each measurement type has its own column, and rows are instead more aggregated groups - like plots or aquaria. Moving back and forth between these formats is nontrivial, and <strong><code>tidyr</code></strong> gives you tools for this and more sophisticated data manipulation.</p>
<p>To learn more about <strong><code>dplyr</code></strong> and <strong><code>tidyr</code></strong> after the workshop, you may want to check out this
<a href="https://github.com/rstudio/cheatsheets/raw/master/data-transformation.pdf">handy data transformation with <strong><code>dplyr</code></strong> cheatsheet</a> and this <a href="https://github.com/rstudio/cheatsheets/raw/master/data-import.pdf">one about <strong><code>tidyr</code></strong></a>.</p>
<p>We’ll read in our data using the <code>read_csv()</code> function, from the tidyverse package <strong><code>readr</code></strong>, instead of <code>read.csv()</code>.</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="data-analysis-with-r.html#cb187-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/combined.csv&quot;</span>)</span>
<span id="cb187-2"><a href="data-analysis-with-r.html#cb187-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-3"><a href="data-analysis-with-r.html#cb187-3" aria-hidden="true" tabindex="-1"></a><span class="do">## inspect the data</span></span>
<span id="cb187-4"><a href="data-analysis-with-r.html#cb187-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df)</span></code></pre></div>
<p>Notice that the class of the data is now <code>tbl_df</code></p>
<p>This is referred to as a “tibble”. Tibbles tweak some of the behaviors of the data frame objects we introduced in the previous episode. The data structure is very similar to a data frame. For our purposes the only differences are that:</p>
<ol style="list-style-type: decimal">
<li>In addition to displaying the data type of each column under its name, it
only prints the first few rows of data and only as many columns as fit on one
screen.</li>
<li>Columns of class <code>character</code> are never converted into factors.</li>
</ol>
<p>We’re going to learn some of the most common <strong><code>dplyr</code></strong> functions:</p>
<ul>
<li><code>select()</code>: subset columns</li>
<li><code>filter()</code>: subset rows on conditions</li>
<li><code>mutate()</code>: create new columns by using information from other columns</li>
<li><code>group_by()</code> and <code>summarize()</code>: create summary statisitcs on grouped data</li>
<li><code>arrange()</code>: sort results</li>
<li><code>count()</code>: count discrete values</li>
</ul>
</div>
<div id="selecting-columns-and-filtering-rows" class="section level4 hasAnchor" number="3.8.1.2">
<h4><span class="header-section-number">3.8.1.2</span> Selecting columns and filtering rows<a href="data-analysis-with-r.html#selecting-columns-and-filtering-rows" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To select columns of a data frame, use <code>select()</code>. The first argument
to this function is the data frame (<code>df</code>), and the subsequent
arguments are the columns to keep.</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="data-analysis-with-r.html#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb188-2"><a href="data-analysis-with-r.html#cb188-2" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">select</span>(df, plot_id, species_id, weight)</span></code></pre></div>
<pre><code>## # A tibble: 34,786 × 3
##    plot_id species_id weight
##      &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;
##  1       2 NL             NA
##  2       2 NL             NA
##  3       2 NL             NA
##  4       2 NL             NA
##  5       2 NL             NA
##  6       2 NL             NA
##  7       2 NL             NA
##  8       2 NL             NA
##  9       2 NL            218
## 10       2 NL             NA
## # … with 34,776 more rows</code></pre>
<p>To select all columns <em>except</em> certain ones, put a “-” in front of
the variable to exclude it.</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="data-analysis-with-r.html#cb190-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">select</span>(df, <span class="sc">-</span>record_id, <span class="sc">-</span>species_id)</span></code></pre></div>
<pre><code>## # A tibble: 34,786 × 11
##    month   day  year plot_id sex   hindfoot…¹ weight genus species taxa  plot_…²
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;  
##  1     7    16  1977       2 M             32     NA Neot… albigu… Rode… Control
##  2     8    19  1977       2 M             31     NA Neot… albigu… Rode… Control
##  3     9    13  1977       2 &lt;NA&gt;          NA     NA Neot… albigu… Rode… Control
##  4    10    16  1977       2 &lt;NA&gt;          NA     NA Neot… albigu… Rode… Control
##  5    11    12  1977       2 &lt;NA&gt;          NA     NA Neot… albigu… Rode… Control
##  6    11    12  1977       2 &lt;NA&gt;          NA     NA Neot… albigu… Rode… Control
##  7    12    10  1977       2 &lt;NA&gt;          NA     NA Neot… albigu… Rode… Control
##  8     1     8  1978       2 &lt;NA&gt;          NA     NA Neot… albigu… Rode… Control
##  9     2    18  1978       2 M             NA    218 Neot… albigu… Rode… Control
## 10     3    11  1978       2 &lt;NA&gt;          NA     NA Neot… albigu… Rode… Control
## # … with 34,776 more rows, and abbreviated variable names ¹​hindfoot_length,
## #   ²​plot_type</code></pre>
<p>This will select all the variables in <code>df</code> except <code>record_id</code>
and <code>species_id</code>.</p>
<p>To choose rows based on a specific criteria, use <code>filter()</code>:</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="data-analysis-with-r.html#cb192-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">filter</span>(df, year <span class="sc">==</span> <span class="dv">1995</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1,180 × 13
##    record…¹ month   day  year plot_id speci…² sex   hindf…³ weight genus species
##       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;  
##  1    22314     6     7  1995       2 NL      M          34     NA Neot… albigu…
##  2    22728     9    23  1995       2 NL      F          32    165 Neot… albigu…
##  3    22899    10    28  1995       2 NL      F          32    171 Neot… albigu…
##  4    23032    12     2  1995       2 NL      F          33     NA Neot… albigu…
##  5    22003     1    11  1995       2 DM      M          37     41 Dipo… merria…
##  6    22042     2     4  1995       2 DM      F          36     45 Dipo… merria…
##  7    22044     2     4  1995       2 DM      M          37     46 Dipo… merria…
##  8    22105     3     4  1995       2 DM      F          37     49 Dipo… merria…
##  9    22109     3     4  1995       2 DM      M          37     46 Dipo… merria…
## 10    22168     4     1  1995       2 DM      M          36     48 Dipo… merria…
## # … with 1,170 more rows, 2 more variables: taxa &lt;chr&gt;, plot_type &lt;chr&gt;, and
## #   abbreviated variable names ¹​record_id, ²​species_id, ³​hindfoot_length</code></pre>
</div>
<div id="pipes" class="section level4 hasAnchor" number="3.8.1.3">
<h4><span class="header-section-number">3.8.1.3</span> Pipes<a href="data-analysis-with-r.html#pipes" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>What if you want to select and filter at the same time? There are three
ways to do this: use intermediate steps, nested functions, or pipes.</p>
<p>With intermediate steps, you create a temporary data frame and use
that as input to the next function, like this:</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="data-analysis-with-r.html#cb194-1" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(df, weight <span class="sc">&lt;</span> <span class="dv">5</span>)</span>
<span id="cb194-2"><a href="data-analysis-with-r.html#cb194-2" aria-hidden="true" tabindex="-1"></a>df2_sml <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(df2, species_id, sex, weight)</span></code></pre></div>
<p>This is readable, but can clutter up your workspace with lots of objects that you have to name individually. With multiple steps, that can be hard to keep track of.</p>
<p>You can also nest functions (i.e. one function inside of another), like this:</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="data-analysis-with-r.html#cb195-1" aria-hidden="true" tabindex="-1"></a>df_sml <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">filter</span>(df, weight <span class="sc">&lt;</span> <span class="dv">5</span>), species_id, sex, weight)</span></code></pre></div>
<p>This is handy, but can be difficult to read if too many functions are nested, as
R evaluates the expression from the inside out (in this case, filtering, then selecting).</p>
<p>The last option, <em>pipes</em>, are a recent addition to R. Pipes let you take
the output of one function and send it directly to the next, which is useful
when you need to do many things to the same dataset. Pipes in R look like
<code>%&gt;%</code> and are made available via the <strong><code>magrittr</code></strong> package, installed automatically
with <strong><code>dplyr</code></strong>. If you use RStudio, you can type the pipe with <kbd>Ctrl</kbd>
+ <kbd>Shift</kbd> + <kbd>M</kbd> if you have a PC or <kbd>Cmd</kbd> +
<kbd>Shift</kbd> + <kbd>M</kbd> if you have a Mac.</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="data-analysis-with-r.html#cb196-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb196-2"><a href="data-analysis-with-r.html#cb196-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(weight <span class="sc">&lt;</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb196-3"><a href="data-analysis-with-r.html#cb196-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(species_id, sex, weight)</span></code></pre></div>
<pre><code>## # A tibble: 17 × 3
##    species_id sex   weight
##    &lt;chr&gt;      &lt;chr&gt;  &lt;dbl&gt;
##  1 PF         F          4
##  2 PF         F          4
##  3 PF         M          4
##  4 RM         F          4
##  5 RM         M          4
##  6 PF         &lt;NA&gt;       4
##  7 PP         M          4
##  8 RM         M          4
##  9 RM         M          4
## 10 RM         M          4
## 11 PF         M          4
## 12 PF         F          4
## 13 RM         M          4
## 14 RM         M          4
## 15 RM         F          4
## 16 RM         M          4
## 17 RM         M          4</code></pre>
<p>In the above code, we use the pipe to send the <code>df</code> dataset first through
<code>filter()</code> to keep rows where <code>weight</code> is less than 5, then through <code>select()</code>
to keep only the <code>species_id</code>, <code>sex</code>, and <code>weight</code> columns. Since <code>%&gt;%</code> takes
the object on its left and passes it as the first argument to the function on
its right, we don’t need to explicitly include the data frame as an argument
to the <code>filter()</code> and <code>select()</code> functions any more.</p>
<p>Some may find it helpful to read the pipe like the word “then”. For instance,
in the above example, we took the data frame <code>df</code>, <em>then</em> we <code>filter</code>ed
for rows with <code>weight &lt; 5</code>, <em>then</em> we <code>select</code>ed columns <code>species_id</code>, <code>sex</code>,
and <code>weight</code>. The <strong><code>dplyr</code></strong> functions by themselves are somewhat simple,
but by combining them into linear workflows with the pipe, we can accomplish
more complex manipulations of data frames.</p>
<p>If we want to create a new object with this smaller version of the data, we
can assign it a new name:</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="data-analysis-with-r.html#cb198-1" aria-hidden="true" tabindex="-1"></a>df_sml <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb198-2"><a href="data-analysis-with-r.html#cb198-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(weight <span class="sc">&lt;</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb198-3"><a href="data-analysis-with-r.html#cb198-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(species_id, sex, weight)</span>
<span id="cb198-4"><a href="data-analysis-with-r.html#cb198-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-5"><a href="data-analysis-with-r.html#cb198-5" aria-hidden="true" tabindex="-1"></a>df_sml</span></code></pre></div>
<pre><code>## # A tibble: 17 × 3
##    species_id sex   weight
##    &lt;chr&gt;      &lt;chr&gt;  &lt;dbl&gt;
##  1 PF         F          4
##  2 PF         F          4
##  3 PF         M          4
##  4 RM         F          4
##  5 RM         M          4
##  6 PF         &lt;NA&gt;       4
##  7 PP         M          4
##  8 RM         M          4
##  9 RM         M          4
## 10 RM         M          4
## 11 PF         M          4
## 12 PF         F          4
## 13 RM         M          4
## 14 RM         M          4
## 15 RM         F          4
## 16 RM         M          4
## 17 RM         M          4</code></pre>
<p>Note that the final data frame is the leftmost part of this expression.</p>
<div id="mutate" class="section level5 hasAnchor" number="3.8.1.3.1">
<h5><span class="header-section-number">3.8.1.3.1</span> Mutate<a href="data-analysis-with-r.html#mutate" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Frequently you’ll want to create new columns based on the values in existing
columns, for example to do unit conversions, or to find the ratio of values in two
columns. For this we’ll use <code>mutate()</code>.</p>
<p>To create a new column of weight in kg:</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="data-analysis-with-r.html#cb200-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb200-2"><a href="data-analysis-with-r.html#cb200-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weight_kg =</span> weight <span class="sc">/</span> <span class="dv">1000</span>)</span></code></pre></div>
<pre><code>## # A tibble: 34,786 × 14
##    record…¹ month   day  year plot_id speci…² sex   hindf…³ weight genus species
##       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;  
##  1        1     7    16  1977       2 NL      M          32     NA Neot… albigu…
##  2       72     8    19  1977       2 NL      M          31     NA Neot… albigu…
##  3      224     9    13  1977       2 NL      &lt;NA&gt;       NA     NA Neot… albigu…
##  4      266    10    16  1977       2 NL      &lt;NA&gt;       NA     NA Neot… albigu…
##  5      349    11    12  1977       2 NL      &lt;NA&gt;       NA     NA Neot… albigu…
##  6      363    11    12  1977       2 NL      &lt;NA&gt;       NA     NA Neot… albigu…
##  7      435    12    10  1977       2 NL      &lt;NA&gt;       NA     NA Neot… albigu…
##  8      506     1     8  1978       2 NL      &lt;NA&gt;       NA     NA Neot… albigu…
##  9      588     2    18  1978       2 NL      M          NA    218 Neot… albigu…
## 10      661     3    11  1978       2 NL      &lt;NA&gt;       NA     NA Neot… albigu…
## # … with 34,776 more rows, 3 more variables: taxa &lt;chr&gt;, plot_type &lt;chr&gt;,
## #   weight_kg &lt;dbl&gt;, and abbreviated variable names ¹​record_id, ²​species_id,
## #   ³​hindfoot_length</code></pre>
<p>You can also create a second new column based on the first new column within the same call of <code>mutate()</code>:</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="data-analysis-with-r.html#cb202-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb202-2"><a href="data-analysis-with-r.html#cb202-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weight_kg =</span> weight <span class="sc">/</span> <span class="dv">1000</span>,</span>
<span id="cb202-3"><a href="data-analysis-with-r.html#cb202-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">weight_kg2 =</span> weight_kg <span class="sc">*</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## # A tibble: 34,786 × 15
##    record…¹ month   day  year plot_id speci…² sex   hindf…³ weight genus species
##       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;  
##  1        1     7    16  1977       2 NL      M          32     NA Neot… albigu…
##  2       72     8    19  1977       2 NL      M          31     NA Neot… albigu…
##  3      224     9    13  1977       2 NL      &lt;NA&gt;       NA     NA Neot… albigu…
##  4      266    10    16  1977       2 NL      &lt;NA&gt;       NA     NA Neot… albigu…
##  5      349    11    12  1977       2 NL      &lt;NA&gt;       NA     NA Neot… albigu…
##  6      363    11    12  1977       2 NL      &lt;NA&gt;       NA     NA Neot… albigu…
##  7      435    12    10  1977       2 NL      &lt;NA&gt;       NA     NA Neot… albigu…
##  8      506     1     8  1978       2 NL      &lt;NA&gt;       NA     NA Neot… albigu…
##  9      588     2    18  1978       2 NL      M          NA    218 Neot… albigu…
## 10      661     3    11  1978       2 NL      &lt;NA&gt;       NA     NA Neot… albigu…
## # … with 34,776 more rows, 4 more variables: taxa &lt;chr&gt;, plot_type &lt;chr&gt;,
## #   weight_kg &lt;dbl&gt;, weight_kg2 &lt;dbl&gt;, and abbreviated variable names
## #   ¹​record_id, ²​species_id, ³​hindfoot_length</code></pre>
<p>If this runs off your screen and you just want to see the first few rows, you
can use a pipe to view the <code>head()</code> of the data. (Pipes work with non-<strong><code>dplyr</code></strong>
functions, too, as long as the <strong><code>dplyr</code></strong> or <code>magrittr</code> package is loaded).</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="data-analysis-with-r.html#cb204-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb204-2"><a href="data-analysis-with-r.html#cb204-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weight_kg =</span> weight <span class="sc">/</span> <span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb204-3"><a href="data-analysis-with-r.html#cb204-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 × 14
##   record_id month   day  year plot_id speci…¹ sex   hindf…² weight genus species
##       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;  
## 1         1     7    16  1977       2 NL      M          32     NA Neot… albigu…
## 2        72     8    19  1977       2 NL      M          31     NA Neot… albigu…
## 3       224     9    13  1977       2 NL      &lt;NA&gt;       NA     NA Neot… albigu…
## 4       266    10    16  1977       2 NL      &lt;NA&gt;       NA     NA Neot… albigu…
## 5       349    11    12  1977       2 NL      &lt;NA&gt;       NA     NA Neot… albigu…
## 6       363    11    12  1977       2 NL      &lt;NA&gt;       NA     NA Neot… albigu…
## # … with 3 more variables: taxa &lt;chr&gt;, plot_type &lt;chr&gt;, weight_kg &lt;dbl&gt;, and
## #   abbreviated variable names ¹​species_id, ²​hindfoot_length</code></pre>
<p>The first few rows of the output are full of <code>NA</code>s, so if we wanted to remove
those we could insert a <code>filter()</code> in the chain:</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="data-analysis-with-r.html#cb206-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb206-2"><a href="data-analysis-with-r.html#cb206-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(weight)) <span class="sc">%&gt;%</span></span>
<span id="cb206-3"><a href="data-analysis-with-r.html#cb206-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weight_kg =</span> weight <span class="sc">/</span> <span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb206-4"><a href="data-analysis-with-r.html#cb206-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 × 14
##   record_id month   day  year plot_id speci…¹ sex   hindf…² weight genus species
##       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;  
## 1       588     2    18  1978       2 NL      M          NA    218 Neot… albigu…
## 2       845     5     6  1978       2 NL      M          32    204 Neot… albigu…
## 3       990     6     9  1978       2 NL      M          NA    200 Neot… albigu…
## 4      1164     8     5  1978       2 NL      M          34    199 Neot… albigu…
## 5      1261     9     4  1978       2 NL      M          32    197 Neot… albigu…
## 6      1453    11     5  1978       2 NL      M          NA    218 Neot… albigu…
## # … with 3 more variables: taxa &lt;chr&gt;, plot_type &lt;chr&gt;, weight_kg &lt;dbl&gt;, and
## #   abbreviated variable names ¹​species_id, ²​hindfoot_length</code></pre>
<p><code>is.na()</code> is a function that determines whether something is an <code>NA</code>. The <code>!</code>
symbol negates the result, so we’re asking for every row where weight <em>is not</em> an <code>NA</code>.</p>
</div>
<div id="split-apply-combine-data-analysis-and-the-summarize-function" class="section level5 hasAnchor" number="3.8.1.3.2">
<h5><span class="header-section-number">3.8.1.3.2</span> Split-apply-combine data analysis and the <code>summarize()</code> function<a href="data-analysis-with-r.html#split-apply-combine-data-analysis-and-the-summarize-function" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Many data analysis tasks can be approached using the <em>split-apply-combine</em>
paradigm: split the data into groups, apply some analysis to each group, and
then combine the results. <strong><code>dplyr</code></strong> makes this very easy through the use of the
<code>group_by()</code> function.</p>
<div id="the-summarize-function" class="section level6 hasAnchor" number="3.8.1.3.2.1">
<h6><span class="header-section-number">3.8.1.3.2.1</span> The <code>summarize()</code> function<a href="data-analysis-with-r.html#the-summarize-function" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<p><code>group_by()</code> is often used together with <code>summarize()</code>, which collapses each
group into a single-row summary of that group. <code>group_by()</code> takes as arguments
the column names that contain the <strong>categorical</strong> variables for which you want
to calculate the summary statistics. So to compute the mean <code>weight</code> by sex:</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="data-analysis-with-r.html#cb208-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb208-2"><a href="data-analysis-with-r.html#cb208-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sex) <span class="sc">%&gt;%</span></span>
<span id="cb208-3"><a href="data-analysis-with-r.html#cb208-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_weight =</span> <span class="fu">mean</span>(weight, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>## # A tibble: 3 × 2
##   sex   mean_weight
##   &lt;chr&gt;       &lt;dbl&gt;
## 1 F            42.2
## 2 M            43.0
## 3 &lt;NA&gt;         64.7</code></pre>
<p>You may also have noticed that the output from these calls doesn’t run off the
screen anymore. It’s one of the advantages of <code>tbl_df</code> over data frame.</p>
<p>You can also group by multiple columns:</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="data-analysis-with-r.html#cb210-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb210-2"><a href="data-analysis-with-r.html#cb210-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sex, species_id) <span class="sc">%&gt;%</span></span>
<span id="cb210-3"><a href="data-analysis-with-r.html#cb210-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_weight =</span> <span class="fu">mean</span>(weight, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>## # A tibble: 92 × 3
## # Groups:   sex [3]
##    sex   species_id mean_weight
##    &lt;chr&gt; &lt;chr&gt;            &lt;dbl&gt;
##  1 F     BA                9.16
##  2 F     DM               41.6 
##  3 F     DO               48.5 
##  4 F     DS              118.  
##  5 F     NL              154.  
##  6 F     OL               31.1 
##  7 F     OT               24.8 
##  8 F     OX               21   
##  9 F     PB               30.2 
## 10 F     PE               22.8 
## # … with 82 more rows</code></pre>
<p>When grouping both by <code>sex</code> and <code>species_id</code>, the last few rows are for animals
that escaped before their sex and body weights could be determined. You may notice
that the last column does not contain <code>NA</code> but <code>NaN</code> (which refers to “Not a
Number”). To avoid this, we can remove the missing values for weight before we
attempt to calculate the summary statistics on weight. Because the missing
values are removed first, we can omit <code>na.rm = TRUE</code> when computing the mean:</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="data-analysis-with-r.html#cb212-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb212-2"><a href="data-analysis-with-r.html#cb212-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(weight)) <span class="sc">%&gt;%</span></span>
<span id="cb212-3"><a href="data-analysis-with-r.html#cb212-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sex, species_id) <span class="sc">%&gt;%</span></span>
<span id="cb212-4"><a href="data-analysis-with-r.html#cb212-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_weight =</span> <span class="fu">mean</span>(weight))</span></code></pre></div>
<pre><code>## # A tibble: 64 × 3
## # Groups:   sex [3]
##    sex   species_id mean_weight
##    &lt;chr&gt; &lt;chr&gt;            &lt;dbl&gt;
##  1 F     BA                9.16
##  2 F     DM               41.6 
##  3 F     DO               48.5 
##  4 F     DS              118.  
##  5 F     NL              154.  
##  6 F     OL               31.1 
##  7 F     OT               24.8 
##  8 F     OX               21   
##  9 F     PB               30.2 
## 10 F     PE               22.8 
## # … with 54 more rows</code></pre>
<p>Here, again, the output from these calls doesn’t run off the screen
anymore. If you want to display more data, you can use the <code>print()</code> function
at the end of your chain with the argument <code>n</code> specifying the number of rows to
display:</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="data-analysis-with-r.html#cb214-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb214-2"><a href="data-analysis-with-r.html#cb214-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(weight)) <span class="sc">%&gt;%</span></span>
<span id="cb214-3"><a href="data-analysis-with-r.html#cb214-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sex, species_id) <span class="sc">%&gt;%</span></span>
<span id="cb214-4"><a href="data-analysis-with-r.html#cb214-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_weight =</span> <span class="fu">mean</span>(weight)) <span class="sc">%&gt;%</span></span>
<span id="cb214-5"><a href="data-analysis-with-r.html#cb214-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">15</span>)</span></code></pre></div>
<pre><code>## # A tibble: 64 × 3
## # Groups:   sex [3]
##    sex   species_id mean_weight
##    &lt;chr&gt; &lt;chr&gt;            &lt;dbl&gt;
##  1 F     BA                9.16
##  2 F     DM               41.6 
##  3 F     DO               48.5 
##  4 F     DS              118.  
##  5 F     NL              154.  
##  6 F     OL               31.1 
##  7 F     OT               24.8 
##  8 F     OX               21   
##  9 F     PB               30.2 
## 10 F     PE               22.8 
## 11 F     PF                7.97
## 12 F     PH               30.8 
## 13 F     PL               19.3 
## 14 F     PM               22.1 
## 15 F     PP               17.2 
## # … with 49 more rows</code></pre>
<p>Once the data are grouped, you can also summarize multiple variables at the same
time (and not necessarily on the same variable). For instance, we could add a
column indicating the minimum weight for each species for each sex:</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="data-analysis-with-r.html#cb216-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb216-2"><a href="data-analysis-with-r.html#cb216-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(weight)) <span class="sc">%&gt;%</span></span>
<span id="cb216-3"><a href="data-analysis-with-r.html#cb216-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sex, species_id) <span class="sc">%&gt;%</span></span>
<span id="cb216-4"><a href="data-analysis-with-r.html#cb216-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_weight =</span> <span class="fu">mean</span>(weight),</span>
<span id="cb216-5"><a href="data-analysis-with-r.html#cb216-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">min_weight =</span> <span class="fu">min</span>(weight))</span></code></pre></div>
<pre><code>## # A tibble: 64 × 4
## # Groups:   sex [3]
##    sex   species_id mean_weight min_weight
##    &lt;chr&gt; &lt;chr&gt;            &lt;dbl&gt;      &lt;dbl&gt;
##  1 F     BA                9.16          6
##  2 F     DM               41.6          10
##  3 F     DO               48.5          12
##  4 F     DS              118.           45
##  5 F     NL              154.           32
##  6 F     OL               31.1          10
##  7 F     OT               24.8           5
##  8 F     OX               21            20
##  9 F     PB               30.2          12
## 10 F     PE               22.8          11
## # … with 54 more rows</code></pre>
<p>It is sometimes useful to rearrange the result of a query to inspect the values. For instance, we can sort on <code>min_weight</code> to put the lighter species first:</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="data-analysis-with-r.html#cb218-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb218-2"><a href="data-analysis-with-r.html#cb218-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(weight)) <span class="sc">%&gt;%</span></span>
<span id="cb218-3"><a href="data-analysis-with-r.html#cb218-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sex, species_id) <span class="sc">%&gt;%</span></span>
<span id="cb218-4"><a href="data-analysis-with-r.html#cb218-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_weight =</span> <span class="fu">mean</span>(weight),</span>
<span id="cb218-5"><a href="data-analysis-with-r.html#cb218-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">min_weight =</span> <span class="fu">min</span>(weight)) <span class="sc">%&gt;%</span></span>
<span id="cb218-6"><a href="data-analysis-with-r.html#cb218-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(min_weight)</span></code></pre></div>
<pre><code>## # A tibble: 64 × 4
## # Groups:   sex [3]
##    sex   species_id mean_weight min_weight
##    &lt;chr&gt; &lt;chr&gt;            &lt;dbl&gt;      &lt;dbl&gt;
##  1 F     PF                7.97          4
##  2 F     RM               11.1           4
##  3 M     PF                7.89          4
##  4 M     PP               17.2           4
##  5 M     RM               10.1           4
##  6 &lt;NA&gt;  PF                6             4
##  7 F     OT               24.8           5
##  8 F     PP               17.2           5
##  9 F     BA                9.16          6
## 10 M     BA                7.36          6
## # … with 54 more rows</code></pre>
<p>To sort in descending order, we need to add the <code>desc()</code> function. If we want to sort the results by decreasing order of mean weight:</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="data-analysis-with-r.html#cb220-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb220-2"><a href="data-analysis-with-r.html#cb220-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(weight)) <span class="sc">%&gt;%</span></span>
<span id="cb220-3"><a href="data-analysis-with-r.html#cb220-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sex, species_id) <span class="sc">%&gt;%</span></span>
<span id="cb220-4"><a href="data-analysis-with-r.html#cb220-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_weight =</span> <span class="fu">mean</span>(weight),</span>
<span id="cb220-5"><a href="data-analysis-with-r.html#cb220-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">min_weight =</span> <span class="fu">min</span>(weight)) <span class="sc">%&gt;%</span></span>
<span id="cb220-6"><a href="data-analysis-with-r.html#cb220-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(mean_weight))</span></code></pre></div>
<pre><code>## # A tibble: 64 × 4
## # Groups:   sex [3]
##    sex   species_id mean_weight min_weight
##    &lt;chr&gt; &lt;chr&gt;            &lt;dbl&gt;      &lt;dbl&gt;
##  1 &lt;NA&gt;  NL               168.          83
##  2 M     NL               166.          30
##  3 F     NL               154.          32
##  4 M     SS               130          130
##  5 &lt;NA&gt;  SH               130          130
##  6 M     DS               122.          12
##  7 &lt;NA&gt;  DS               120           78
##  8 F     DS               118.          45
##  9 F     SH                78.8         30
## 10 F     SF                69           46
## # … with 54 more rows</code></pre>
</div>
<div id="counting" class="section level6 hasAnchor" number="3.8.1.3.2.2">
<h6><span class="header-section-number">3.8.1.3.2.2</span> Counting<a href="data-analysis-with-r.html#counting" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<p>When working with data, we often want to know the number of observations found
for each factor or combination of factors. For this task, <strong><code>dplyr</code></strong> provides
<code>count()</code>. For example, if we wanted to count the number of rows of data for
each sex, we would do:</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="data-analysis-with-r.html#cb222-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb222-2"><a href="data-analysis-with-r.html#cb222-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(sex) </span></code></pre></div>
<pre><code>## # A tibble: 3 × 2
##   sex       n
##   &lt;chr&gt; &lt;int&gt;
## 1 F     15690
## 2 M     17348
## 3 &lt;NA&gt;   1748</code></pre>
<p>The <code>count()</code> function is shorthand for something we’ve already seen: grouping by a variable, and summarizing it by counting the number of observations in that group. In other words, <code>df %&gt;% count()</code> is equivalent to:</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="data-analysis-with-r.html#cb224-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb224-2"><a href="data-analysis-with-r.html#cb224-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(sex) <span class="sc">%&gt;%</span></span>
<span id="cb224-3"><a href="data-analysis-with-r.html#cb224-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span></code></pre></div>
<pre><code>## # A tibble: 3 × 2
##   sex   count
##   &lt;chr&gt; &lt;int&gt;
## 1 F     15690
## 2 M     17348
## 3 &lt;NA&gt;   1748</code></pre>
<p>For convenience, <code>count()</code> provides the <code>sort</code> argument:</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="data-analysis-with-r.html#cb226-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb226-2"><a href="data-analysis-with-r.html#cb226-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(sex, <span class="at">sort =</span> <span class="cn">TRUE</span>) </span></code></pre></div>
<pre><code>## # A tibble: 3 × 2
##   sex       n
##   &lt;chr&gt; &lt;int&gt;
## 1 M     17348
## 2 F     15690
## 3 &lt;NA&gt;   1748</code></pre>
<p>Previous example shows the use of <code>count()</code> to count the number of rows/observations
for <em>one</em> factor (i.e., <code>sex</code>).
If we wanted to count <em>combination of factors</em>, such as <code>sex</code> and <code>species</code>,
we would specify the first and the second factor as the arguments of <code>count()</code>:</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="data-analysis-with-r.html#cb228-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb228-2"><a href="data-analysis-with-r.html#cb228-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sex, species) </span></code></pre></div>
<pre><code>## # A tibble: 81 × 3
##    sex   species         n
##    &lt;chr&gt; &lt;chr&gt;       &lt;int&gt;
##  1 F     albigula      675
##  2 F     baileyi      1646
##  3 F     eremicus      579
##  4 F     flavus        757
##  5 F     fulvescens     57
##  6 F     fulviventer    17
##  7 F     hispidus       99
##  8 F     leucogaster   475
##  9 F     leucopus       16
## 10 F     maniculatus   382
## # … with 71 more rows</code></pre>
<p>With the above code, we can proceed with <code>arrange()</code> to sort the table
according to a number of criteria so that we have a better comparison.
For instance, we might want to arrange the table above in (i) an alphabetical order of
the levels of the species and (ii) in descending order of the count:</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="data-analysis-with-r.html#cb230-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb230-2"><a href="data-analysis-with-r.html#cb230-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sex, species) <span class="sc">%&gt;%</span></span>
<span id="cb230-3"><a href="data-analysis-with-r.html#cb230-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(species, <span class="fu">desc</span>(n))</span></code></pre></div>
<pre><code>## # A tibble: 81 × 3
##    sex   species             n
##    &lt;chr&gt; &lt;chr&gt;           &lt;int&gt;
##  1 F     albigula          675
##  2 M     albigula          502
##  3 &lt;NA&gt;  albigula           75
##  4 &lt;NA&gt;  audubonii          75
##  5 F     baileyi          1646
##  6 M     baileyi          1216
##  7 &lt;NA&gt;  baileyi            29
##  8 &lt;NA&gt;  bilineata         303
##  9 &lt;NA&gt;  brunneicapillus    50
## 10 &lt;NA&gt;  chlorurus          39
## # … with 71 more rows</code></pre>
<p>From the table above, we may learn that, for instance, there are 75 observations of
the <em>albigula</em> species that are not specified for its sex (i.e. <code>NA</code>).</p>
</div>
</div>
<div id="reshaping-with-gather-and-spread" class="section level5 hasAnchor" number="3.8.1.3.3">
<h5><span class="header-section-number">3.8.1.3.3</span> Reshaping with gather and spread<a href="data-analysis-with-r.html#reshaping-with-gather-and-spread" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>In the spreadsheet
lesson, we discussed how to structure our data leading to the four rules defining a tidy
dataset:</p>
<ol style="list-style-type: decimal">
<li>Each variable has its own column</li>
<li>Each observation has its own row</li>
<li>Each value must have its own cell</li>
<li>Each type of observational unit forms a table</li>
</ol>
<p>Here we examine the fourth rule: Each type of observational unit forms a table.</p>
<p>In <code>df</code> , the rows of <code>df</code> contain the values of variables associated
with each record (the unit), values such the weight or sex of each animal
associated with each record. What if instead of comparing records, we
wanted to compare the different mean weight of each species between plots? (Ignoring <code>plot_type</code> for simplicity).</p>
<p>We’d need to create a new table where each row (the unit) is comprised of values of variables associated with each plot. In practical terms this means the values
of the species in <code>genus</code> would become the names of column variables and the cells would contain the values of the mean weight observed on each plot.</p>
<p>Having created a new table, it is therefore straightforward to explore the
relationship between the weight of different species within, and between, the
plots. The key point here is that we are still following a tidy data structure,
but we have <strong>reshaped</strong> the data according to the observations of interest:
average species weight per plot instead of recordings per date.</p>
<p>The opposite transformation would be to transform column names into values of
a variable.</p>
<p>We can do both these of transformations with two <code>tidyr</code> functions, <code>spread()</code>
and <code>gather()</code>.</p>
<div id="spreading" class="section level6 hasAnchor" number="3.8.1.3.3.1">
<h6><span class="header-section-number">3.8.1.3.3.1</span> Spreading<a href="data-analysis-with-r.html#spreading" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<p><code>spread()</code> takes three principal arguments:</p>
<ol style="list-style-type: decimal">
<li>the data</li>
<li>the <em>key</em> column variable whose values will become new column names.<br />
</li>
<li>the <em>value</em> column variable whose values will fill the new column variables.</li>
</ol>
<p>Further arguments include <code>fill</code> which, if set, fills in missing values with
the value provided.</p>
<p>Let’s use <code>spread()</code> to transform df to find the mean weight of each
species in each plot over the entire survey period. We use <code>filter()</code>,
<code>group_by()</code> and <code>summarise()</code> to filter our observations and variables of
interest, and create a new variable for the <code>mean_weight</code>. We use the pipe as
before too.</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="data-analysis-with-r.html#cb232-1" aria-hidden="true" tabindex="-1"></a>df_gw <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb232-2"><a href="data-analysis-with-r.html#cb232-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(weight)) <span class="sc">%&gt;%</span></span>
<span id="cb232-3"><a href="data-analysis-with-r.html#cb232-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(genus, plot_id) <span class="sc">%&gt;%</span></span>
<span id="cb232-4"><a href="data-analysis-with-r.html#cb232-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_weight =</span> <span class="fu">mean</span>(weight))</span>
<span id="cb232-5"><a href="data-analysis-with-r.html#cb232-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-6"><a href="data-analysis-with-r.html#cb232-6" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df_gw)</span></code></pre></div>
<pre><code>## gropd_df [196 × 3] (S3: grouped_df/tbl_df/tbl/data.frame)
##  $ genus      : chr [1:196] &quot;Baiomys&quot; &quot;Baiomys&quot; &quot;Baiomys&quot; &quot;Baiomys&quot; ...
##  $ plot_id    : num [1:196] 1 2 3 5 18 19 20 21 1 2 ...
##  $ mean_weight: num [1:196] 7 6 8.61 7.75 9.5 ...
##  - attr(*, &quot;groups&quot;)= tibble [10 × 2] (S3: tbl_df/tbl/data.frame)
##   ..$ genus: chr [1:10] &quot;Baiomys&quot; &quot;Chaetodipus&quot; &quot;Dipodomys&quot; &quot;Neotoma&quot; ...
##   ..$ .rows: list&lt;int&gt; [1:10] 
##   .. ..$ : int [1:8] 1 2 3 4 5 6 7 8
##   .. ..$ : int [1:24] 9 10 11 12 13 14 15 16 17 18 ...
##   .. ..$ : int [1:24] 33 34 35 36 37 38 39 40 41 42 ...
##   .. ..$ : int [1:24] 57 58 59 60 61 62 63 64 65 66 ...
##   .. ..$ : int [1:24] 81 82 83 84 85 86 87 88 89 90 ...
##   .. ..$ : int [1:23] 105 106 107 108 109 110 111 112 113 114 ...
##   .. ..$ : int [1:24] 128 129 130 131 132 133 134 135 136 137 ...
##   .. ..$ : int [1:24] 152 153 154 155 156 157 158 159 160 161 ...
##   .. ..$ : int [1:19] 176 177 178 179 180 181 182 183 184 185 ...
##   .. ..$ : int [1:2] 195 196
##   .. ..@ ptype: int(0) 
##   ..- attr(*, &quot;.drop&quot;)= logi TRUE</code></pre>
<p>This yields <code>df_gw</code> where the observations for each plot are spread across
multiple rows, 196 observations of 3 variables.
Using <code>spread()</code> to key on <code>genus</code> with values from <code>mean_weight</code> this becomes
24 observations of 11 variables, one row for each plot. We again use pipes:</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="data-analysis-with-r.html#cb234-1" aria-hidden="true" tabindex="-1"></a>df_spread <span class="ot">&lt;-</span>df_gw <span class="sc">%&gt;%</span></span>
<span id="cb234-2"><a href="data-analysis-with-r.html#cb234-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(<span class="at">key =</span> genus, <span class="at">value =</span> mean_weight)</span>
<span id="cb234-3"><a href="data-analysis-with-r.html#cb234-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-4"><a href="data-analysis-with-r.html#cb234-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df_spread)</span></code></pre></div>
<pre><code>## tibble [24 × 11] (S3: tbl_df/tbl/data.frame)
##  $ plot_id        : num [1:24] 1 2 3 4 5 6 7 8 9 10 ...
##  $ Baiomys        : num [1:24] 7 6 8.61 NA 7.75 ...
##  $ Chaetodipus    : num [1:24] 22.2 25.1 24.6 23 18 ...
##  $ Dipodomys      : num [1:24] 60.2 55.7 52 57.5 51.1 ...
##  $ Neotoma        : num [1:24] 156 169 158 164 190 ...
##  $ Onychomys      : num [1:24] 27.7 26.9 26 28.1 27 ...
##  $ Perognathus    : num [1:24] 9.62 6.95 7.51 7.82 8.66 ...
##  $ Peromyscus     : num [1:24] 22.2 22.3 21.4 22.6 21.2 ...
##  $ Reithrodontomys: num [1:24] 11.4 10.7 10.5 10.3 11.2 ...
##  $ Sigmodon       : num [1:24] NA 70.9 65.6 82 82.7 ...
##  $ Spermophilus   : num [1:24] NA NA NA NA NA NA NA NA NA NA ...</code></pre>
<p><img src="image/spread_data_R.png" width="400" /></p>
</div>
</div>
</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-cleaning-with-openrefine.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-visualization-with-r.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/mesfind/Proposal/edit/master/Chapter3.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["Rmanual.pdf", "PDF"], ["Rmanual.epub", "EPUB"], ["Rmanual.docx", "Word"]],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
