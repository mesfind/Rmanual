<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Data Visualization with R | R Manual</title>
  <meta name="description" content="R and Manul" />
  <meta name="generator" content="bookdown 0.30 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Data Visualization with R | R Manual" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/fig/MWULogo.jpeg" />
  <meta property="og:description" content="R and Manul" />
  <meta name="github-repo" content="Chapter 4 Data Visualization with R | R Manual" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Data Visualization with R | R Manual" />
  
  <meta name="twitter:description" content="R and Manul" />
  <meta name="twitter:image" content="/fig/MWULogo.jpeg" />



<meta name="date" content="2022-11-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-analysis-with-r.html"/>
<link rel="next" href="special-ggplot2-plotting-extensions.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.1.1/leaflet-providers-plugin.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software-information-and-conventions"><i class="fa fa-check"></i>Software information and conventions</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="data-organization-with-spreadsheet.html"><a href="data-organization-with-spreadsheet.html"><i class="fa fa-check"></i><b>1</b> Data Organization with Spreadsheet</a>
<ul>
<li class="chapter" data-level="1.1" data-path="data-organization-with-spreadsheet.html"><a href="data-organization-with-spreadsheet.html#spreadsheet-programs"><i class="fa fa-check"></i><b>1.1</b> Spreadsheet Programs</a></li>
<li class="chapter" data-level="1.2" data-path="data-organization-with-spreadsheet.html"><a href="data-organization-with-spreadsheet.html#formatting-data-tables"><i class="fa fa-check"></i><b>1.2</b> Formatting data tables</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="data-organization-with-spreadsheet.html"><a href="data-organization-with-spreadsheet.html#problems-with-spreadsheets"><i class="fa fa-check"></i><b>1.2.1</b> Problems with Spreadsheets</a></li>
<li class="chapter" data-level="1.2.2" data-path="data-organization-with-spreadsheet.html"><a href="data-organization-with-spreadsheet.html#use-of-spreadsheets-for-data-entery-and-cleaning"><i class="fa fa-check"></i><b>1.2.2</b> Use of Spreadsheets for Data Entery and Cleaning</a></li>
<li class="chapter" data-level="1.2.3" data-path="data-organization-with-spreadsheet.html"><a href="data-organization-with-spreadsheet.html#keeping-track-of-your-analyses"><i class="fa fa-check"></i><b>1.2.3</b> Keeping track of your analyses</a></li>
<li class="chapter" data-level="1.2.4" data-path="data-organization-with-spreadsheet.html"><a href="data-organization-with-spreadsheet.html#structuring-data-in-spreadsheets"><i class="fa fa-check"></i><b>1.2.4</b> Structuring data in spreadsheets</a></li>
<li class="chapter" data-level="1.2.5" data-path="data-organization-with-spreadsheet.html"><a href="data-organization-with-spreadsheet.html#columns-for-variables-and-rows-for-observations"><i class="fa fa-check"></i><b>1.2.5</b> Columns for variables and rows for observations</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="data-organization-with-spreadsheet.html"><a href="data-organization-with-spreadsheet.html#common-spreadsheet-errors"><i class="fa fa-check"></i><b>1.3</b> Common Spreadsheet Errors</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="data-organization-with-spreadsheet.html"><a href="data-organization-with-spreadsheet.html#using-multiple-tabs"><i class="fa fa-check"></i><b>1.3.1</b> Using multiple tabs</a></li>
<li class="chapter" data-level="1.3.2" data-path="data-organization-with-spreadsheet.html"><a href="data-organization-with-spreadsheet.html#not-filling-in-zeros"><i class="fa fa-check"></i><b>1.3.2</b> Not filling in zeros</a></li>
<li class="chapter" data-level="1.3.3" data-path="data-organization-with-spreadsheet.html"><a href="data-organization-with-spreadsheet.html#using-problematic-null-values"><i class="fa fa-check"></i><b>1.3.3</b> Using problematic null values</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="data-organization-with-spreadsheet.html"><a href="data-organization-with-spreadsheet.html#date-as-data"><i class="fa fa-check"></i><b>1.4</b> Date as data</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html"><i class="fa fa-check"></i><b>2</b> Data Cleaning with OpenRefine</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#layout"><i class="fa fa-check"></i><b>2.1</b> Layout</a></li>
<li class="chapter" data-level="2.2" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#records-and-rows"><i class="fa fa-check"></i><b>2.2</b> Records and Rows</a></li>
<li class="chapter" data-level="2.3" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#changing-the-grid-view"><i class="fa fa-check"></i><b>2.3</b> Changing the Grid View</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#permanent-changes"><i class="fa fa-check"></i><b>2.3.1</b> Permanent Changes</a></li>
<li class="chapter" data-level="2.3.2" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#non-permanent-changes"><i class="fa fa-check"></i><b>2.3.2</b> Non-Permanent Changes</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#data-mining-and-discovery"><i class="fa fa-check"></i><b>2.4</b> Data Mining and Discovery</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#reordering-columns"><i class="fa fa-check"></i><b>2.4.1</b> Reordering Columns</a></li>
<li class="chapter" data-level="2.4.2" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#sorting-data"><i class="fa fa-check"></i><b>2.4.2</b> Sorting Data</a></li>
<li class="chapter" data-level="2.4.3" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#text-based-discovery"><i class="fa fa-check"></i><b>2.4.3</b> Text Based Discovery</a></li>
<li class="chapter" data-level="2.4.4" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#number-and-data-based-discovery"><i class="fa fa-check"></i><b>2.4.4</b> Number and Data Based Discovery</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#data-preparation-and-normalization"><i class="fa fa-check"></i><b>2.5</b> Data Preparation and Normalization</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#common-transformations"><i class="fa fa-check"></i><b>2.5.1</b> Common Transformations</a></li>
<li class="chapter" data-level="2.5.2" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#removing-duplicates"><i class="fa fa-check"></i><b>2.5.2</b> Removing Duplicates</a></li>
<li class="chapter" data-level="2.5.3" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#splitting-cell-values"><i class="fa fa-check"></i><b>2.5.3</b> Splitting Cell Values</a></li>
<li class="chapter" data-level="2.5.4" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#combining-cell-values"><i class="fa fa-check"></i><b>2.5.4</b> Combining cell Values</a></li>
<li class="chapter" data-level="2.5.5" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#data-shaping"><i class="fa fa-check"></i><b>2.5.5</b> Data Shaping</a></li>
<li class="chapter" data-level="2.5.6" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#clustering"><i class="fa fa-check"></i><b>2.5.6</b> Clustering</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#how-to-cluster"><i class="fa fa-check"></i><b>2.6</b> How to Cluster</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html"><i class="fa fa-check"></i><b>3</b> Data Analysis with R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#what-is-r-what-is-rstudio"><i class="fa fa-check"></i><b>3.1</b> What is R? What is RStudio?</a></li>
<li class="chapter" data-level="3.2" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#why-learn-r"><i class="fa fa-check"></i><b>3.2</b> Why learn R?</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#r-does-not-involve-lots-of-pointing-and-clicking-and-thats-a-good-thing"><i class="fa fa-check"></i><b>3.2.1</b> R does not involve lots of pointing and clicking, and that’s a good thing</a></li>
<li class="chapter" data-level="3.2.2" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#r-code-is-great-for-reproducibility"><i class="fa fa-check"></i><b>3.2.2</b> R code is great for reproducibility</a></li>
<li class="chapter" data-level="3.2.3" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#r-is-interdisciplinary-and-extensible"><i class="fa fa-check"></i><b>3.2.3</b> R is interdisciplinary and extensible</a></li>
<li class="chapter" data-level="3.2.4" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#r-works-on-data-of-all-shapes-and-sizes"><i class="fa fa-check"></i><b>3.2.4</b> R works on data of all shapes and sizes</a></li>
<li class="chapter" data-level="3.2.5" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#r-produces-high-quality-graphics"><i class="fa fa-check"></i><b>3.2.5</b> R produces high-quality graphics</a></li>
<li class="chapter" data-level="3.2.6" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#r-has-a-large-and-welcoming-community"><i class="fa fa-check"></i><b>3.2.6</b> R has a large and welcoming community</a></li>
<li class="chapter" data-level="3.2.7" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#not-only-is-r-free-but-it-is-also-open-source-and-cross-platform"><i class="fa fa-check"></i><b>3.2.7</b> Not only is R free, but it is also open-source and cross-platform</a></li>
<li class="chapter" data-level="3.2.8" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#knowing-your-way-around-rstudio"><i class="fa fa-check"></i><b>3.2.8</b> Knowing your way around RStudio</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#introduction-to-r"><i class="fa fa-check"></i><b>3.3</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#comments"><i class="fa fa-check"></i><b>3.3.1</b> Comments</a></li>
<li class="chapter" data-level="3.3.2" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#functions-and-their-arguments"><i class="fa fa-check"></i><b>3.3.2</b> Functions and their arguments</a></li>
<li class="chapter" data-level="3.3.3" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#data-structure"><i class="fa fa-check"></i><b>3.3.3</b> Data Structure</a></li>
<li class="chapter" data-level="3.3.4" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#subsetting-vectors"><i class="fa fa-check"></i><b>3.3.4</b> Subsetting vectors</a></li>
<li class="chapter" data-level="3.3.5" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#conditional-subsetting"><i class="fa fa-check"></i><b>3.3.5</b> Conditional subsetting</a></li>
<li class="chapter" data-level="3.3.6" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#missing-data"><i class="fa fa-check"></i><b>3.3.6</b> Missing Data</a></li>
<li class="chapter" data-level="3.3.7" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#matrices"><i class="fa fa-check"></i><b>3.3.7</b> Matrices</a></li>
<li class="chapter" data-level="3.3.8" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#data-frames"><i class="fa fa-check"></i><b>3.3.8</b> Data Frames</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#starting-with-data"><i class="fa fa-check"></i><b>3.4</b> Starting with data</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#inspecting-data-frame-objects"><i class="fa fa-check"></i><b>3.4.1</b> Inspecting Data Frame Objects</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#indexing-and-subsetting-data-frames"><i class="fa fa-check"></i><b>3.5</b> Indexing and subsetting data frames</a></li>
<li class="chapter" data-level="3.6" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#factors-1"><i class="fa fa-check"></i><b>3.6</b> Factors</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#converting-factors"><i class="fa fa-check"></i><b>3.6.1</b> Converting factors</a></li>
<li class="chapter" data-level="3.6.2" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#renaming-factors"><i class="fa fa-check"></i><b>3.6.2</b> Renaming factors</a></li>
<li class="chapter" data-level="3.6.3" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#using-stringsasfactorsfalse"><i class="fa fa-check"></i><b>3.6.3</b> Using <code>stringsAsFactors=FALSE</code></a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#formatting-dates"><i class="fa fa-check"></i><b>3.7</b> Formatting Dates</a></li>
<li class="chapter" data-level="3.8" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#manipulating-and-analyzing-data-with-tidyverse"><i class="fa fa-check"></i><b>3.8</b> manipulating and analyzing data with tidyverse</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#data-manipulation-using-dplyr-and-tidyr"><i class="fa fa-check"></i><b>3.8.1</b> Data Manipulation using <strong><code>dplyr</code></strong> and <strong><code>tidyr</code></strong></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-visualization-with-r.html"><a href="data-visualization-with-r.html"><i class="fa fa-check"></i><b>4</b> Data Visualization with R</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-visualization-with-r.html"><a href="data-visualization-with-r.html#basics-of-ggplot2"><i class="fa fa-check"></i><b>4.1</b> Basics of ggplot2</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="data-visualization-with-r.html"><a href="data-visualization-with-r.html#importing-data"><i class="fa fa-check"></i><b>4.1.1</b> Importing data</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="data-visualization-with-r.html"><a href="data-visualization-with-r.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>4.2</b> Exploratory data analysis</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="data-visualization-with-r.html"><a href="data-visualization-with-r.html#statistical-variables-and-data"><i class="fa fa-check"></i><b>4.2.1</b> Statistical variables and data</a></li>
<li class="chapter" data-level="4.2.2" data-path="data-visualization-with-r.html"><a href="data-visualization-with-r.html#understanding-numerical-variables"><i class="fa fa-check"></i><b>4.2.2</b> Understanding numerical variables</a></li>
<li class="chapter" data-level="4.2.3" data-path="data-visualization-with-r.html"><a href="data-visualization-with-r.html#understanding-categorical-variables"><i class="fa fa-check"></i><b>4.2.3</b> Understanding categorical variables</a></li>
<li class="chapter" data-level="4.2.4" data-path="data-visualization-with-r.html"><a href="data-visualization-with-r.html#scatter-plot"><i class="fa fa-check"></i><b>4.2.4</b> Scatter plot</a></li>
<li class="chapter" data-level="4.2.5" data-path="data-visualization-with-r.html"><a href="data-visualization-with-r.html#bar-plot"><i class="fa fa-check"></i><b>4.2.5</b> Bar Plot</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="data-visualization-with-r.html"><a href="data-visualization-with-r.html#boxplots"><i class="fa fa-check"></i><b>4.3</b> Boxplots</a></li>
<li class="chapter" data-level="4.4" data-path="data-visualization-with-r.html"><a href="data-visualization-with-r.html#plotting-time-series-data"><i class="fa fa-check"></i><b>4.4</b> Plotting time series data</a></li>
<li class="chapter" data-level="4.5" data-path="data-visualization-with-r.html"><a href="data-visualization-with-r.html#line-plot"><i class="fa fa-check"></i><b>4.5</b> Line Plot</a></li>
<li class="chapter" data-level="4.6" data-path="data-visualization-with-r.html"><a href="data-visualization-with-r.html#histograpm"><i class="fa fa-check"></i><b>4.6</b> Histograpm</a></li>
<li class="chapter" data-level="4.7" data-path="data-visualization-with-r.html"><a href="data-visualization-with-r.html#arranging-plots-into-a-grid"><i class="fa fa-check"></i><b>4.7</b> Arranging plots into a grid</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="special-ggplot2-plotting-extensions.html"><a href="special-ggplot2-plotting-extensions.html"><i class="fa fa-check"></i><b>5</b> Special ggplot2 plotting extensions</a>
<ul>
<li class="chapter" data-level="5.1" data-path="special-ggplot2-plotting-extensions.html"><a href="special-ggplot2-plotting-extensions.html#ggcharts"><i class="fa fa-check"></i><b>5.1</b> ggcharts</a></li>
<li class="chapter" data-level="5.2" data-path="special-ggplot2-plotting-extensions.html"><a href="special-ggplot2-plotting-extensions.html#based-plots-with-statistical-details"><i class="fa fa-check"></i><b>5.2</b> Based Plots with Statistical Details</a></li>
<li class="chapter" data-level="5.3" data-path="special-ggplot2-plotting-extensions.html"><a href="special-ggplot2-plotting-extensions.html#gganimate"><i class="fa fa-check"></i><b>5.3</b> gganimate</a></li>
<li class="chapter" data-level="5.4" data-path="special-ggplot2-plotting-extensions.html"><a href="special-ggplot2-plotting-extensions.html#gggenes"><i class="fa fa-check"></i><b>5.4</b> gggenes</a></li>
<li class="chapter" data-level="5.5" data-path="special-ggplot2-plotting-extensions.html"><a href="special-ggplot2-plotting-extensions.html#mapping-with-r"><i class="fa fa-check"></i><b>5.5</b> Mapping with R</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="special-ggplot2-plotting-extensions.html"><a href="special-ggplot2-plotting-extensions.html#map-color"><i class="fa fa-check"></i><b>5.5.1</b> Map color</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="regression-with-r.html"><a href="regression-with-r.html"><i class="fa fa-check"></i><b>6</b> Regression with R</a>
<ul>
<li class="chapter" data-level="6.0.1" data-path="regression-with-r.html"><a href="regression-with-r.html#hypotheses-and-null-hypotheses"><i class="fa fa-check"></i><b>6.0.1</b> Hypotheses and null hypotheses</a></li>
<li class="chapter" data-level="6.0.2" data-path="regression-with-r.html"><a href="regression-with-r.html#linear-regression"><i class="fa fa-check"></i><b>6.0.2</b> Linear Regression</a></li>
<li class="chapter" data-level="6.0.3" data-path="regression-with-r.html"><a href="regression-with-r.html#generalized-linear-modelglm"><i class="fa fa-check"></i><b>6.0.3</b> Generalized Linear Model(GLM)</a></li>
<li class="chapter" data-level="6.0.4" data-path="regression-with-r.html"><a href="regression-with-r.html#logistic-regression"><i class="fa fa-check"></i><b>6.0.4</b> Logistic Regression</a></li>
<li class="chapter" data-level="6.1" data-path="regression-with-r.html"><a href="regression-with-r.html#anova-with-r"><i class="fa fa-check"></i><b>6.1</b> Anova with R</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="regression-with-r.html"><a href="regression-with-r.html#steps-to-conduct-an-anova"><i class="fa fa-check"></i><b>6.1.1</b> 3 Steps to conduct an ANOVA</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html"><i class="fa fa-check"></i><b>7</b> Scientific Publishing with Quarto in R</a>
<ul>
<li class="chapter" data-level="7.1" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#publishing-with-quarto"><i class="fa fa-check"></i><b>7.1</b> Publishing with Quarto</a></li>
<li class="chapter" data-level="7.2" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#markdown-basics"><i class="fa fa-check"></i><b>7.2</b> Markdown Basics</a></li>
<li class="chapter" data-level="7.3" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#r-markdown-syntax"><i class="fa fa-check"></i><b>7.3</b> R Markdown Syntax</a></li>
<li class="chapter" data-level="7.4" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#rendering-output"><i class="fa fa-check"></i><b>7.4</b> Rendering output</a></li>
<li class="chapter" data-level="7.5" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#how-it-works"><i class="fa fa-check"></i><b>7.5</b> How it works</a></li>
<li class="chapter" data-level="7.6" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#code-chunks"><i class="fa fa-check"></i><b>7.6</b> Code Chunks</a></li>
<li class="chapter" data-level="7.7" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#inline-code"><i class="fa fa-check"></i><b>7.7</b> Inline Code</a></li>
<li class="chapter" data-level="7.8" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#code-languages"><i class="fa fa-check"></i><b>7.8</b> Code Languages</a></li>
<li class="chapter" data-level="7.9" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#academic-journals"><i class="fa fa-check"></i><b>7.9</b> Academic Journals</a>
<ul>
<li class="chapter" data-level="7.9.1" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#get-started"><i class="fa fa-check"></i><b>7.9.1</b> Get started</a></li>
<li class="chapter" data-level="7.9.2" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#rticles-templates"><i class="fa fa-check"></i><b>7.9.2</b> rticles templates</a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#essential-commands-with-quarto"><i class="fa fa-check"></i><b>7.10</b> Essential commands with Quarto</a>
<ul>
<li class="chapter" data-level="7.10.1" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#rendering"><i class="fa fa-check"></i><b>7.10.1</b> Rendering</a></li>
<li class="chapter" data-level="7.10.2" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#authoring"><i class="fa fa-check"></i><b>7.10.2</b> Authoring</a></li>
</ul></li>
<li class="chapter" data-level="7.11" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#creating-journal-articles"><i class="fa fa-check"></i><b>7.11</b> Creating Journal Articles</a></li>
<li class="chapter" data-level="7.12" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#creating-books"><i class="fa fa-check"></i><b>7.12</b> Creating books</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="" data-path="appendex-1.html"><a href="appendex-1.html"><i class="fa fa-check"></i>Appendex 1</a>
<ul>
<li class="chapter" data-level="13" data-path="appendex-1.html"><a href="appendex-1.html#installing-r-and-rstudio"><i class="fa fa-check"></i><b>13</b> Installing R and Rstudio</a>
<ul>
<li class="chapter" data-level="13.1" data-path="appendex-1.html"><a href="appendex-1.html#installing-r"><i class="fa fa-check"></i><b>13.1</b> installing R</a></li>
<li class="chapter" data-level="13.2" data-path="appendex-1.html"><a href="appendex-1.html#installing-rstudio"><i class="fa fa-check"></i><b>13.2</b> Installing RStudio</a></li>
<li class="chapter" data-level="13.3" data-path="appendex-1.html"><a href="appendex-1.html#open-rstudio"><i class="fa fa-check"></i><b>13.3</b> Open RStudio</a></li>
<li class="chapter" data-level="13.4" data-path="appendex-1.html"><a href="appendex-1.html#installing-r-packages"><i class="fa fa-check"></i><b>13.4</b> Installing R packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="A" data-path="install-gdal-and-geos.html"><a href="install-gdal-and-geos.html"><i class="fa fa-check"></i><b>A</b> Install gdal and geos</a>
<ul>
<li class="chapter" data-level="A.1" data-path="install-gdal-and-geos.html"><a href="install-gdal-and-geos.html#on-windows"><i class="fa fa-check"></i><b>A.1</b> on Windows</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="install-mapping-library.html"><a href="install-mapping-library.html"><i class="fa fa-check"></i><b>B</b> Install Mapping Library</a></li>
<li class="chapter" data-level="C" data-path="download-spatial-data.html"><a href="download-spatial-data.html"><i class="fa fa-check"></i><b>C</b> Download spatial data</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://mesfind.github.io" target="blank">&copy Mesfin Diro</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><div class="line-block">Data Analysis , Visualization, and Scientfic Publishing with R &amp; Rstudio<br />
<br />
Participant Manual<br />
</div></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-visualization-with-r" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Data Visualization with R<a href="data-visualization-with-r.html#data-visualization-with-r" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<blockquote>
<p>“The simple graph has brought more information to the data analyst’s mind than any other device.” — John Tukey</p>
</blockquote>
<p>This chapter will show you how to use ggplot2 to visualize your data. There are various graphing systems in R, but ggplot2 is one of the most attractive and versatile. ggplot2 implements graphics language, a unified method for describing and creating graphs. By learning one system and using it in multiple locations, you can accomplish more in less time with ggplot2.</p>
<div id="basics-of-ggplot2" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Basics of ggplot2<a href="data-visualization-with-r.html#basics-of-ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The tidyverse’s main member, ggplot2, is the subject of this chapter. Load the tidyverse with this code to get access to the datasets, help pages, and functions:</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="data-visualization-with-r.html#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># it has ggplot2 package</span></span>
<span id="cb236-2"><a href="data-visualization-with-r.html#cb236-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot) <span class="co"># it allows you to save figures in .png file</span></span></code></pre></div>
<p>That one line of code loads the fundamental tidyverse packages, which are used in practically every data analysis. It also shows you which tidyverse functions clash with base R functions (or from other packages you might have loaded).</p>
<p>If the error message “there is no package called ‘tidyverse’” appears when you execute this code, you must first install it before running <strong>library()</strong> again.</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="data-visualization-with-r.html#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>)</span>
<span id="cb237-2"><a href="data-visualization-with-r.html#cb237-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<p>A package only needs to be installed once, but it must be reloaded every time you start a new session.</p>
<div id="importing-data" class="section level3 hasAnchor" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Importing data<a href="data-visualization-with-r.html#importing-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>R can read data from a variety of sources, including text files, spreadsheets, statistical packages, and database management systems. We’ll use the <code>mpg dataset</code> to demonstrate these strategies. This dataset comprises data from the US Environmental Protection Agency on 38 different car models.</p>
<div id="text-files" class="section level4 hasAnchor" number="4.1.1.1">
<h4><span class="header-section-number">4.1.1.1</span> Text files<a href="data-visualization-with-r.html#text-files" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The readr package provides functions for importing delimited text files into R data frames.</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="data-visualization-with-r.html#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr) <span class="co"># read dataset from file</span></span>
<span id="cb238-2"><a href="data-visualization-with-r.html#cb238-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">readr.show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb238-3"><a href="data-visualization-with-r.html#cb238-3" aria-hidden="true" tabindex="-1"></a><span class="co"># CSV</span></span>
<span id="cb238-4"><a href="data-visualization-with-r.html#cb238-4" aria-hidden="true" tabindex="-1"></a>mpg_csv <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/mpg.csv&quot;</span>) </span>
<span id="cb238-5"><a href="data-visualization-with-r.html#cb238-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-6"><a href="data-visualization-with-r.html#cb238-6" aria-hidden="true" tabindex="-1"></a><span class="co"># TSV</span></span>
<span id="cb238-7"><a href="data-visualization-with-r.html#cb238-7" aria-hidden="true" tabindex="-1"></a>mpg_tsv <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(<span class="st">&quot;data/mpg.tsv&quot;</span>) </span></code></pre></div>
<p>These functions assume that the variable names are on the first line of data, that values are separated by commas or tabs, and that missing data is represented by blanks.</p>
</div>
<div id="excel-spreadsheets" class="section level4 hasAnchor" number="4.1.1.2">
<h4><span class="header-section-number">4.1.1.2</span> Excel spreadsheets<a href="data-visualization-with-r.html#excel-spreadsheets" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Data from Excel workbooks can be imported using the <code>readxl</code> program. The formats <code>xls</code> and <code>xlsx</code> are both supported.</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="data-visualization-with-r.html#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl) <span class="co"># excel</span></span>
<span id="cb239-2"><a href="data-visualization-with-r.html#cb239-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Excel</span></span>
<span id="cb239-3"><a href="data-visualization-with-r.html#cb239-3" aria-hidden="true" tabindex="-1"></a>mpg_excel <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;data/mpg.xlsx&quot;</span>, <span class="at">sheet=</span><span class="st">&#39;mpg&#39;</span>)</span>
<span id="cb239-4"><a href="data-visualization-with-r.html#cb239-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mpg_excel)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 12
##    ...1 manufacturer model displ  year   cyl trans drv     cty   hwy fl    class
##   &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
## 1     1 audi         a4    1,8    1999     4 auto… f        18    29 p     comp…
## 2     2 audi         a4    1,8    1999     4 manu… f        21    29 p     comp…
## 3     3 audi         a4    2,0    2008     4 manu… f        20    31 p     comp…
## 4     4 audi         a4    2,0    2008     4 auto… f        21    30 p     comp…
## 5     5 audi         a4    2,8    1999     6 auto… f        16    26 p     comp…
## 6     6 audi         a4    2,8    1999     6 manu… f        18    26 p     comp…</code></pre>
</div>
<div id="reading-from-statistical-packages" class="section level4 hasAnchor" number="4.1.1.3">
<h4><span class="header-section-number">4.1.1.3</span> Reading from Statistical packages<a href="data-visualization-with-r.html#reading-from-statistical-packages" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <code>haven</code> package contains functions for importing data from many statistical programs such as SAS, SPSS and Stata.</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="data-visualization-with-r.html#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven) <span class="co"># excel</span></span>
<span id="cb241-2"><a href="data-visualization-with-r.html#cb241-2" aria-hidden="true" tabindex="-1"></a><span class="co"># SAS</span></span>
<span id="cb241-3"><a href="data-visualization-with-r.html#cb241-3" aria-hidden="true" tabindex="-1"></a>mtcars_sas <span class="ot">&lt;-</span> <span class="fu">read_sas</span>(<span class="st">&quot;data/mtcars.sas7bdat&quot;</span>)</span>
<span id="cb241-4"><a href="data-visualization-with-r.html#cb241-4" aria-hidden="true" tabindex="-1"></a><span class="co"># SPSS</span></span>
<span id="cb241-5"><a href="data-visualization-with-r.html#cb241-5" aria-hidden="true" tabindex="-1"></a>mtcars_spss <span class="ot">&lt;-</span> <span class="fu">read_sav</span>(<span class="st">&quot;data/mtcars.sav&quot;</span>)</span>
<span id="cb241-6"><a href="data-visualization-with-r.html#cb241-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Stata</span></span>
<span id="cb241-7"><a href="data-visualization-with-r.html#cb241-7" aria-hidden="true" tabindex="-1"></a>mtcars_stata <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="st">&quot;data/mtcars.dta&quot;</span>)</span>
<span id="cb241-8"><a href="data-visualization-with-r.html#cb241-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mtcars_spss)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 11
##     mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1  21       6   160   110  3.9   2.62  16.5     0     1     4     4
## 2  21       6   160   110  3.9   2.88  17.0     0     1     4     4
## 3  22.8     4   108    93  3.85  2.32  18.6     1     1     4     1
## 4  21.4     6   258   110  3.08  3.22  19.4     1     0     3     1
## 5  18.7     8   360   175  3.15  3.44  17.0     0     0     3     2
## 6  18.1     6   225   105  2.76  3.46  20.2     1     0     3     1</code></pre>
</div>
</div>
</div>
<div id="exploratory-data-analysis" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Exploratory data analysis<a href="data-visualization-with-r.html#exploratory-data-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In his 1977 book “Exploratory Data Analysis,” statistician John Tukey popularized exploratory data analysis (EDA). The overall goal of EDA is to assist us in formulating and refining hypotheses that will lead to useful analyses or additional data collecting. EDA’s main goals are as follows:</p>
<ul>
<li>to suggest hypotheses about the causes of observed phenomena,</li>
<li>to guide the selection of appropriate statistical tools and techniques,</li>
<li>to assess the assumptions on which statistical analysis will be based,</li>
<li>to provide a foundation for further data collection.</li>
</ul>
<p>EDA employs a combination of numerical and visual analytic techniques. Statistical approaches are occasionally used to enhance EDA, although their primary goal is to aid comprehension before moving on to formal statistical modeling.</p>
<div id="statistical-variables-and-data" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Statistical variables and data<a href="data-visualization-with-r.html#statistical-variables-and-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Statistical variables can be described in a variety of ways depending on how they might be analyzed, quantified, or presented. While it may not be the most fascinating topic, knowing what kind of variables we’re dealing with is critical since it defines how we should visualize the data and, later, how we might analyze it statistically. Statisticians have given considerable effort to how variables should be classified. Although the distinctions can be subtle, we’ll only look at two simple classification approaches.</p>
<div id="numeric-vs.-categorical-variables" class="section level4 hasAnchor" number="4.2.1.1">
<h4><span class="header-section-number">4.2.1.1</span> Numeric vs. categorical variables<a href="data-visualization-with-r.html#numeric-vs.-categorical-variables" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The values of <strong>numeric variables</strong> are numbers that describe a measurable amount, such as ‘how many’ or ‘how much.’ Quantitative variables are also known as numeric variables, and the data obtained with numeric variables is referred to as quantitative data. Numeric variables can also be classified as continuous or discrete:</p>
<ul>
<li><strong>Continuous numeric variable</strong>: Observations can take any value between a certain set of real numbers, i.e. numbers represented with decimals. This set is typically either “every possible number”.</li>
<li>Discrete numeric variable: Observations can take a value based on a count from a set of whole values; e.g. 1, 2, 3, 4, 5, and so on. A discrete variable cannot take the value of a fraction between one value and the next closest value.</li>
</ul>
<p><strong>Categorical variables</strong> have values that describe a data unit’s characteristic, such as ‘what type’ or ‘which category.’ Mutually exclusive (in one category or another) and exhaustive (containing all conceivable alternatives) categories exist for categorical variables. As a result, categorical variables are qualitative variables with a non-numeric representation. The information gathered for a category variable is qualitative. Ordinal and nominal variables are two types of categorical variables:</p>
<ul>
<li><strong>Ordinal variable</strong>: Observations can take a value that can be logically ordered or ranked. The categories associated with ordinal variables can be ranked higher or lower than another, but do not necessarily establish a numeric difference between each category.</li>
<li><strong>Nominal variable</strong>: Observations can take a value that is not able to be organised in a logical sequence. Examples of nominal categorical variables include sex, business type, eye colour, religion and brand.</li>
</ul>
</div>
</div>
<div id="understanding-numerical-variables" class="section level3 hasAnchor" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Understanding numerical variables<a href="data-visualization-with-r.html#understanding-numerical-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To explain the key concepts, we’ll use <code>wind</code> and <code>pressure</code> variables using the storms data from the <code>nasaweather</code> package (remember to load and attach the package), we’ll review some basic descriptive statistics and visualisations that are appropriate for numeric variables.</p>
<p>Atmospheric pressure and wind speed are also numerical variables. We have a little more to say. Because zero truly is zero, they are both numeric variables that are measured on a ratio scale: it makes sense to state that 20 mph is twice as fast as 10 mph, and 1000 mbar exerts twice as much pressure on objects as 500 mbar. Are these variables continuous or discrete? Consider the range of possibilities for wind speed and air pressure. Wind speeds of 40.52 mph and atmospheric pressure of 1000.23 mbar are both completely realistic numbers, therefore these are basically continuous variables.</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="data-visualization-with-r.html#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="co"># first 100 values of atmospheric pressure</span></span>
<span id="cb243-2"><a href="data-visualization-with-r.html#cb243-2" aria-hidden="true" tabindex="-1"></a>storms<span class="sc">$</span>pressure[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>]</span></code></pre></div>
<pre><code>##   [1] 1013 1013 1013 1013 1012 1012 1011 1006 1004 1002 1000  998  998  998  987
##  [16]  987  984  984  984  984  984  984  981  986  986  986  986  986  986  986
##  [31] 1011 1011 1010 1010 1011 1011 1011 1011 1012 1012 1013 1013 1014 1014 1014
##  [46] 1014 1013 1010 1007 1003  999  994  990  990  989  987  973  963  963  993
##  [61] 1000 1002 1002 1005 1000  997  997  997  997  990  990  990  990  984  984
##  [76]  984  984  970  965  965  965  965  965  965  970  995 1012 1012 1009 1005
##  [91] 1000  993  985  972  962  959  958  957  959  963</code></pre>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="data-visualization-with-r.html#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="co"># first 100 values of atmospheric pressure</span></span>
<span id="cb245-2"><a href="data-visualization-with-r.html#cb245-2" aria-hidden="true" tabindex="-1"></a>storms<span class="sc">$</span>wind[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>]</span></code></pre></div>
<pre><code>##   [1]  25  25  25  25  25  25  25  30  35  40  45  50  50  55  60  60  60  60
##  [19]  60  60  60  60  60  60  55  55  55  50  50  50  25  25  25  25  25  25
##  [37]  25  25  25  25  25  25  25  25  25  25  25  25  30  35  40  50  65  65
##  [55]  65  70 100 100  90  55  30  20  20  45  50  55  55  55  55  65  65  70
##  [73]  70  75  75  75  75  90  95  95  95  95  95  95  90  60  25  25  30  40
##  [91]  45  55  70  80  90  95 100 105 105  95</code></pre>
<p>Notice that even though pressure is continuous variables it looks like a discrete variable because it has only been measured to the nearest whole millibar. Similarly, wind is only measured to the nearest 5 mph. These differences reflect the limitations of the methodology used to measure each variable, e.g. measuring wind speed is hard because it varies so much in space and time.</p>
<p>We set the properties of the geom_histogram to tweak this kind of thing—the binwidth argument adjusts the width of the bins used. Let’s construct the histogram again with 7 mbar wide bins, as well as adjust the colour scheme and axis labels a bit:</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="data-visualization-with-r.html#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nasaweather)</span>
<span id="cb247-2"><a href="data-visualization-with-r.html#cb247-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(storms, <span class="fu">aes</span>(<span class="at">x =</span> pressure)) <span class="sc">+</span> </span>
<span id="cb247-3"><a href="data-visualization-with-r.html#cb247-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">7</span>, <span class="at">fill =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="at">colour=</span><span class="st">&quot;darkgrey&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb247-4"><a href="data-visualization-with-r.html#cb247-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Atmospheric Pressure (mbar)&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Count&quot;</span>)</span></code></pre></div>
<p><img src="Rmanual_files/figure-html/stom1_hist-1.png" width="672" /></p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="data-visualization-with-r.html#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(storms, <span class="fu">aes</span>(<span class="at">x =</span> wind)) <span class="sc">+</span> </span>
<span id="cb248-2"><a href="data-visualization-with-r.html#cb248-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">10</span>, <span class="at">fill =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="at">colour=</span><span class="st">&quot;darkgrey&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb248-3"><a href="data-visualization-with-r.html#cb248-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Wind Speed (mph)&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Count&quot;</span>)</span></code></pre></div>
<p><img src="Rmanual_files/figure-html/stom1_hist2-1.png" width="672" /></p>
<p>The only things that changed in this example were the aesthetic mapping and the bin width, which we set to 10. It reveals that the wind speed during a storm tends to be about 40 mph, though the range of wind speeds is about 100 mph and the shape of the distribution is asymmetric.</p>
<p>We have to choose the bin widths carefully. Remember that wind speed is measured to the nearest 5 mph. This means we should choose a bin width that is a multiple of 5 to produce a meaningful histogram. Look what happens if we set the bin width to 3:</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="data-visualization-with-r.html#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(storms, <span class="fu">aes</span>(<span class="at">x =</span> wind)) <span class="sc">+</span> </span>
<span id="cb249-2"><a href="data-visualization-with-r.html#cb249-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">fill =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="at">colour=</span><span class="st">&quot;darkgrey&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb249-3"><a href="data-visualization-with-r.html#cb249-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Wind Speed (mph)&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Count&quot;</span>)</span></code></pre></div>
<p><img src="Rmanual_files/figure-html/stom1_hist3-1.png" width="672" /></p>
<p>We end up with gaps in the histogram because some intervals do not include multiples of 5. This is not a good histogram because it fails to reliably summarise the distribution. Similar problems would occur if we chose a bin width that is greater than, but not a multiple of 5, because different bins would cover a different number of values that make up the wind variable. The take home message is that we have to know our data in order to produce meaningful summaries of it.</p>
<p>Histograms are good for visualising sample distributions when we have a reasonable sample size (at least dozens, and ideally, hundreds of observations). They aren’t very effective when the sample is quite small. In this ‘small data’ situation it’s better to use something called a dot plot</p>
<p>Let’s use dplyr to extract a small(ish) subset of the storms data:</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="data-visualization-with-r.html#cb250-1" aria-hidden="true" tabindex="-1"></a>storms_small <span class="ot">&lt;-</span> </span>
<span id="cb250-2"><a href="data-visualization-with-r.html#cb250-2" aria-hidden="true" tabindex="-1"></a>  storms <span class="sc">%&gt;%</span> </span>
<span id="cb250-3"><a href="data-visualization-with-r.html#cb250-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">1998</span>, type <span class="sc">==</span> <span class="st">&quot;Hurricane&quot;</span>)</span></code></pre></div>
<p>This just extracts the subset of hurricane observations from 1998. The ggplot2 code to make a dot plot with these data is very similar to the histogram case:</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="data-visualization-with-r.html#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(storms_small, <span class="fu">aes</span>(<span class="at">x =</span> pressure,<span class="at">fill=</span><span class="st">&#39;red&#39;</span>)) <span class="sc">+</span> </span>
<span id="cb251-2"><a href="data-visualization-with-r.html#cb251-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(<span class="at">binwidth =</span> <span class="dv">2</span>, <span class="at">color=</span><span class="st">&#39;blue&#39;</span>) <span class="sc">+</span> </span>
<span id="cb251-3"><a href="data-visualization-with-r.html#cb251-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Atmospheric Pressure (mbar)&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Count&quot;</span>)</span></code></pre></div>
<p><img src="Rmanual_files/figure-html/unnamed-chunk-53-1.png" width="672" />
Here, each observation in the data adds one dot, and dots that fall into the same bin are stacked up on top of one another. The resulting plot displays the same information about a sample distribution as a histogram, but it tends to be more informative when there are relatively few observations.</p>
</div>
<div id="understanding-categorical-variables" class="section level3 hasAnchor" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> Understanding categorical variables<a href="data-visualization-with-r.html#understanding-categorical-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Exploring categorical variables is generally simpler than working with numeric variables because we have fewer options, or at least life is simpler if we only require basic summaries. We’ll work with the year and type variables in storms to illustrate the key ideas.</p>
<p>Which kind of categorical variable is <code>type?</code> There are four storm categories in type. We can use the unique function to print these for us:</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="data-visualization-with-r.html#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(storms<span class="sc">$</span>type)</span></code></pre></div>
<pre><code>## [1] &quot;Tropical Depression&quot; &quot;Tropical Storm&quot;      &quot;Hurricane&quot;          
## [4] &quot;Extratropical&quot;</code></pre>
<p>When we calculate summaries of categorical variables we are aiming to describe the sample distribution of the variable, just as with numeric variables. The general question we need to address is, ‘what are the relative frequencies of different categories?’ We need to understand which categories are common and which are rare. Since a categorical variable takes a finite number of possible values, the simplest thing to do is tabulate the number of occurrences of each type. We’ve seen how the <code>table</code> function is used to do this:</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="data-visualization-with-r.html#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(storms<span class="sc">$</span>type)</span></code></pre></div>
<pre><code>## 
##       Extratropical           Hurricane Tropical Depression      Tropical Storm 
##                 412                 896                 513                 926</code></pre>
<p>This shows that the number of observations associated with hurricanes and tropical storms are about equal, that the number of observations associated with extratropical and tropical systems is similar, and the former pair of categories are more common than the latter. This indicates that in general, storm systems in Central America spend relatively more time in the more severe classes.</p>
<p>Raw frequencies give us information about the rates of occurance of different categories in a dataset. However, it’s difficult to compare raw counts across different data sets if the sample sizes vary (which they usually do). This is why we often convert counts to proportions. To do this, we have to divide each count by the total count across all categories. This is easy to do in R because it’s vectorised:</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="data-visualization-with-r.html#cb256-1" aria-hidden="true" tabindex="-1"></a>type_counts <span class="ot">&lt;-</span> <span class="fu">table</span>(storms<span class="sc">$</span>type)</span>
<span id="cb256-2"><a href="data-visualization-with-r.html#cb256-2" aria-hidden="true" tabindex="-1"></a>type_counts <span class="sc">/</span> <span class="fu">sum</span>(type_counts)</span></code></pre></div>
<pre><code>## 
##       Extratropical           Hurricane Tropical Depression      Tropical Storm 
##           0.1499818           0.3261740           0.1867492           0.3370950</code></pre>
<p>So about 2/3 of observations are associated with hurricanes and tropical storms, with a roughly equal split, and the remaining 1/3 associated with less severe storms.</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="data-visualization-with-r.html#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(storms, <span class="fu">aes</span>(<span class="at">x =</span> type,<span class="at">fill=</span>type)) <span class="sc">+</span> </span>
<span id="cb258-2"><a href="data-visualization-with-r.html#cb258-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">color =</span> <span class="st">&quot;orange&quot;</span>, <span class="at">width =</span> <span class="fl">0.7</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span> </span>
<span id="cb258-3"><a href="data-visualization-with-r.html#cb258-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Storm Type&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Number of Observations&quot;</span>)</span></code></pre></div>
<p><img src="Rmanual_files/figure-html/unnamed-chunk-56-1.png" width="672" /></p>
<p>This is the same summary information we produced using the table function, only now it’s presented in graphical form. We can customized the bar graph with functions like <code>xlab</code> and <code>ylab</code>, and by setting various properties inside <code>geom_bar</code>.</p>
<p>The categories of type have quite long names, meaning the axis labels are all bunched together. One way to fix this is to make the labels smaller or rotate them via the ‘themes’ system. Here’s an alternative solution: just flip the x and y axes to make a horizontal bar chart. We can do this with the coord_flip function (this is new):</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="data-visualization-with-r.html#cb259-1" aria-hidden="true" tabindex="-1"></a>ords <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Tropical Depression&quot;</span>, <span class="st">&quot;Extratropical&quot;</span>, <span class="st">&quot;Tropical Storm&quot;</span>, <span class="st">&quot;Hurricane&quot;</span>)</span>
<span id="cb259-2"><a href="data-visualization-with-r.html#cb259-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(storms, <span class="fu">aes</span>(<span class="at">x =</span> type,<span class="at">fill=</span>type)) <span class="sc">+</span> </span>
<span id="cb259-3"><a href="data-visualization-with-r.html#cb259-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">color =</span> <span class="st">&quot;orange&quot;</span>, <span class="at">width =</span> <span class="fl">0.7</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span> </span>
<span id="cb259-4"><a href="data-visualization-with-r.html#cb259-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> ords) <span class="sc">+</span></span>
<span id="cb259-5"><a href="data-visualization-with-r.html#cb259-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb259-6"><a href="data-visualization-with-r.html#cb259-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Storm Type&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Number of Observations&quot;</span>)</span></code></pre></div>
<p><img src="Rmanual_files/figure-html/unnamed-chunk-57-1.png" width="672" /></p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="data-visualization-with-r.html#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>storms, <span class="fu">aes</span>(<span class="at">x=</span>type,<span class="at">fill=</span>type))<span class="sc">+</span></span>
<span id="cb260-2"><a href="data-visualization-with-r.html#cb260-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">color=</span><span class="st">&#39;orange&#39;</span>,<span class="at">width =</span> <span class="fl">0.7</span>,<span class="at">show.legend =</span> F)<span class="sc">+</span></span>
<span id="cb260-3"><a href="data-visualization-with-r.html#cb260-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>()<span class="sc">+</span></span>
<span id="cb260-4"><a href="data-visualization-with-r.html#cb260-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="cn">NULL</span>, <span class="at">y=</span> <span class="cn">NULL</span>)</span></code></pre></div>
<p><img src="Rmanual_files/figure-html/polar-1.png" width="672" /></p>
</div>
<div id="scatter-plot" class="section level3 hasAnchor" number="4.2.4">
<h3><span class="header-section-number">4.2.4</span> Scatter plot<a href="data-visualization-with-r.html#scatter-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The first function in building a graph is the ggplot function. It specifies the</p>
<ul>
<li>data frame containing the data to be plotted</li>
<li>the mapping of the variables to visual properties of the graph. The mappings are placed within the <code>aes</code> function (where <code>aes</code> stands for aesthetics).</li>
</ul>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="data-visualization-with-r.html#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb261-2"><a href="data-visualization-with-r.html#cb261-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb261-3"><a href="data-visualization-with-r.html#cb261-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr) </span>
<span id="cb261-4"><a href="data-visualization-with-r.html#cb261-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-5"><a href="data-visualization-with-r.html#cb261-5" aria-hidden="true" tabindex="-1"></a><span class="co"># df</span></span>
<span id="cb261-6"><a href="data-visualization-with-r.html#cb261-6" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/mpg.csv&quot;</span>) </span>
<span id="cb261-7"><a href="data-visualization-with-r.html#cb261-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df) <span class="sc">+</span>  </span>
<span id="cb261-8"><a href="data-visualization-with-r.html#cb261-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy))</span></code></pre></div>
<p><img src="Rmanual_files/figure-html/unnamed-chunk-58-1.png" width="672" /></p>
<p>The graph demonstrates that engine size <code>(displ)</code> and fuel efficiency have a negative relationship <code>(hwy)</code>. To put it another way, cars with large engines consume more fuel. Does this support or disprove your hypothesis concerning engine size and fuel efficiency?</p>
<p>The function <code>ggplot2</code> is used to start a plot in <code>ggplot2()</code>. <code>ggplot()</code> builds a coordinate system to which layers can be added. The dataset to utilize in the graph is the first parameter to <code>ggplot()</code>. So <code>ggplot(data = mpg_csv)</code> produces an empty graph, which I won’t show here because it’s not that interesting.</p>
<p>By matching the aesthetics of your plot to the variables in your dataset, you may convey information about your data. You can, for example, link the colors of your points to the class variable to reveal each car’s class.</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="data-visualization-with-r.html#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb262-2"><a href="data-visualization-with-r.html#cb262-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb262-3"><a href="data-visualization-with-r.html#cb262-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr) <span class="co"># read dataset from file</span></span>
<span id="cb262-4"><a href="data-visualization-with-r.html#cb262-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-5"><a href="data-visualization-with-r.html#cb262-5" aria-hidden="true" tabindex="-1"></a><span class="co"># df</span></span>
<span id="cb262-6"><a href="data-visualization-with-r.html#cb262-6" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/mpg.csv&quot;</span>) </span>
<span id="cb262-7"><a href="data-visualization-with-r.html#cb262-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df) <span class="sc">+</span> </span>
<span id="cb262-8"><a href="data-visualization-with-r.html#cb262-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color=</span>class))</span></code></pre></div>
<p><img src="Rmanual_files/figure-html/color_class-1.png" width="672" /></p>
<p>You can also set the aesthetic properties of your geom manually. For example, we can make all of the points in our plot blue:</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="data-visualization-with-r.html#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb263-2"><a href="data-visualization-with-r.html#cb263-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb263-3"><a href="data-visualization-with-r.html#cb263-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr) <span class="co"># read dataset from file</span></span>
<span id="cb263-4"><a href="data-visualization-with-r.html#cb263-4" aria-hidden="true" tabindex="-1"></a><span class="co"># df</span></span>
<span id="cb263-5"><a href="data-visualization-with-r.html#cb263-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/mpg.csv&quot;</span>) </span>
<span id="cb263-6"><a href="data-visualization-with-r.html#cb263-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df) <span class="sc">+</span> </span>
<span id="cb263-7"><a href="data-visualization-with-r.html#cb263-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy), <span class="at">color=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="Rmanual_files/figure-html/color_blue-1.png" width="672" /></p>
<p>The color modifies the appearance of the plot rather than conveying information about a variable. Set the aesthetic by name as an argument of your geom function to manually set an aesthetic; i.e. it goes outside of <code>aes()</code>. You’ll need to choose a level that fits that aesthetic:</p>
<ul>
<li>The name of a color as a character string.</li>
<li>The size of a point in mm.</li>
<li>The shape of a point as a number</li>
</ul>
<p><strong><em>Facets in ggplot2:</em></strong></p>
<p>Splitting your plot into facets, or subplots that each display one subset of the data, is another option, especially for categorical variables. Use <code>facet_wrap()</code> to facet your plot by a single variable. <code>facet_wrap()</code> expects a formula as the first input, followed by a variable name (note that “formula” is the name of a data structure in R, not a synonym for “equation”). <code>facet_wrap()</code> expects a discrete variable as a parameter.</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="data-visualization-with-r.html#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb264-2"><a href="data-visualization-with-r.html#cb264-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb264-3"><a href="data-visualization-with-r.html#cb264-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr) </span>
<span id="cb264-4"><a href="data-visualization-with-r.html#cb264-4" aria-hidden="true" tabindex="-1"></a><span class="co"># df</span></span>
<span id="cb264-5"><a href="data-visualization-with-r.html#cb264-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/mpg.csv&quot;</span>) </span>
<span id="cb264-6"><a href="data-visualization-with-r.html#cb264-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df) <span class="sc">+</span> </span>
<span id="cb264-7"><a href="data-visualization-with-r.html#cb264-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color=</span>class))<span class="sc">+</span></span>
<span id="cb264-8"><a href="data-visualization-with-r.html#cb264-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> manufacturer, <span class="at">nrow =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="Rmanual_files/figure-html/facet_wrap-1.png" width="672" /></p>
<p>Add <code>facet_grid()</code> to your plot call to facet your plot on the combination of two variables. Facet grid(first )’s parameter is likewise a formula. The formula should now have two variable names separated by a comma.</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="data-visualization-with-r.html#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb265-2"><a href="data-visualization-with-r.html#cb265-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb265-3"><a href="data-visualization-with-r.html#cb265-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr) <span class="co"># read dataset from file</span></span>
<span id="cb265-4"><a href="data-visualization-with-r.html#cb265-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb265-5"><a href="data-visualization-with-r.html#cb265-5" aria-hidden="true" tabindex="-1"></a><span class="co"># df</span></span>
<span id="cb265-6"><a href="data-visualization-with-r.html#cb265-6" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/mpg.csv&quot;</span>) </span>
<span id="cb265-7"><a href="data-visualization-with-r.html#cb265-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df) <span class="sc">+</span>  </span>
<span id="cb265-8"><a href="data-visualization-with-r.html#cb265-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color=</span>class))<span class="sc">+</span></span>
<span id="cb265-9"><a href="data-visualization-with-r.html#cb265-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>( drv <span class="sc">~</span> cyl)</span></code></pre></div>
<p><img src="Rmanual_files/figure-html/facet_grid-1.png" width="672" /></p>
<p>Note: Use a <code>.</code> instead of a variable name if you don’t want to facet in the rows or columns dimension, e.g. <code>+ facet grid(.  ~ cyl)</code>.</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="data-visualization-with-r.html#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb266-2"><a href="data-visualization-with-r.html#cb266-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb266-3"><a href="data-visualization-with-r.html#cb266-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr) <span class="co"># read dataset from file</span></span>
<span id="cb266-4"><a href="data-visualization-with-r.html#cb266-4" aria-hidden="true" tabindex="-1"></a><span class="co"># df</span></span>
<span id="cb266-5"><a href="data-visualization-with-r.html#cb266-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/mpg.csv&quot;</span>) </span>
<span id="cb266-6"><a href="data-visualization-with-r.html#cb266-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df) <span class="sc">+</span> </span>
<span id="cb266-7"><a href="data-visualization-with-r.html#cb266-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color=</span>class))<span class="sc">+</span></span>
<span id="cb266-8"><a href="data-visualization-with-r.html#cb266-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> cyl)</span></code></pre></div>
<p><img src="Rmanual_files/figure-html/facet_grid2-1.png" width="672" />
<strong>Geometric objects:</strong>_</p>
<p>A geom is a geometrical object used to represent data in a plot. Plots are frequently described by the sort of geom they employ. Bar charts, for example, use bar geoms, line charts use <code>line geoms</code>, and boxplots use <code>boxplot geoms</code>. <em>Scatterplots</em> use the <code>point geom</code> to break the trend. As we’ve seen, different __geoms_ can be used to plot the same data. The point geom is used for scatter plot, and the smooth geom, a smooth line suited to the data.To display multiple geoms in the same plot, add multiple geom functions to <code>ggplot()</code> as shown blow:</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="data-visualization-with-r.html#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb267-2"><a href="data-visualization-with-r.html#cb267-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr) <span class="co"># read dataset from file</span></span>
<span id="cb267-3"><a href="data-visualization-with-r.html#cb267-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb267-4"><a href="data-visualization-with-r.html#cb267-4" aria-hidden="true" tabindex="-1"></a><span class="co"># df</span></span>
<span id="cb267-5"><a href="data-visualization-with-r.html#cb267-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/mpg.csv&quot;</span>) </span>
<span id="cb267-6"><a href="data-visualization-with-r.html#cb267-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-7"><a href="data-visualization-with-r.html#cb267-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb267-8"><a href="data-visualization-with-r.html#cb267-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb267-9"><a href="data-visualization-with-r.html#cb267-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()<span class="sc">+</span></span>
<span id="cb267-10"><a href="data-visualization-with-r.html#cb267-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Relationship between displacment and highway of 38 different car models&quot;</span>,</span>
<span id="cb267-11"><a href="data-visualization-with-r.html#cb267-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Feul economy data from 1999 to 2008&quot;</span>,</span>
<span id="cb267-12"><a href="data-visualization-with-r.html#cb267-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;source: https://fueleconomy.gov/&quot;</span>,</span>
<span id="cb267-13"><a href="data-visualization-with-r.html#cb267-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Engine displacement in liters&quot;</span>,</span>
<span id="cb267-14"><a href="data-visualization-with-r.html#cb267-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Highway mileage&quot;</span>,</span>
<span id="cb267-15"><a href="data-visualization-with-r.html#cb267-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;vehicle class&quot;</span>)<span class="sc">+</span></span>
<span id="cb267-16"><a href="data-visualization-with-r.html#cb267-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubr</span>()<span class="sc">+</span></span>
<span id="cb267-17"><a href="data-visualization-with-r.html#cb267-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grids</span>(<span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span></span>
<span id="cb267-18"><a href="data-visualization-with-r.html#cb267-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;grey20&quot;</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb267-19"><a href="data-visualization-with-r.html#cb267-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;grey20&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb267-20"><a href="data-visualization-with-r.html#cb267-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;italic&quot;</span>),</span>
<span id="cb267-21"><a href="data-visualization-with-r.html#cb267-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code></pre></div>
<p><img src="Rmanual_files/figure-html/geom_smooth-1.png" width="672" /></p>
<p><strong>Exercise</strong></p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="data-visualization-with-r.html#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add facet wrap using manufacturer variable</span></span>
<span id="cb268-2"><a href="data-visualization-with-r.html#cb268-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb268-3"><a href="data-visualization-with-r.html#cb268-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb268-4"><a href="data-visualization-with-r.html#cb268-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr) <span class="co"># read dataset from file</span></span>
<span id="cb268-5"><a href="data-visualization-with-r.html#cb268-5" aria-hidden="true" tabindex="-1"></a><span class="co"># df</span></span>
<span id="cb268-6"><a href="data-visualization-with-r.html#cb268-6" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/mpg.csv&quot;</span>) </span>
<span id="cb268-7"><a href="data-visualization-with-r.html#cb268-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-8"><a href="data-visualization-with-r.html#cb268-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb268-9"><a href="data-visualization-with-r.html#cb268-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb268-10"><a href="data-visualization-with-r.html#cb268-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;loess&#39;</span>)<span class="sc">+</span></span>
<span id="cb268-11"><a href="data-visualization-with-r.html#cb268-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Relationship between displacment and highway of 38 different car models&quot;</span>,</span>
<span id="cb268-12"><a href="data-visualization-with-r.html#cb268-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Feul economy data from 1999 to 2008&quot;</span>,</span>
<span id="cb268-13"><a href="data-visualization-with-r.html#cb268-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;source: https://fueleconomy.gov/&quot;</span>,</span>
<span id="cb268-14"><a href="data-visualization-with-r.html#cb268-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">&quot;Engine displacement in liters&quot;</span>,</span>
<span id="cb268-15"><a href="data-visualization-with-r.html#cb268-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Highway mileage&quot;</span>,</span>
<span id="cb268-16"><a href="data-visualization-with-r.html#cb268-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;vehicle class&quot;</span>)<span class="sc">+</span></span>
<span id="cb268-17"><a href="data-visualization-with-r.html#cb268-17" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme_pubr</span>()<span class="sc">+</span></span>
<span id="cb268-18"><a href="data-visualization-with-r.html#cb268-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grids</span>(<span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span></span>
<span id="cb268-19"><a href="data-visualization-with-r.html#cb268-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;grey20&quot;</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb268-20"><a href="data-visualization-with-r.html#cb268-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;grey20&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb268-21"><a href="data-visualization-with-r.html#cb268-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;italic&quot;</span>),</span>
<span id="cb268-22"><a href="data-visualization-with-r.html#cb268-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code></pre></div>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="data-visualization-with-r.html#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb269-2"><a href="data-visualization-with-r.html#cb269-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb269-3"><a href="data-visualization-with-r.html#cb269-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr) <span class="co"># read dataset from file</span></span>
<span id="cb269-4"><a href="data-visualization-with-r.html#cb269-4" aria-hidden="true" tabindex="-1"></a><span class="co"># df</span></span>
<span id="cb269-5"><a href="data-visualization-with-r.html#cb269-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/mpg.csv&quot;</span>) </span>
<span id="cb269-6"><a href="data-visualization-with-r.html#cb269-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-7"><a href="data-visualization-with-r.html#cb269-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb269-8"><a href="data-visualization-with-r.html#cb269-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb269-9"><a href="data-visualization-with-r.html#cb269-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;loess&#39;</span>)<span class="sc">+</span></span>
<span id="cb269-10"><a href="data-visualization-with-r.html#cb269-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>manufacturer)<span class="sc">+</span></span>
<span id="cb269-11"><a href="data-visualization-with-r.html#cb269-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Relationship between displacment and highway of 38 different car models&quot;</span>,</span>
<span id="cb269-12"><a href="data-visualization-with-r.html#cb269-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Feul economy data from 1999 to 2008&quot;</span>,</span>
<span id="cb269-13"><a href="data-visualization-with-r.html#cb269-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;source: https://fueleconomy.gov/&quot;</span>,</span>
<span id="cb269-14"><a href="data-visualization-with-r.html#cb269-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">&quot;Engine displacement in liters&quot;</span>,</span>
<span id="cb269-15"><a href="data-visualization-with-r.html#cb269-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Highway mileage&quot;</span>,</span>
<span id="cb269-16"><a href="data-visualization-with-r.html#cb269-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;vehicle class&quot;</span>)<span class="sc">+</span></span>
<span id="cb269-17"><a href="data-visualization-with-r.html#cb269-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubr</span>()<span class="sc">+</span></span>
<span id="cb269-18"><a href="data-visualization-with-r.html#cb269-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grids</span>(<span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span></span>
<span id="cb269-19"><a href="data-visualization-with-r.html#cb269-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;grey20&quot;</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb269-20"><a href="data-visualization-with-r.html#cb269-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;grey20&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb269-21"><a href="data-visualization-with-r.html#cb269-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;italic&quot;</span>),</span>
<span id="cb269-22"><a href="data-visualization-with-r.html#cb269-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code></pre></div>
</div>
<div id="bar-plot" class="section level3 hasAnchor" number="4.2.5">
<h3><span class="header-section-number">4.2.5</span> Bar Plot<a href="data-visualization-with-r.html#bar-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Stacked, clustered, or segmented bar charts are commonly used to show the relationship between two categorical variables.</p>
<div id="stacked-bar-chart" class="section level4 hasAnchor" number="4.2.5.1">
<h4><span class="header-section-number">4.2.5.1</span> Stacked bar chart<a href="data-visualization-with-r.html#stacked-bar-chart" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For the autos in the Fuel economy dataset, plot the association between automotive class and drive type (front-wheel, rear-wheel, or 4-wheel drive).</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="data-visualization-with-r.html#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb270-2"><a href="data-visualization-with-r.html#cb270-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb270-3"><a href="data-visualization-with-r.html#cb270-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr) <span class="co"># read dataset from file</span></span>
<span id="cb270-4"><a href="data-visualization-with-r.html#cb270-4" aria-hidden="true" tabindex="-1"></a><span class="co"># df</span></span>
<span id="cb270-5"><a href="data-visualization-with-r.html#cb270-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/mpg.csv&quot;</span>) </span>
<span id="cb270-6"><a href="data-visualization-with-r.html#cb270-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-7"><a href="data-visualization-with-r.html#cb270-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> class, <span class="at">fill=</span>drv)) <span class="sc">+</span> </span>
<span id="cb270-8"><a href="data-visualization-with-r.html#cb270-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">&quot;stack&quot;</span>) <span class="sc">+</span> </span>
<span id="cb270-9"><a href="data-visualization-with-r.html#cb270-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Vehicle class frequency by drive type for 38 different automobile models&quot;</span>,</span>
<span id="cb270-10"><a href="data-visualization-with-r.html#cb270-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Feul economy data from 1999 to 2008&quot;</span>,</span>
<span id="cb270-11"><a href="data-visualization-with-r.html#cb270-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;source: https://fueleconomy.gov/&quot;</span>,</span>
<span id="cb270-12"><a href="data-visualization-with-r.html#cb270-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;vehicle class&quot;</span>,</span>
<span id="cb270-13"><a href="data-visualization-with-r.html#cb270-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Count&quot;</span>)<span class="sc">+</span></span>
<span id="cb270-14"><a href="data-visualization-with-r.html#cb270-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubclean</span>()<span class="sc">+</span></span>
<span id="cb270-15"><a href="data-visualization-with-r.html#cb270-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grids</span>(<span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span></span>
<span id="cb270-16"><a href="data-visualization-with-r.html#cb270-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span><span class="fu">guide_legend</span>(<span class="st">&quot;Drive Type&quot;</span>))<span class="sc">+</span></span>
<span id="cb270-17"><a href="data-visualization-with-r.html#cb270-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;grey20&quot;</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb270-18"><a href="data-visualization-with-r.html#cb270-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;grey20&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb270-19"><a href="data-visualization-with-r.html#cb270-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;italic&quot;</span>),</span>
<span id="cb270-20"><a href="data-visualization-with-r.html#cb270-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code></pre></div>
<p><img src="Rmanual_files/figure-html/bar_mpg1-1.png" width="672" /></p>
</div>
<div id="grouped-bar-chart" class="section level4 hasAnchor" number="4.2.5.2">
<h4><span class="header-section-number">4.2.5.2</span> Grouped bar chart<a href="data-visualization-with-r.html#grouped-bar-chart" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="data-visualization-with-r.html#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb271-2"><a href="data-visualization-with-r.html#cb271-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb271-3"><a href="data-visualization-with-r.html#cb271-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr) <span class="co"># read dataset from file</span></span>
<span id="cb271-4"><a href="data-visualization-with-r.html#cb271-4" aria-hidden="true" tabindex="-1"></a><span class="co"># df</span></span>
<span id="cb271-5"><a href="data-visualization-with-r.html#cb271-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/mpg.csv&quot;</span>) </span>
<span id="cb271-6"><a href="data-visualization-with-r.html#cb271-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-7"><a href="data-visualization-with-r.html#cb271-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> class, <span class="at">fill=</span>drv)) <span class="sc">+</span> </span>
<span id="cb271-8"><a href="data-visualization-with-r.html#cb271-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span> </span>
<span id="cb271-9"><a href="data-visualization-with-r.html#cb271-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Vehicle class frequency by drive type for 38 different automobile models&quot;</span>,</span>
<span id="cb271-10"><a href="data-visualization-with-r.html#cb271-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Feul economy data from 1999 to 2008&quot;</span>,</span>
<span id="cb271-11"><a href="data-visualization-with-r.html#cb271-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;source: https://fueleconomy.gov/&quot;</span>,</span>
<span id="cb271-12"><a href="data-visualization-with-r.html#cb271-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;vehicle class&quot;</span>,</span>
<span id="cb271-13"><a href="data-visualization-with-r.html#cb271-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Count&quot;</span>)<span class="sc">+</span></span>
<span id="cb271-14"><a href="data-visualization-with-r.html#cb271-14" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme_pubclean</span>()<span class="sc">+</span></span>
<span id="cb271-15"><a href="data-visualization-with-r.html#cb271-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grids</span>(<span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span></span>
<span id="cb271-16"><a href="data-visualization-with-r.html#cb271-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span><span class="fu">guide_legend</span>(<span class="st">&quot;Drive Type&quot;</span>))<span class="sc">+</span></span>
<span id="cb271-17"><a href="data-visualization-with-r.html#cb271-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;grey20&quot;</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb271-18"><a href="data-visualization-with-r.html#cb271-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;grey20&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb271-19"><a href="data-visualization-with-r.html#cb271-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;italic&quot;</span>),</span>
<span id="cb271-20"><a href="data-visualization-with-r.html#cb271-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code></pre></div>
<p><img src="Rmanual_files/figure-html/bar_mpg2-1.png" width="672" /></p>
<p>Notice that front-wheel drive is standard on all Minivans. Zero count bars are removed by default, and the remaining bars are made broader. This may not be the desired behavior. The <code>position = position dodge(preserve = "single")</code> option can be used to change this.</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="data-visualization-with-r.html#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb272-2"><a href="data-visualization-with-r.html#cb272-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb272-3"><a href="data-visualization-with-r.html#cb272-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr) <span class="co"># read dataset from file</span></span>
<span id="cb272-4"><a href="data-visualization-with-r.html#cb272-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb272-5"><a href="data-visualization-with-r.html#cb272-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb272-6"><a href="data-visualization-with-r.html#cb272-6" aria-hidden="true" tabindex="-1"></a><span class="co"># df</span></span>
<span id="cb272-7"><a href="data-visualization-with-r.html#cb272-7" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/mpg.csv&quot;</span>) </span>
<span id="cb272-8"><a href="data-visualization-with-r.html#cb272-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-9"><a href="data-visualization-with-r.html#cb272-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> class, <span class="at">fill=</span>drv)) <span class="sc">+</span> </span>
<span id="cb272-10"><a href="data-visualization-with-r.html#cb272-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">preserve =</span> <span class="st">&quot;single&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb272-11"><a href="data-visualization-with-r.html#cb272-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Vehicle class frequency by drive type for 38 different automobile models&quot;</span>,</span>
<span id="cb272-12"><a href="data-visualization-with-r.html#cb272-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Feul economy data from 1999 to 2008&quot;</span>,</span>
<span id="cb272-13"><a href="data-visualization-with-r.html#cb272-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;source: https://fueleconomy.gov/&quot;</span>,</span>
<span id="cb272-14"><a href="data-visualization-with-r.html#cb272-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;vehicle class&quot;</span>,</span>
<span id="cb272-15"><a href="data-visualization-with-r.html#cb272-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Count&quot;</span>,</span>
<span id="cb272-16"><a href="data-visualization-with-r.html#cb272-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill=</span><span class="st">&quot;Drive type&quot;</span>)<span class="sc">+</span></span>
<span id="cb272-17"><a href="data-visualization-with-r.html#cb272-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubclean</span>()<span class="sc">+</span></span>
<span id="cb272-18"><a href="data-visualization-with-r.html#cb272-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grids</span>(<span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span></span>
<span id="cb272-19"><a href="data-visualization-with-r.html#cb272-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;grey20&quot;</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb272-20"><a href="data-visualization-with-r.html#cb272-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;grey20&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb272-21"><a href="data-visualization-with-r.html#cb272-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;italic&quot;</span>),</span>
<span id="cb272-22"><a href="data-visualization-with-r.html#cb272-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code></pre></div>
<p><img src="Rmanual_files/figure-html/bar_mpg3-1.png" width="672" /></p>
</div>
<div id="bar-chart-with-percentages" class="section level4 hasAnchor" number="4.2.5.3">
<h4><span class="header-section-number">4.2.5.3</span> Bar chart with percentages<a href="data-visualization-with-r.html#bar-chart-with-percentages" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="data-visualization-with-r.html#cb273-1" aria-hidden="true" tabindex="-1"></a>bar_perc <span class="ot">&lt;-</span> mtcars <span class="sc">%&gt;%</span></span>
<span id="cb273-2"><a href="data-visualization-with-r.html#cb273-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(cyl) <span class="sc">%&gt;%</span></span>
<span id="cb273-3"><a href="data-visualization-with-r.html#cb273-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb273-4"><a href="data-visualization-with-r.html#cb273-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">perc =</span> <span class="fu">round</span>(<span class="fu">proportions</span>(n) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb273-5"><a href="data-visualization-with-r.html#cb273-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">res =</span> <span class="fu">str_c</span>(n, <span class="st">&quot;(&quot;</span>, perc, <span class="st">&quot;)%&quot;</span>),</span>
<span id="cb273-6"><a href="data-visualization-with-r.html#cb273-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">cyl =</span> <span class="fu">as.factor</span>(cyl)</span>
<span id="cb273-7"><a href="data-visualization-with-r.html#cb273-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb273-8"><a href="data-visualization-with-r.html#cb273-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-9"><a href="data-visualization-with-r.html#cb273-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(bar_perc, <span class="fu">aes</span>(cyl, n, <span class="at">fill =</span> cyl)) <span class="sc">+</span></span>
<span id="cb273-10"><a href="data-visualization-with-r.html#cb273-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb273-11"><a href="data-visualization-with-r.html#cb273-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> res), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="Rmanual_files/figure-html/unnamed-chunk-59-1.png" width="672" /></p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="data-visualization-with-r.html#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb274-2"><a href="data-visualization-with-r.html#cb274-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb274-3"><a href="data-visualization-with-r.html#cb274-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb274-4"><a href="data-visualization-with-r.html#cb274-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)  <span class="co"># for percentage scales</span></span>
<span id="cb274-5"><a href="data-visualization-with-r.html#cb274-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x=</span>cyl)) <span class="sc">+</span> </span>
<span id="cb274-6"><a href="data-visualization-with-r.html#cb274-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(prop), <span class="at">fill =</span> <span class="fu">factor</span>(<span class="fu">after_stat</span>(x))), <span class="at">stat=</span><span class="st">&quot;count&quot;</span>) <span class="sc">+</span></span>
<span id="cb274-7"><a href="data-visualization-with-r.html#cb274-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>( <span class="at">label =</span> scales<span class="sc">::</span><span class="fu">percent</span>(<span class="fu">after_stat</span>(prop)),</span>
<span id="cb274-8"><a href="data-visualization-with-r.html#cb274-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y=</span> <span class="fu">after_stat</span>(prop) ), </span>
<span id="cb274-9"><a href="data-visualization-with-r.html#cb274-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">stat=</span> <span class="st">&quot;count&quot;</span>, </span>
<span id="cb274-10"><a href="data-visualization-with-r.html#cb274-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">vjust =</span> <span class="sc">-</span>.<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb274-11"><a href="data-visualization-with-r.html#cb274-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Percent&quot;</span>, <span class="at">fill=</span><span class="st">&quot;cyl&quot;</span>) <span class="sc">+</span></span>
<span id="cb274-12"><a href="data-visualization-with-r.html#cb274-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent)</span></code></pre></div>
<p><img src="Rmanual_files/figure-html/unnamed-chunk-60-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="boxplots" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Boxplots<a href="data-visualization-with-r.html#boxplots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A boxplot displays the <span class="math inline">\(25^{th}\)</span> percentile, median, and <span class="math inline">\(75^{th}\)</span> percentile of a distribution. The whiskers (vertical lines) capture roughly 99% of a normal distribution, and observations outside this range are plotted as points representing outliers (see the figure below).</p>
<div class="figure">
<img src="image/boxplot.png" width="600" alt="" />
<p class="caption">Boxplot schematics</p>
</div>
<p>We can use boxplots to visualize the distribution of weight within each species:</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="data-visualization-with-r.html#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb275-2"><a href="data-visualization-with-r.html#cb275-2" aria-hidden="true" tabindex="-1"></a><span class="co">#read the visual treatment for patients dataset</span></span>
<span id="cb275-3"><a href="data-visualization-with-r.html#cb275-3" aria-hidden="true" tabindex="-1"></a>df_vt <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;./data/visual_treatment.csv&quot;</span>)</span>
<span id="cb275-4"><a href="data-visualization-with-r.html#cb275-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df_vt, </span>
<span id="cb275-5"><a href="data-visualization-with-r.html#cb275-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color=</span>Day)) <span class="sc">+</span></span>
<span id="cb275-6"><a href="data-visualization-with-r.html#cb275-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb275-7"><a href="data-visualization-with-r.html#cb275-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>)</span></code></pre></div>
<p><img src="Rmanual_files/figure-html/unnamed-chunk-61-1.png" width="672" /></p>
<ul>
<li>R appears to be unaware that the order should be <strong>One -&gt; Two -&gt; Three</strong>. Because the column Day is shown as <strong>chr&gt;</strong>, which indicates character, R chose to follow the alphabetical order.</li>
<li>When you want to display characters in a non-alphabetical order, factors are crucial. Factors are variables with a small number of possible values.</li>
<li>Individual data can sometimes be plotted on top of the boxplot. This can be accomplished in a variety of ways.</li>
<li>Using <em>geom jitter()</em>, here is a simple solution. For more information, type ?geom_jitter.</li>
</ul>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="data-visualization-with-r.html#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb276-2"><a href="data-visualization-with-r.html#cb276-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb276-3"><a href="data-visualization-with-r.html#cb276-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb276-4"><a href="data-visualization-with-r.html#cb276-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb276-5"><a href="data-visualization-with-r.html#cb276-5" aria-hidden="true" tabindex="-1"></a><span class="co">#read the visual treatment for patients dataset</span></span>
<span id="cb276-6"><a href="data-visualization-with-r.html#cb276-6" aria-hidden="true" tabindex="-1"></a>df_vt <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;./data/visual_treatment.csv&quot;</span>)</span>
<span id="cb276-7"><a href="data-visualization-with-r.html#cb276-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ordering the treatment</span></span>
<span id="cb276-8"><a href="data-visualization-with-r.html#cb276-8" aria-hidden="true" tabindex="-1"></a>df_vt<span class="sc">$</span>Day <span class="ot">&lt;-</span> <span class="fu">factor</span>(df_vt<span class="sc">$</span>Day, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;One&quot;</span>,<span class="st">&quot;Two&quot;</span>,<span class="st">&quot;Three&quot;</span>))</span>
<span id="cb276-9"><a href="data-visualization-with-r.html#cb276-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb276-10"><a href="data-visualization-with-r.html#cb276-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb276-11"><a href="data-visualization-with-r.html#cb276-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df_vt, </span>
<span id="cb276-12"><a href="data-visualization-with-r.html#cb276-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color=</span>Day)) <span class="sc">+</span></span>
<span id="cb276-13"><a href="data-visualization-with-r.html#cb276-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb276-14"><a href="data-visualization-with-r.html#cb276-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width=</span><span class="fl">0.15</span>)<span class="sc">+</span> <span class="co"># show individual data</span></span>
<span id="cb276-15"><a href="data-visualization-with-r.html#cb276-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubclean</span>()<span class="sc">+</span> <span class="co"># change theme</span></span>
<span id="cb276-16"><a href="data-visualization-with-r.html#cb276-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grids</span>(<span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span> <span class="co"># modify grids type</span></span>
<span id="cb276-17"><a href="data-visualization-with-r.html#cb276-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>)<span class="sc">+</span> <span class="co"># add title </span></span>
<span id="cb276-18"><a href="data-visualization-with-r.html#cb276-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;grey20&quot;</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb276-19"><a href="data-visualization-with-r.html#cb276-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;grey20&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb276-20"><a href="data-visualization-with-r.html#cb276-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;italic&quot;</span>),</span>
<span id="cb276-21"><a href="data-visualization-with-r.html#cb276-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code></pre></div>
<p><img src="Rmanual_files/figure-html/unnamed-chunk-62-1.png" width="672" /></p>
</div>
<div id="plotting-time-series-data" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Plotting time series data<a href="data-visualization-with-r.html#plotting-time-series-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s calculate number of counts per year for each genus. First we need to group the data and count records within each group:</p>
</div>
<div id="line-plot" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Line Plot<a href="data-visualization-with-r.html#line-plot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="data-visualization-with-r.html#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(country.map, <span class="at">package =</span> <span class="st">&quot;choroplethrMaps&quot;</span>)</span>
<span id="cb277-2"><a href="data-visualization-with-r.html#cb277-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">unique</span>(country.map<span class="sc">$</span>region), <span class="dv">30</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;afghanistan&quot; &quot;angola&quot;      &quot;azerbaijan&quot;  &quot;moldova&quot;     &quot;madagascar&quot; 
##  [6] &quot;mexico&quot;      &quot;macedonia&quot;   &quot;mali&quot;        &quot;myanmar&quot;     &quot;montenegro&quot; 
## [11] &quot;mongolia&quot;    &quot;mozambique&quot;  &quot;mauritania&quot;  &quot;burundi&quot;     &quot;malawi&quot;     
## [16] &quot;malaysia&quot;    &quot;namibia&quot;     &quot;france&quot;      &quot;niger&quot;       &quot;nigeria&quot;    
## [21] &quot;nicaragua&quot;   &quot;netherlands&quot; &quot;norway&quot;      &quot;nepal&quot;       &quot;belgium&quot;    
## [26] &quot;new zealand&quot; &quot;oman&quot;        &quot;pakistan&quot;    &quot;panama&quot;      &quot;peru&quot;</code></pre>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="data-visualization-with-r.html#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb279-2"><a href="data-visualization-with-r.html#cb279-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb279-3"><a href="data-visualization-with-r.html#cb279-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb279-4"><a href="data-visualization-with-r.html#cb279-4" aria-hidden="true" tabindex="-1"></a>gap <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/gapminder.csv&quot;</span>)</span>
<span id="cb279-5"><a href="data-visualization-with-r.html#cb279-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb279-6"><a href="data-visualization-with-r.html#cb279-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Select US cases</span></span>
<span id="cb279-7"><a href="data-visualization-with-r.html#cb279-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb279-8"><a href="data-visualization-with-r.html#cb279-8" aria-hidden="true" tabindex="-1"></a>plotdata <span class="ot">&lt;-</span> <span class="fu">filter</span>(gap, </span>
<span id="cb279-9"><a href="data-visualization-with-r.html#cb279-9" aria-hidden="true" tabindex="-1"></a>                   country <span class="sc">==</span> <span class="st">&quot;Ethiopia&quot;</span>)</span>
<span id="cb279-10"><a href="data-visualization-with-r.html#cb279-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb279-11"><a href="data-visualization-with-r.html#cb279-11" aria-hidden="true" tabindex="-1"></a><span class="co"># simple line plot</span></span>
<span id="cb279-12"><a href="data-visualization-with-r.html#cb279-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plotdata, </span>
<span id="cb279-13"><a href="data-visualization-with-r.html#cb279-13" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> year, </span>
<span id="cb279-14"><a href="data-visualization-with-r.html#cb279-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb279-15"><a href="data-visualization-with-r.html#cb279-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb279-16"><a href="data-visualization-with-r.html#cb279-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubr</span>()<span class="sc">+</span></span>
<span id="cb279-17"><a href="data-visualization-with-r.html#cb279-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grids</span>(<span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>)</span></code></pre></div>
<p><img src="Rmanual_files/figure-html/unnamed-chunk-64-1.png" width="672" /></p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="data-visualization-with-r.html#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb280-2"><a href="data-visualization-with-r.html#cb280-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb280-3"><a href="data-visualization-with-r.html#cb280-3" aria-hidden="true" tabindex="-1"></a>gap <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/gapminder.csv&quot;</span>)</span>
<span id="cb280-4"><a href="data-visualization-with-r.html#cb280-4" aria-hidden="true" tabindex="-1"></a><span class="co"># line plot with points</span></span>
<span id="cb280-5"><a href="data-visualization-with-r.html#cb280-5" aria-hidden="true" tabindex="-1"></a><span class="co"># and improved labeling</span></span>
<span id="cb280-6"><a href="data-visualization-with-r.html#cb280-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plotdata, </span>
<span id="cb280-7"><a href="data-visualization-with-r.html#cb280-7" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> year, </span>
<span id="cb280-8"><a href="data-visualization-with-r.html#cb280-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb280-9"><a href="data-visualization-with-r.html#cb280-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>, </span>
<span id="cb280-10"><a href="data-visualization-with-r.html#cb280-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;lightgrey&quot;</span>) <span class="sc">+</span></span>
<span id="cb280-11"><a href="data-visualization-with-r.html#cb280-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, </span>
<span id="cb280-12"><a href="data-visualization-with-r.html#cb280-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;steelblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb280-13"><a href="data-visualization-with-r.html#cb280-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Life Expectancy (years)&quot;</span>, </span>
<span id="cb280-14"><a href="data-visualization-with-r.html#cb280-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb280-15"><a href="data-visualization-with-r.html#cb280-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Life expectancy changes over time&quot;</span>,</span>
<span id="cb280-16"><a href="data-visualization-with-r.html#cb280-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Ethiopia (1952-2007)&quot;</span>,</span>
<span id="cb280-17"><a href="data-visualization-with-r.html#cb280-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;Source: http://www.gapminder.org/data/&quot;</span>)<span class="sc">+</span></span>
<span id="cb280-18"><a href="data-visualization-with-r.html#cb280-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubclean</span>()<span class="sc">+</span></span>
<span id="cb280-19"><a href="data-visualization-with-r.html#cb280-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grids</span>(<span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>)</span></code></pre></div>
<p><img src="Rmanual_files/figure-html/unnamed-chunk-65-1.png" width="672" /></p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="data-visualization-with-r.html#cb281-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare dataset</span></span>
<span id="cb281-2"><a href="data-visualization-with-r.html#cb281-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(gapminder, <span class="at">package =</span> <span class="st">&quot;gapminder&quot;</span>)</span>
<span id="cb281-3"><a href="data-visualization-with-r.html#cb281-3" aria-hidden="true" tabindex="-1"></a>plotdata <span class="ot">&lt;-</span> gapminder <span class="sc">%&gt;%</span></span>
<span id="cb281-4"><a href="data-visualization-with-r.html#cb281-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span></span>
<span id="cb281-5"><a href="data-visualization-with-r.html#cb281-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">region =</span> country,</span>
<span id="cb281-6"><a href="data-visualization-with-r.html#cb281-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">value =</span> lifeExp) <span class="sc">%&gt;%</span></span>
<span id="cb281-7"><a href="data-visualization-with-r.html#cb281-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">region =</span> <span class="fu">tolower</span>(region)) <span class="sc">%&gt;%</span></span>
<span id="cb281-8"><a href="data-visualization-with-r.html#cb281-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">region =</span> <span class="fu">recode</span>(region,</span>
<span id="cb281-9"><a href="data-visualization-with-r.html#cb281-9" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;united states&quot;</span>    <span class="ot">=</span> <span class="st">&quot;united states of america&quot;</span>,</span>
<span id="cb281-10"><a href="data-visualization-with-r.html#cb281-10" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;congo, dem. rep.&quot;</span> <span class="ot">=</span> <span class="st">&quot;democratic republic of the congo&quot;</span>,</span>
<span id="cb281-11"><a href="data-visualization-with-r.html#cb281-11" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;congo, rep.&quot;</span>      <span class="ot">=</span> <span class="st">&quot;republic of congo&quot;</span>,</span>
<span id="cb281-12"><a href="data-visualization-with-r.html#cb281-12" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;korea, dem. rep.&quot;</span> <span class="ot">=</span> <span class="st">&quot;south korea&quot;</span>,</span>
<span id="cb281-13"><a href="data-visualization-with-r.html#cb281-13" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;korea. rep.&quot;</span>      <span class="ot">=</span> <span class="st">&quot;north korea&quot;</span>,</span>
<span id="cb281-14"><a href="data-visualization-with-r.html#cb281-14" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;tanzania&quot;</span>         <span class="ot">=</span> <span class="st">&quot;united republic of tanzania&quot;</span>,</span>
<span id="cb281-15"><a href="data-visualization-with-r.html#cb281-15" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;serbia&quot;</span>           <span class="ot">=</span> <span class="st">&quot;republic of serbia&quot;</span>,</span>
<span id="cb281-16"><a href="data-visualization-with-r.html#cb281-16" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;slovak republic&quot;</span>  <span class="ot">=</span> <span class="st">&quot;slovakia&quot;</span>,</span>
<span id="cb281-17"><a href="data-visualization-with-r.html#cb281-17" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;ethiopia&quot;</span>         <span class="ot">=</span> <span class="st">&quot;democratic republic of ethiopia&quot;</span>,</span>
<span id="cb281-18"><a href="data-visualization-with-r.html#cb281-18" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;yemen, rep.&quot;</span>      <span class="ot">=</span> <span class="st">&quot;yemen&quot;</span>))</span></code></pre></div>
<p>Now lets create the map</p>
</div>
<div id="histograpm" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> Histograpm<a href="data-visualization-with-r.html#histograpm" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="data-visualization-with-r.html#cb282-1" aria-hidden="true" tabindex="-1"></a>Marriage <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/marriage.csv&quot;</span>)</span>
<span id="cb282-2"><a href="data-visualization-with-r.html#cb282-2" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the histogram with a binwidth of 5</span></span>
<span id="cb282-3"><a href="data-visualization-with-r.html#cb282-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Marriage, <span class="fu">aes</span>(<span class="at">x =</span> age)) <span class="sc">+</span></span>
<span id="cb282-4"><a href="data-visualization-with-r.html#cb282-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">&quot;cornflowerblue&quot;</span>, </span>
<span id="cb282-5"><a href="data-visualization-with-r.html#cb282-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb282-6"><a href="data-visualization-with-r.html#cb282-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">binwidth =</span> <span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb282-7"><a href="data-visualization-with-r.html#cb282-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Participants by age&quot;</span>, </span>
<span id="cb282-8"><a href="data-visualization-with-r.html#cb282-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;binwidth = 5 years&quot;</span>,</span>
<span id="cb282-9"><a href="data-visualization-with-r.html#cb282-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Age&quot;</span>)</span></code></pre></div>
<p><img src="Rmanual_files/figure-html/unnamed-chunk-67-1.png" width="672" /></p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="data-visualization-with-r.html#cb283-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(gapminder, <span class="at">package=</span><span class="st">&quot;gapminder&quot;</span>)</span>
<span id="cb283-2"><a href="data-visualization-with-r.html#cb283-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-3"><a href="data-visualization-with-r.html#cb283-3" aria-hidden="true" tabindex="-1"></a><span class="co"># subset Asian countries in 2007</span></span>
<span id="cb283-4"><a href="data-visualization-with-r.html#cb283-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb283-5"><a href="data-visualization-with-r.html#cb283-5" aria-hidden="true" tabindex="-1"></a>plotdata <span class="ot">&lt;-</span> gapminder <span class="sc">%&gt;%</span></span>
<span id="cb283-6"><a href="data-visualization-with-r.html#cb283-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(continent <span class="sc">==</span> <span class="st">&quot;Africa&quot;</span> <span class="sc">&amp;</span> </span>
<span id="cb283-7"><a href="data-visualization-with-r.html#cb283-7" aria-hidden="true" tabindex="-1"></a>         year <span class="sc">==</span> <span class="dv">2007</span>)</span>
<span id="cb283-8"><a href="data-visualization-with-r.html#cb283-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-9"><a href="data-visualization-with-r.html#cb283-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Sorted Cleveland plot</span></span>
<span id="cb283-10"><a href="data-visualization-with-r.html#cb283-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plotdata, </span>
<span id="cb283-11"><a href="data-visualization-with-r.html#cb283-11" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span>lifeExp, </span>
<span id="cb283-12"><a href="data-visualization-with-r.html#cb283-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">y=</span><span class="fu">reorder</span>(country, lifeExp))) <span class="sc">+</span></span>
<span id="cb283-13"><a href="data-visualization-with-r.html#cb283-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">&quot;blue&quot;</span>, </span>
<span id="cb283-14"><a href="data-visualization-with-r.html#cb283-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb283-15"><a href="data-visualization-with-r.html#cb283-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">40</span>, </span>
<span id="cb283-16"><a href="data-visualization-with-r.html#cb283-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">xend =</span> lifeExp, </span>
<span id="cb283-17"><a href="data-visualization-with-r.html#cb283-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="fu">reorder</span>(country, lifeExp), </span>
<span id="cb283-18"><a href="data-visualization-with-r.html#cb283-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">yend =</span> <span class="fu">reorder</span>(country, lifeExp)),</span>
<span id="cb283-19"><a href="data-visualization-with-r.html#cb283-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;lightgrey&quot;</span>) <span class="sc">+</span></span>
<span id="cb283-20"><a href="data-visualization-with-r.html#cb283-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span> (<span class="at">x =</span> <span class="st">&quot;Life Expectancy (years)&quot;</span>,</span>
<span id="cb283-21"><a href="data-visualization-with-r.html#cb283-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb283-22"><a href="data-visualization-with-r.html#cb283-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">&quot;Life Expectancy by Country&quot;</span>,</span>
<span id="cb283-23"><a href="data-visualization-with-r.html#cb283-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">subtitle =</span> <span class="st">&quot;GapMinder data for Africa - 2007&quot;</span>) <span class="sc">+</span></span>
<span id="cb283-24"><a href="data-visualization-with-r.html#cb283-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb283-25"><a href="data-visualization-with-r.html#cb283-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb283-26"><a href="data-visualization-with-r.html#cb283-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="Rmanual_files/figure-html/unnamed-chunk-68-1.png" width="672" /></p>
<ul>
<li>Reunion clearly has the highest life expectancy, while Afghanistan has the lowest by far. This last plot is also called a lollipop graph (you can see why).</li>
</ul>
</div>
<div id="arranging-plots-into-a-grid" class="section level2 hasAnchor" number="4.7">
<h2><span class="header-section-number">4.7</span> Arranging plots into a grid<a href="data-visualization-with-r.html#arranging-plots-into-a-grid" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The cowplot package provides the function plot_grid() to arrange plots into a grid and label them.</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="data-visualization-with-r.html#cb284-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(disp, mpg, <span class="at">color=</span><span class="fu">as.factor</span>(cyl))) <span class="sc">+</span> </span>
<span id="cb284-2"><a href="data-visualization-with-r.html#cb284-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb284-3"><a href="data-visualization-with-r.html#cb284-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb284-4"><a href="data-visualization-with-r.html#cb284-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">&#39;Engine displament in litters&#39;</span>,</span>
<span id="cb284-5"><a href="data-visualization-with-r.html#cb284-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span> <span class="st">&quot;Mileage Per Hour&quot;</span>,</span>
<span id="cb284-6"><a href="data-visualization-with-r.html#cb284-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">color=</span><span class="st">&quot;Vehicle Cylinder Type&quot;</span>)<span class="sc">+</span></span>
<span id="cb284-7"><a href="data-visualization-with-r.html#cb284-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>()<span class="sc">+</span></span>
<span id="cb284-8"><a href="data-visualization-with-r.html#cb284-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&#39;grey20&#39;</span>,</span>
<span id="cb284-9"><a href="data-visualization-with-r.html#cb284-9" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">size=</span><span class="dv">10</span>,</span>
<span id="cb284-10"><a href="data-visualization-with-r.html#cb284-10" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">angle =</span> <span class="dv">0</span>,</span>
<span id="cb284-11"><a href="data-visualization-with-r.html#cb284-11" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">hjust=</span><span class="fl">0.5</span>,</span>
<span id="cb284-12"><a href="data-visualization-with-r.html#cb284-12" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">vjust=</span><span class="fl">0.5</span>),</span>
<span id="cb284-13"><a href="data-visualization-with-r.html#cb284-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&#39;grey20&#39;</span>,</span>
<span id="cb284-14"><a href="data-visualization-with-r.html#cb284-14" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb284-15"><a href="data-visualization-with-r.html#cb284-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&#39;italic&#39;</span>),</span>
<span id="cb284-16"><a href="data-visualization-with-r.html#cb284-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb284-17"><a href="data-visualization-with-r.html#cb284-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-18"><a href="data-visualization-with-r.html#cb284-18" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(qsec, mpg, <span class="at">color=</span><span class="fu">as.factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb284-19"><a href="data-visualization-with-r.html#cb284-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb284-20"><a href="data-visualization-with-r.html#cb284-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb284-21"><a href="data-visualization-with-r.html#cb284-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&#39;Souce: https://fueleconomy.gov&#39;</span>,</span>
<span id="cb284-22"><a href="data-visualization-with-r.html#cb284-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">&#39;Engine displament in litters&#39;</span>,</span>
<span id="cb284-23"><a href="data-visualization-with-r.html#cb284-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span> <span class="st">&quot;Mileage Per Hour&quot;</span>,</span>
<span id="cb284-24"><a href="data-visualization-with-r.html#cb284-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">color=</span><span class="st">&quot;Vehicle Cylider Type&quot;</span>)<span class="sc">+</span></span>
<span id="cb284-25"><a href="data-visualization-with-r.html#cb284-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>()<span class="sc">+</span></span>
<span id="cb284-26"><a href="data-visualization-with-r.html#cb284-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&#39;grey20&#39;</span>,</span>
<span id="cb284-27"><a href="data-visualization-with-r.html#cb284-27" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">size=</span><span class="dv">10</span>,</span>
<span id="cb284-28"><a href="data-visualization-with-r.html#cb284-28" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">angle =</span> <span class="dv">0</span>,</span>
<span id="cb284-29"><a href="data-visualization-with-r.html#cb284-29" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">hjust=</span><span class="fl">0.5</span>,</span>
<span id="cb284-30"><a href="data-visualization-with-r.html#cb284-30" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">vjust=</span><span class="fl">0.5</span>),</span>
<span id="cb284-31"><a href="data-visualization-with-r.html#cb284-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&#39;grey20&#39;</span>,</span>
<span id="cb284-32"><a href="data-visualization-with-r.html#cb284-32" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb284-33"><a href="data-visualization-with-r.html#cb284-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&#39;italic&#39;</span>),</span>
<span id="cb284-34"><a href="data-visualization-with-r.html#cb284-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb284-35"><a href="data-visualization-with-r.html#cb284-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-36"><a href="data-visualization-with-r.html#cb284-36" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(p1, p2, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;A&#39;</span>, <span class="st">&#39;B&#39;</span>), <span class="at">label_size =</span> <span class="dv">12</span>,<span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">&quot;h&quot;</span>)</span></code></pre></div>
<p><img src="Rmanual_files/figure-html/unnamed-chunk-69-1.png" width="672" /></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-analysis-with-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="special-ggplot2-plotting-extensions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/mesfind/Proposal/edit/master/Chapter3.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["Rmanual.pdf", "PDF"], ["Rmanual.epub", "EPUB"], ["Rmanual.docx", "Word"]],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
