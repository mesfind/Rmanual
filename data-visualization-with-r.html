<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Data Visualization with R | R Manual</title>
  <meta name="description" content="R and Manul" />
  <meta name="generator" content="bookdown 0.30 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Data Visualization with R | R Manual" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/fig/MWULogo.jpeg" />
  <meta property="og:description" content="R and Manul" />
  <meta name="github-repo" content="Chapter 4 Data Visualization with R | R Manual" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Data Visualization with R | R Manual" />
  
  <meta name="twitter:description" content="R and Manul" />
  <meta name="twitter:image" content="/fig/MWULogo.jpeg" />



<meta name="date" content="2022-11-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-analysis-with-r.html"/>
<link rel="next" href="special-ggplot2-plotting-extensions.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.1.1/leaflet-providers-plugin.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software-information-and-conventions"><i class="fa fa-check"></i>Software information and conventions</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="data-organization-with-spreadsheet.html"><a href="data-organization-with-spreadsheet.html"><i class="fa fa-check"></i><b>1</b> Data Organization with Spreadsheet</a>
<ul>
<li class="chapter" data-level="1.1" data-path="data-organization-with-spreadsheet.html"><a href="data-organization-with-spreadsheet.html#spreadsheet-programs"><i class="fa fa-check"></i><b>1.1</b> Spreadsheet Programs</a></li>
<li class="chapter" data-level="1.2" data-path="data-organization-with-spreadsheet.html"><a href="data-organization-with-spreadsheet.html#formatting-data-tables"><i class="fa fa-check"></i><b>1.2</b> Formatting data tables</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="data-organization-with-spreadsheet.html"><a href="data-organization-with-spreadsheet.html#problems-with-spreadsheets"><i class="fa fa-check"></i><b>1.2.1</b> Problems with Spreadsheets</a></li>
<li class="chapter" data-level="1.2.2" data-path="data-organization-with-spreadsheet.html"><a href="data-organization-with-spreadsheet.html#use-of-spreadsheets-for-data-entery-and-cleaning"><i class="fa fa-check"></i><b>1.2.2</b> Use of Spreadsheets for Data Entery and Cleaning</a></li>
<li class="chapter" data-level="1.2.3" data-path="data-organization-with-spreadsheet.html"><a href="data-organization-with-spreadsheet.html#keeping-track-of-your-analyses"><i class="fa fa-check"></i><b>1.2.3</b> Keeping track of your analyses</a></li>
<li class="chapter" data-level="1.2.4" data-path="data-organization-with-spreadsheet.html"><a href="data-organization-with-spreadsheet.html#structuring-data-in-spreadsheets"><i class="fa fa-check"></i><b>1.2.4</b> Structuring data in spreadsheets</a></li>
<li class="chapter" data-level="1.2.5" data-path="data-organization-with-spreadsheet.html"><a href="data-organization-with-spreadsheet.html#columns-for-variables-and-rows-for-observations"><i class="fa fa-check"></i><b>1.2.5</b> Columns for variables and rows for observations</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="data-organization-with-spreadsheet.html"><a href="data-organization-with-spreadsheet.html#common-spreadsheet-errors"><i class="fa fa-check"></i><b>1.3</b> Common Spreadsheet Errors</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="data-organization-with-spreadsheet.html"><a href="data-organization-with-spreadsheet.html#using-multiple-tabs"><i class="fa fa-check"></i><b>1.3.1</b> Using multiple tabs</a></li>
<li class="chapter" data-level="1.3.2" data-path="data-organization-with-spreadsheet.html"><a href="data-organization-with-spreadsheet.html#not-filling-in-zeros"><i class="fa fa-check"></i><b>1.3.2</b> Not filling in zeros</a></li>
<li class="chapter" data-level="1.3.3" data-path="data-organization-with-spreadsheet.html"><a href="data-organization-with-spreadsheet.html#using-problematic-null-values"><i class="fa fa-check"></i><b>1.3.3</b> Using problematic null values</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="data-organization-with-spreadsheet.html"><a href="data-organization-with-spreadsheet.html#date-as-data"><i class="fa fa-check"></i><b>1.4</b> Date as data</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html"><i class="fa fa-check"></i><b>2</b> Data Cleaning with OpenRefine</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#layout"><i class="fa fa-check"></i><b>2.1</b> Layout</a></li>
<li class="chapter" data-level="2.2" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#records-and-rows"><i class="fa fa-check"></i><b>2.2</b> Records and Rows</a></li>
<li class="chapter" data-level="2.3" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#changing-the-grid-view"><i class="fa fa-check"></i><b>2.3</b> Changing the Grid View</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#permanent-changes"><i class="fa fa-check"></i><b>2.3.1</b> Permanent Changes</a></li>
<li class="chapter" data-level="2.3.2" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#non-permanent-changes"><i class="fa fa-check"></i><b>2.3.2</b> Non-Permanent Changes</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#data-mining-and-discovery"><i class="fa fa-check"></i><b>2.4</b> Data Mining and Discovery</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#reordering-columns"><i class="fa fa-check"></i><b>2.4.1</b> Reordering Columns</a></li>
<li class="chapter" data-level="2.4.2" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#sorting-data"><i class="fa fa-check"></i><b>2.4.2</b> Sorting Data</a></li>
<li class="chapter" data-level="2.4.3" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#text-based-discovery"><i class="fa fa-check"></i><b>2.4.3</b> Text Based Discovery</a></li>
<li class="chapter" data-level="2.4.4" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#number-and-data-based-discovery"><i class="fa fa-check"></i><b>2.4.4</b> Number and Data Based Discovery</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#data-preparation-and-normalization"><i class="fa fa-check"></i><b>2.5</b> Data Preparation and Normalization</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#common-transformations"><i class="fa fa-check"></i><b>2.5.1</b> Common Transformations</a></li>
<li class="chapter" data-level="2.5.2" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#removing-duplicates"><i class="fa fa-check"></i><b>2.5.2</b> Removing Duplicates</a></li>
<li class="chapter" data-level="2.5.3" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#splitting-cell-values"><i class="fa fa-check"></i><b>2.5.3</b> Splitting Cell Values</a></li>
<li class="chapter" data-level="2.5.4" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#combining-cell-values"><i class="fa fa-check"></i><b>2.5.4</b> Combining cell Values</a></li>
<li class="chapter" data-level="2.5.5" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#data-shaping"><i class="fa fa-check"></i><b>2.5.5</b> Data Shaping</a></li>
<li class="chapter" data-level="2.5.6" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#clustering"><i class="fa fa-check"></i><b>2.5.6</b> Clustering</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="data-cleaning-with-openrefine.html"><a href="data-cleaning-with-openrefine.html#how-to-cluster"><i class="fa fa-check"></i><b>2.6</b> How to Cluster</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html"><i class="fa fa-check"></i><b>3</b> Data Analysis with R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#what-is-r-what-is-rstudio"><i class="fa fa-check"></i><b>3.1</b> What is R? What is RStudio?</a></li>
<li class="chapter" data-level="3.2" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#why-learn-r"><i class="fa fa-check"></i><b>3.2</b> Why learn R?</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#r-does-not-involve-lots-of-pointing-and-clicking-and-thats-a-good-thing"><i class="fa fa-check"></i><b>3.2.1</b> R does not involve lots of pointing and clicking, and that’s a good thing</a></li>
<li class="chapter" data-level="3.2.2" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#r-code-is-great-for-reproducibility"><i class="fa fa-check"></i><b>3.2.2</b> R code is great for reproducibility</a></li>
<li class="chapter" data-level="3.2.3" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#r-is-interdisciplinary-and-extensible"><i class="fa fa-check"></i><b>3.2.3</b> R is interdisciplinary and extensible</a></li>
<li class="chapter" data-level="3.2.4" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#r-works-on-data-of-all-shapes-and-sizes"><i class="fa fa-check"></i><b>3.2.4</b> R works on data of all shapes and sizes</a></li>
<li class="chapter" data-level="3.2.5" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#r-produces-high-quality-graphics"><i class="fa fa-check"></i><b>3.2.5</b> R produces high-quality graphics</a></li>
<li class="chapter" data-level="3.2.6" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#r-has-a-large-and-welcoming-community"><i class="fa fa-check"></i><b>3.2.6</b> R has a large and welcoming community</a></li>
<li class="chapter" data-level="3.2.7" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#not-only-is-r-free-but-it-is-also-open-source-and-cross-platform"><i class="fa fa-check"></i><b>3.2.7</b> Not only is R free, but it is also open-source and cross-platform</a></li>
<li class="chapter" data-level="3.2.8" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#knowing-your-way-around-rstudio"><i class="fa fa-check"></i><b>3.2.8</b> Knowing your way around RStudio</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#introduction-to-r"><i class="fa fa-check"></i><b>3.3</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#comments"><i class="fa fa-check"></i><b>3.3.1</b> Comments</a></li>
<li class="chapter" data-level="3.3.2" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#functions-and-their-arguments"><i class="fa fa-check"></i><b>3.3.2</b> Functions and their arguments</a></li>
<li class="chapter" data-level="3.3.3" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#data-structure"><i class="fa fa-check"></i><b>3.3.3</b> Data Structure</a></li>
<li class="chapter" data-level="3.3.4" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#subsetting-vectors"><i class="fa fa-check"></i><b>3.3.4</b> Subsetting vectors</a></li>
<li class="chapter" data-level="3.3.5" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#conditional-subsetting"><i class="fa fa-check"></i><b>3.3.5</b> Conditional subsetting</a></li>
<li class="chapter" data-level="3.3.6" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#missing-data"><i class="fa fa-check"></i><b>3.3.6</b> Missing Data</a></li>
<li class="chapter" data-level="3.3.7" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#matrices"><i class="fa fa-check"></i><b>3.3.7</b> Matrices</a></li>
<li class="chapter" data-level="3.3.8" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#data-frames"><i class="fa fa-check"></i><b>3.3.8</b> Data Frames</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#starting-with-data"><i class="fa fa-check"></i><b>3.4</b> Starting with data</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#inspecting-data-frame-objects"><i class="fa fa-check"></i><b>3.4.1</b> Inspecting Data Frame Objects</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#indexing-and-subsetting-data-frames"><i class="fa fa-check"></i><b>3.5</b> Indexing and subsetting data frames</a></li>
<li class="chapter" data-level="3.6" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#factors-1"><i class="fa fa-check"></i><b>3.6</b> Factors</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#converting-factors"><i class="fa fa-check"></i><b>3.6.1</b> Converting factors</a></li>
<li class="chapter" data-level="3.6.2" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#renaming-factors"><i class="fa fa-check"></i><b>3.6.2</b> Renaming factors</a></li>
<li class="chapter" data-level="3.6.3" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#using-stringsasfactorsfalse"><i class="fa fa-check"></i><b>3.6.3</b> Using <code>stringsAsFactors=FALSE</code></a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#formatting-dates"><i class="fa fa-check"></i><b>3.7</b> Formatting Dates</a></li>
<li class="chapter" data-level="3.8" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#manipulating-and-analyzing-data-with-tidyverse"><i class="fa fa-check"></i><b>3.8</b> manipulating and analyzing data with tidyverse</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="data-analysis-with-r.html"><a href="data-analysis-with-r.html#data-manipulation-using-dplyr-and-tidyr"><i class="fa fa-check"></i><b>3.8.1</b> Data Manipulation using <strong><code>dplyr</code></strong> and <strong><code>tidyr</code></strong></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-visualization-with-r.html"><a href="data-visualization-with-r.html"><i class="fa fa-check"></i><b>4</b> Data Visualization with R</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-visualization-with-r.html"><a href="data-visualization-with-r.html#basics-of-ggplot2"><i class="fa fa-check"></i><b>4.1</b> Basics of ggplot2</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="data-visualization-with-r.html"><a href="data-visualization-with-r.html#importing-data"><i class="fa fa-check"></i><b>4.1.1</b> Importing data</a></li>
<li class="chapter" data-level="4.1.2" data-path="data-visualization-with-r.html"><a href="data-visualization-with-r.html#scatter-plot"><i class="fa fa-check"></i><b>4.1.2</b> Scatter plot</a></li>
<li class="chapter" data-level="4.1.3" data-path="data-visualization-with-r.html"><a href="data-visualization-with-r.html#bar-plot"><i class="fa fa-check"></i><b>4.1.3</b> Bar Plot</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="data-visualization-with-r.html"><a href="data-visualization-with-r.html#boxplots"><i class="fa fa-check"></i><b>4.2</b> Boxplots</a></li>
<li class="chapter" data-level="4.3" data-path="data-visualization-with-r.html"><a href="data-visualization-with-r.html#plotting-time-series-data"><i class="fa fa-check"></i><b>4.3</b> Plotting time series data</a></li>
<li class="chapter" data-level="4.4" data-path="data-visualization-with-r.html"><a href="data-visualization-with-r.html#line-plot"><i class="fa fa-check"></i><b>4.4</b> Line Plot</a></li>
<li class="chapter" data-level="4.5" data-path="data-visualization-with-r.html"><a href="data-visualization-with-r.html#histograpm"><i class="fa fa-check"></i><b>4.5</b> Histograpm</a></li>
<li class="chapter" data-level="4.6" data-path="data-visualization-with-r.html"><a href="data-visualization-with-r.html#arranging-plots-into-a-grid"><i class="fa fa-check"></i><b>4.6</b> Arranging plots into a grid</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="special-ggplot2-plotting-extensions.html"><a href="special-ggplot2-plotting-extensions.html"><i class="fa fa-check"></i><b>5</b> Special ggplot2 plotting extensions</a>
<ul>
<li class="chapter" data-level="5.1" data-path="special-ggplot2-plotting-extensions.html"><a href="special-ggplot2-plotting-extensions.html#ggcharts"><i class="fa fa-check"></i><b>5.1</b> ggcharts</a></li>
<li class="chapter" data-level="5.2" data-path="special-ggplot2-plotting-extensions.html"><a href="special-ggplot2-plotting-extensions.html#based-plots-with-statistical-details"><i class="fa fa-check"></i><b>5.2</b> Based Plots with Statistical Details</a></li>
<li class="chapter" data-level="5.3" data-path="special-ggplot2-plotting-extensions.html"><a href="special-ggplot2-plotting-extensions.html#gganimate"><i class="fa fa-check"></i><b>5.3</b> gganimate</a></li>
<li class="chapter" data-level="5.4" data-path="special-ggplot2-plotting-extensions.html"><a href="special-ggplot2-plotting-extensions.html#mapping-with-r"><i class="fa fa-check"></i><b>5.4</b> Mapping with R</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="special-ggplot2-plotting-extensions.html"><a href="special-ggplot2-plotting-extensions.html#map-color"><i class="fa fa-check"></i><b>5.4.1</b> Map color</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="special-ggplot2-plotting-extensions.html"><a href="special-ggplot2-plotting-extensions.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>5.5</b> Exploratory data analysis</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="special-ggplot2-plotting-extensions.html"><a href="special-ggplot2-plotting-extensions.html#statistical-variables-and-data"><i class="fa fa-check"></i><b>5.5.1</b> Statistical variables and data</a></li>
<li class="chapter" data-level="5.5.2" data-path="special-ggplot2-plotting-extensions.html"><a href="special-ggplot2-plotting-extensions.html#understanding-numerical-variables"><i class="fa fa-check"></i><b>5.5.2</b> Understanding numerical variables</a></li>
<li class="chapter" data-level="5.5.3" data-path="special-ggplot2-plotting-extensions.html"><a href="special-ggplot2-plotting-extensions.html#understanding-categorical-variables"><i class="fa fa-check"></i><b>5.5.3</b> Understanding categorical variables</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="special-ggplot2-plotting-extensions.html"><a href="special-ggplot2-plotting-extensions.html#regression-with-r"><i class="fa fa-check"></i><b>5.6</b> Regression with R</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="special-ggplot2-plotting-extensions.html"><a href="special-ggplot2-plotting-extensions.html#hypotheses-and-null-hypotheses"><i class="fa fa-check"></i><b>5.6.1</b> Hypotheses and null hypotheses</a></li>
<li class="chapter" data-level="5.6.2" data-path="special-ggplot2-plotting-extensions.html"><a href="special-ggplot2-plotting-extensions.html#linear-regression"><i class="fa fa-check"></i><b>5.6.2</b> Linear Regression</a></li>
<li class="chapter" data-level="5.6.3" data-path="special-ggplot2-plotting-extensions.html"><a href="special-ggplot2-plotting-extensions.html#generalized-linear-modelglm"><i class="fa fa-check"></i><b>5.6.3</b> Generalized Linear Model(GLM)</a></li>
<li class="chapter" data-level="5.6.4" data-path="special-ggplot2-plotting-extensions.html"><a href="special-ggplot2-plotting-extensions.html#logistic-regression"><i class="fa fa-check"></i><b>5.6.4</b> Logistic Regression</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="special-ggplot2-plotting-extensions.html"><a href="special-ggplot2-plotting-extensions.html#anova-with-r"><i class="fa fa-check"></i><b>5.7</b> Anova with R</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html"><i class="fa fa-check"></i><b>6</b> Scientific Publishing with Quarto in R</a>
<ul>
<li class="chapter" data-level="6.1" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#publishing-with-quarto"><i class="fa fa-check"></i><b>6.1</b> Publishing with Quarto</a></li>
<li class="chapter" data-level="6.2" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#markdown-basics"><i class="fa fa-check"></i><b>6.2</b> Markdown Basics</a></li>
<li class="chapter" data-level="6.3" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#r-markdown-syntax"><i class="fa fa-check"></i><b>6.3</b> R Markdown Syntax</a></li>
<li class="chapter" data-level="6.4" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#rendering-output"><i class="fa fa-check"></i><b>6.4</b> Rendering output</a></li>
<li class="chapter" data-level="6.5" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#how-it-works"><i class="fa fa-check"></i><b>6.5</b> How it works</a></li>
<li class="chapter" data-level="6.6" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#code-chunks"><i class="fa fa-check"></i><b>6.6</b> Code Chunks</a></li>
<li class="chapter" data-level="6.7" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#inline-code"><i class="fa fa-check"></i><b>6.7</b> Inline Code</a></li>
<li class="chapter" data-level="6.8" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#code-languages"><i class="fa fa-check"></i><b>6.8</b> Code Languages</a></li>
<li class="chapter" data-level="6.9" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#academic-journals"><i class="fa fa-check"></i><b>6.9</b> Academic Journals</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#get-started"><i class="fa fa-check"></i><b>6.9.1</b> Get started</a></li>
<li class="chapter" data-level="6.9.2" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#rticles-templates"><i class="fa fa-check"></i><b>6.9.2</b> rticles templates</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#essential-commands-with-quarto"><i class="fa fa-check"></i><b>6.10</b> Essential commands with Quarto</a>
<ul>
<li class="chapter" data-level="6.10.1" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#rendering"><i class="fa fa-check"></i><b>6.10.1</b> Rendering</a></li>
<li class="chapter" data-level="6.10.2" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#authoring"><i class="fa fa-check"></i><b>6.10.2</b> Authoring</a></li>
</ul></li>
<li class="chapter" data-level="6.11" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#creating-journal-articles"><i class="fa fa-check"></i><b>6.11</b> Creating Journal Articles</a></li>
<li class="chapter" data-level="6.12" data-path="scientific-publishing-with-quarto-in-r.html"><a href="scientific-publishing-with-quarto-in-r.html#creating-books"><i class="fa fa-check"></i><b>6.12</b> Creating books</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="" data-path="appendex-1.html"><a href="appendex-1.html"><i class="fa fa-check"></i>Appendex 1</a>
<ul>
<li class="chapter" data-level="13" data-path="appendex-1.html"><a href="appendex-1.html#installing-r-and-rstudio"><i class="fa fa-check"></i><b>13</b> Installing R and Rstudio</a>
<ul>
<li class="chapter" data-level="13.1" data-path="appendex-1.html"><a href="appendex-1.html#installing-r"><i class="fa fa-check"></i><b>13.1</b> installing R</a></li>
<li class="chapter" data-level="13.2" data-path="appendex-1.html"><a href="appendex-1.html#installing-rstudio"><i class="fa fa-check"></i><b>13.2</b> Installing RStudio</a></li>
<li class="chapter" data-level="13.3" data-path="appendex-1.html"><a href="appendex-1.html#open-rstudio"><i class="fa fa-check"></i><b>13.3</b> Open RStudio</a></li>
<li class="chapter" data-level="13.4" data-path="appendex-1.html"><a href="appendex-1.html#installing-r-packages"><i class="fa fa-check"></i><b>13.4</b> Installing R packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="A" data-path="install-gdal-and-geos.html"><a href="install-gdal-and-geos.html"><i class="fa fa-check"></i><b>A</b> Install gdal and geos</a>
<ul>
<li class="chapter" data-level="A.1" data-path="install-gdal-and-geos.html"><a href="install-gdal-and-geos.html#on-windows"><i class="fa fa-check"></i><b>A.1</b> on Windows</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="install-mapping-library.html"><a href="install-mapping-library.html"><i class="fa fa-check"></i><b>B</b> Install Mapping Library</a></li>
<li class="chapter" data-level="C" data-path="download-spatial-data.html"><a href="download-spatial-data.html"><i class="fa fa-check"></i><b>C</b> Download spatial data</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://mesfind.github.io" target="blank">&copy Mesfin Diro</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><div class="line-block">Data Analysis , Visualization, and Scientfic Publishing with R &amp; Rstudio<br />
<br />
Participant Manual<br />
</div></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-visualization-with-r" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Data Visualization with R<a href="data-visualization-with-r.html#data-visualization-with-r" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<blockquote>
<p>“The simple graph has brought more information to the data analyst’s mind than any other device.” — John Tukey</p>
</blockquote>
<p>This chapter will show you how to use ggplot2 to visualize your data. There are various graphing systems in R, but ggplot2 is one of the most attractive and versatile. ggplot2 implements graphics language, a unified method for describing and creating graphs. By learning one system and using it in multiple locations, you can accomplish more in less time with ggplot2.</p>
<div id="basics-of-ggplot2" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Basics of ggplot2<a href="data-visualization-with-r.html#basics-of-ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The tidyverse’s main member, ggplot2, is the subject of this chapter. Load the tidyverse with this code to get access to the datasets, help pages, and functions:</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="data-visualization-with-r.html#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># it has ggplot2 package</span></span>
<span id="cb236-2"><a href="data-visualization-with-r.html#cb236-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot) <span class="co"># it allows you to save figures in .png file</span></span></code></pre></div>
<p>That one line of code loads the fundamental tidyverse packages, which are used in practically every data analysis. It also shows you which tidyverse functions clash with base R functions (or from other packages you might have loaded).</p>
<p>If the error message “there is no package called ‘tidyverse’” appears when you execute this code, you must first install it before running <strong>library()</strong> again.</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="data-visualization-with-r.html#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>)</span>
<span id="cb237-2"><a href="data-visualization-with-r.html#cb237-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<p>A package only needs to be installed once, but it must be reloaded every time you start a new session.</p>
<div id="importing-data" class="section level3 hasAnchor" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Importing data<a href="data-visualization-with-r.html#importing-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>R can read data from a variety of sources, including text files, spreadsheets, statistical packages, and database management systems. We’ll use the <code>mpg dataset</code> to demonstrate these strategies. This dataset comprises data from the US Environmental Protection Agency on 38 different car models.</p>
<div id="text-files" class="section level4 hasAnchor" number="4.1.1.1">
<h4><span class="header-section-number">4.1.1.1</span> Text files<a href="data-visualization-with-r.html#text-files" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The readr package provides functions for importing delimited text files into R data frames.</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="data-visualization-with-r.html#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr) <span class="co"># read dataset from file</span></span>
<span id="cb238-2"><a href="data-visualization-with-r.html#cb238-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">readr.show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb238-3"><a href="data-visualization-with-r.html#cb238-3" aria-hidden="true" tabindex="-1"></a><span class="co"># CSV</span></span>
<span id="cb238-4"><a href="data-visualization-with-r.html#cb238-4" aria-hidden="true" tabindex="-1"></a>mpg_csv <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/mpg.csv&quot;</span>) </span>
<span id="cb238-5"><a href="data-visualization-with-r.html#cb238-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-6"><a href="data-visualization-with-r.html#cb238-6" aria-hidden="true" tabindex="-1"></a><span class="co"># TSV</span></span>
<span id="cb238-7"><a href="data-visualization-with-r.html#cb238-7" aria-hidden="true" tabindex="-1"></a>mpg_tsv <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(<span class="st">&quot;data/mpg.tsv&quot;</span>) </span></code></pre></div>
<p>These functions assume that the variable names are on the first line of data, that values are separated by commas or tabs, and that missing data is represented by blanks.</p>
</div>
<div id="excel-spreadsheets" class="section level4 hasAnchor" number="4.1.1.2">
<h4><span class="header-section-number">4.1.1.2</span> Excel spreadsheets<a href="data-visualization-with-r.html#excel-spreadsheets" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Data from Excel workbooks can be imported using the <code>readxl</code> program. The formats <code>xls</code> and <code>xlsx</code> are both supported.</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="data-visualization-with-r.html#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl) <span class="co"># excel</span></span>
<span id="cb239-2"><a href="data-visualization-with-r.html#cb239-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Excel</span></span>
<span id="cb239-3"><a href="data-visualization-with-r.html#cb239-3" aria-hidden="true" tabindex="-1"></a>mpg_excel <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;data/mpg.xlsx&quot;</span>, <span class="at">sheet=</span><span class="st">&#39;mpg&#39;</span>)</span>
<span id="cb239-4"><a href="data-visualization-with-r.html#cb239-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mpg_excel)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 12
##    ...1 manufacturer model displ  year   cyl trans drv     cty   hwy fl    class
##   &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
## 1     1 audi         a4    1,8    1999     4 auto… f        18    29 p     comp…
## 2     2 audi         a4    1,8    1999     4 manu… f        21    29 p     comp…
## 3     3 audi         a4    2,0    2008     4 manu… f        20    31 p     comp…
## 4     4 audi         a4    2,0    2008     4 auto… f        21    30 p     comp…
## 5     5 audi         a4    2,8    1999     6 auto… f        16    26 p     comp…
## 6     6 audi         a4    2,8    1999     6 manu… f        18    26 p     comp…</code></pre>
</div>
<div id="statistical-packages" class="section level4 hasAnchor" number="4.1.1.3">
<h4><span class="header-section-number">4.1.1.3</span> Statistical packages<a href="data-visualization-with-r.html#statistical-packages" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <code>haven</code> package contains functions for importing data from many statistical programs such as SAS, SPSS and Stata.</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="data-visualization-with-r.html#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven) <span class="co"># excel</span></span>
<span id="cb241-2"><a href="data-visualization-with-r.html#cb241-2" aria-hidden="true" tabindex="-1"></a><span class="co"># SAS</span></span>
<span id="cb241-3"><a href="data-visualization-with-r.html#cb241-3" aria-hidden="true" tabindex="-1"></a>mtcars_sas <span class="ot">&lt;-</span> <span class="fu">read_sas</span>(<span class="st">&quot;data/mtcars.sas7bdat&quot;</span>)</span>
<span id="cb241-4"><a href="data-visualization-with-r.html#cb241-4" aria-hidden="true" tabindex="-1"></a><span class="co"># SPSS</span></span>
<span id="cb241-5"><a href="data-visualization-with-r.html#cb241-5" aria-hidden="true" tabindex="-1"></a>mtcars_spss <span class="ot">&lt;-</span> <span class="fu">read_sav</span>(<span class="st">&quot;data/mtcars.sav&quot;</span>)</span>
<span id="cb241-6"><a href="data-visualization-with-r.html#cb241-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Stata</span></span>
<span id="cb241-7"><a href="data-visualization-with-r.html#cb241-7" aria-hidden="true" tabindex="-1"></a>mtcars_stata <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="st">&quot;data/mtcars.dta&quot;</span>)</span>
<span id="cb241-8"><a href="data-visualization-with-r.html#cb241-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mtcars_spss)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 11
##     mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1  21       6   160   110  3.9   2.62  16.5     0     1     4     4
## 2  21       6   160   110  3.9   2.88  17.0     0     1     4     4
## 3  22.8     4   108    93  3.85  2.32  18.6     1     1     4     1
## 4  21.4     6   258   110  3.08  3.22  19.4     1     0     3     1
## 5  18.7     8   360   175  3.15  3.44  17.0     0     0     3     2
## 6  18.1     6   225   105  2.76  3.46  20.2     1     0     3     1</code></pre>
</div>
</div>
<div id="scatter-plot" class="section level3 hasAnchor" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Scatter plot<a href="data-visualization-with-r.html#scatter-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The first function in building a graph is the ggplot function. It specifies the</p>
<ul>
<li>data frame containing the data to be plotted</li>
<li>the mapping of the variables to visual properties of the graph. The mappings are placed within the <code>aes</code> function (where <code>aes</code> stands for aesthetics).</li>
</ul>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="data-visualization-with-r.html#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb243-2"><a href="data-visualization-with-r.html#cb243-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb243-3"><a href="data-visualization-with-r.html#cb243-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr) </span>
<span id="cb243-4"><a href="data-visualization-with-r.html#cb243-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-5"><a href="data-visualization-with-r.html#cb243-5" aria-hidden="true" tabindex="-1"></a><span class="co"># df</span></span>
<span id="cb243-6"><a href="data-visualization-with-r.html#cb243-6" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/mpg.csv&quot;</span>) </span>
<span id="cb243-7"><a href="data-visualization-with-r.html#cb243-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df) <span class="sc">+</span>  </span>
<span id="cb243-8"><a href="data-visualization-with-r.html#cb243-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy))</span></code></pre></div>
<p><img src="Rmanual_files/figure-html/unnamed-chunk-53-1.png" width="672" /></p>
<p>The graph demonstrates that engine size <code>(displ)</code> and fuel efficiency have a negative relationship <code>(hwy)</code>. To put it another way, cars with large engines consume more fuel. Does this support or disprove your hypothesis concerning engine size and fuel efficiency?</p>
<p>The function <code>ggplot2</code> is used to start a plot in <code>ggplot2()</code>. <code>ggplot()</code> builds a coordinate system to which layers can be added. The dataset to utilize in the graph is the first parameter to <code>ggplot()</code>. So <code>ggplot(data = mpg_csv)</code> produces an empty graph, which I won’t show here because it’s not that interesting.</p>
<p>By matching the aesthetics of your plot to the variables in your dataset, you may convey information about your data. You can, for example, link the colors of your points to the class variable to reveal each car’s class.</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="data-visualization-with-r.html#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb244-2"><a href="data-visualization-with-r.html#cb244-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb244-3"><a href="data-visualization-with-r.html#cb244-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr) <span class="co"># read dataset from file</span></span>
<span id="cb244-4"><a href="data-visualization-with-r.html#cb244-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb244-5"><a href="data-visualization-with-r.html#cb244-5" aria-hidden="true" tabindex="-1"></a><span class="co"># df</span></span>
<span id="cb244-6"><a href="data-visualization-with-r.html#cb244-6" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/mpg.csv&quot;</span>) </span>
<span id="cb244-7"><a href="data-visualization-with-r.html#cb244-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df) <span class="sc">+</span> </span>
<span id="cb244-8"><a href="data-visualization-with-r.html#cb244-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color=</span>class))</span></code></pre></div>
<p><img src="Rmanual_files/figure-html/color_class-1.png" width="672" /></p>
<p>You can also set the aesthetic properties of your geom manually. For example, we can make all of the points in our plot blue:</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="data-visualization-with-r.html#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb245-2"><a href="data-visualization-with-r.html#cb245-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb245-3"><a href="data-visualization-with-r.html#cb245-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr) <span class="co"># read dataset from file</span></span>
<span id="cb245-4"><a href="data-visualization-with-r.html#cb245-4" aria-hidden="true" tabindex="-1"></a><span class="co"># df</span></span>
<span id="cb245-5"><a href="data-visualization-with-r.html#cb245-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/mpg.csv&quot;</span>) </span>
<span id="cb245-6"><a href="data-visualization-with-r.html#cb245-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df) <span class="sc">+</span> </span>
<span id="cb245-7"><a href="data-visualization-with-r.html#cb245-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy), <span class="at">color=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="Rmanual_files/figure-html/color_blue-1.png" width="672" /></p>
<p>The color modifies the appearance of the plot rather than conveying information about a variable. Set the aesthetic by name as an argument of your geom function to manually set an aesthetic; i.e. it goes outside of <code>aes()</code>. You’ll need to choose a level that fits that aesthetic:</p>
<ul>
<li>The name of a color as a character string.</li>
<li>The size of a point in mm.</li>
<li>The shape of a point as a number</li>
</ul>
<p><strong><em>Facets in ggplot2:</em></strong></p>
<p>Splitting your plot into facets, or subplots that each display one subset of the data, is another option, especially for categorical variables. Use <code>facet_wrap()</code> to facet your plot by a single variable. <code>facet_wrap()</code> expects a formula as the first input, followed by a variable name (note that “formula” is the name of a data structure in R, not a synonym for “equation”). <code>facet_wrap()</code> expects a discrete variable as a parameter.</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="data-visualization-with-r.html#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb246-2"><a href="data-visualization-with-r.html#cb246-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb246-3"><a href="data-visualization-with-r.html#cb246-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr) </span>
<span id="cb246-4"><a href="data-visualization-with-r.html#cb246-4" aria-hidden="true" tabindex="-1"></a><span class="co"># df</span></span>
<span id="cb246-5"><a href="data-visualization-with-r.html#cb246-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/mpg.csv&quot;</span>) </span>
<span id="cb246-6"><a href="data-visualization-with-r.html#cb246-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df) <span class="sc">+</span> </span>
<span id="cb246-7"><a href="data-visualization-with-r.html#cb246-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color=</span>class))<span class="sc">+</span></span>
<span id="cb246-8"><a href="data-visualization-with-r.html#cb246-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> manufacturer, <span class="at">nrow =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="Rmanual_files/figure-html/facet_wrap-1.png" width="672" /></p>
<p>Add <code>facet_grid()</code> to your plot call to facet your plot on the combination of two variables. Facet grid(first )’s parameter is likewise a formula. The formula should now have two variable names separated by a comma.</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="data-visualization-with-r.html#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb247-2"><a href="data-visualization-with-r.html#cb247-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb247-3"><a href="data-visualization-with-r.html#cb247-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr) <span class="co"># read dataset from file</span></span>
<span id="cb247-4"><a href="data-visualization-with-r.html#cb247-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb247-5"><a href="data-visualization-with-r.html#cb247-5" aria-hidden="true" tabindex="-1"></a><span class="co"># df</span></span>
<span id="cb247-6"><a href="data-visualization-with-r.html#cb247-6" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/mpg.csv&quot;</span>) </span>
<span id="cb247-7"><a href="data-visualization-with-r.html#cb247-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df) <span class="sc">+</span>  </span>
<span id="cb247-8"><a href="data-visualization-with-r.html#cb247-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color=</span>class))<span class="sc">+</span></span>
<span id="cb247-9"><a href="data-visualization-with-r.html#cb247-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>( drv <span class="sc">~</span> cyl)</span></code></pre></div>
<p><img src="Rmanual_files/figure-html/facet_grid-1.png" width="672" /></p>
<p>Note: Use a <code>.</code> instead of a variable name if you don’t want to facet in the rows or columns dimension, e.g. <code>+ facet grid(.  ~ cyl)</code>.</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="data-visualization-with-r.html#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb248-2"><a href="data-visualization-with-r.html#cb248-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb248-3"><a href="data-visualization-with-r.html#cb248-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr) <span class="co"># read dataset from file</span></span>
<span id="cb248-4"><a href="data-visualization-with-r.html#cb248-4" aria-hidden="true" tabindex="-1"></a><span class="co"># df</span></span>
<span id="cb248-5"><a href="data-visualization-with-r.html#cb248-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/mpg.csv&quot;</span>) </span>
<span id="cb248-6"><a href="data-visualization-with-r.html#cb248-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df) <span class="sc">+</span> </span>
<span id="cb248-7"><a href="data-visualization-with-r.html#cb248-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color=</span>class))<span class="sc">+</span></span>
<span id="cb248-8"><a href="data-visualization-with-r.html#cb248-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> cyl)</span></code></pre></div>
<p><img src="Rmanual_files/figure-html/facet_grid2-1.png" width="672" />
<strong>Geometric objects:</strong>_</p>
<p>A geom is a geometrical object used to represent data in a plot. Plots are frequently described by the sort of geom they employ. Bar charts, for example, use bar geoms, line charts use <code>line geoms</code>, and boxplots use <code>boxplot geoms</code>. <em>Scatterplots</em> use the <code>point geom</code> to break the trend. As we’ve seen, different __geoms_ can be used to plot the same data. The point geom is used for scatter plot, and the smooth geom, a smooth line suited to the data.To display multiple geoms in the same plot, add multiple geom functions to <code>ggplot()</code> as shown blow:</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="data-visualization-with-r.html#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb249-2"><a href="data-visualization-with-r.html#cb249-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr) <span class="co"># read dataset from file</span></span>
<span id="cb249-3"><a href="data-visualization-with-r.html#cb249-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb249-4"><a href="data-visualization-with-r.html#cb249-4" aria-hidden="true" tabindex="-1"></a><span class="co"># df</span></span>
<span id="cb249-5"><a href="data-visualization-with-r.html#cb249-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/mpg.csv&quot;</span>) </span>
<span id="cb249-6"><a href="data-visualization-with-r.html#cb249-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-7"><a href="data-visualization-with-r.html#cb249-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb249-8"><a href="data-visualization-with-r.html#cb249-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb249-9"><a href="data-visualization-with-r.html#cb249-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()<span class="sc">+</span></span>
<span id="cb249-10"><a href="data-visualization-with-r.html#cb249-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Relationship between displacment and highway of 38 different car models&quot;</span>,</span>
<span id="cb249-11"><a href="data-visualization-with-r.html#cb249-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Feul economy data from 1999 to 2008&quot;</span>,</span>
<span id="cb249-12"><a href="data-visualization-with-r.html#cb249-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;source: https://fueleconomy.gov/&quot;</span>,</span>
<span id="cb249-13"><a href="data-visualization-with-r.html#cb249-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Engine displacement in liters&quot;</span>,</span>
<span id="cb249-14"><a href="data-visualization-with-r.html#cb249-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Highway mileage&quot;</span>,</span>
<span id="cb249-15"><a href="data-visualization-with-r.html#cb249-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;vehicle class&quot;</span>)<span class="sc">+</span></span>
<span id="cb249-16"><a href="data-visualization-with-r.html#cb249-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubr</span>()<span class="sc">+</span></span>
<span id="cb249-17"><a href="data-visualization-with-r.html#cb249-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grids</span>(<span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span></span>
<span id="cb249-18"><a href="data-visualization-with-r.html#cb249-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;grey20&quot;</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb249-19"><a href="data-visualization-with-r.html#cb249-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;grey20&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb249-20"><a href="data-visualization-with-r.html#cb249-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;italic&quot;</span>),</span>
<span id="cb249-21"><a href="data-visualization-with-r.html#cb249-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code></pre></div>
<p><img src="Rmanual_files/figure-html/geom_smooth-1.png" width="672" /></p>
<p><strong>Exercise</strong></p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="data-visualization-with-r.html#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add facet wrap using manufacturer variable</span></span>
<span id="cb250-2"><a href="data-visualization-with-r.html#cb250-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb250-3"><a href="data-visualization-with-r.html#cb250-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb250-4"><a href="data-visualization-with-r.html#cb250-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr) <span class="co"># read dataset from file</span></span>
<span id="cb250-5"><a href="data-visualization-with-r.html#cb250-5" aria-hidden="true" tabindex="-1"></a><span class="co"># df</span></span>
<span id="cb250-6"><a href="data-visualization-with-r.html#cb250-6" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/mpg.csv&quot;</span>) </span>
<span id="cb250-7"><a href="data-visualization-with-r.html#cb250-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-8"><a href="data-visualization-with-r.html#cb250-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb250-9"><a href="data-visualization-with-r.html#cb250-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb250-10"><a href="data-visualization-with-r.html#cb250-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;loess&#39;</span>)<span class="sc">+</span></span>
<span id="cb250-11"><a href="data-visualization-with-r.html#cb250-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Relationship between displacment and highway of 38 different car models&quot;</span>,</span>
<span id="cb250-12"><a href="data-visualization-with-r.html#cb250-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Feul economy data from 1999 to 2008&quot;</span>,</span>
<span id="cb250-13"><a href="data-visualization-with-r.html#cb250-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;source: https://fueleconomy.gov/&quot;</span>,</span>
<span id="cb250-14"><a href="data-visualization-with-r.html#cb250-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">&quot;Engine displacement in liters&quot;</span>,</span>
<span id="cb250-15"><a href="data-visualization-with-r.html#cb250-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Highway mileage&quot;</span>,</span>
<span id="cb250-16"><a href="data-visualization-with-r.html#cb250-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;vehicle class&quot;</span>)<span class="sc">+</span></span>
<span id="cb250-17"><a href="data-visualization-with-r.html#cb250-17" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme_pubr</span>()<span class="sc">+</span></span>
<span id="cb250-18"><a href="data-visualization-with-r.html#cb250-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grids</span>(<span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span></span>
<span id="cb250-19"><a href="data-visualization-with-r.html#cb250-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;grey20&quot;</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb250-20"><a href="data-visualization-with-r.html#cb250-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;grey20&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb250-21"><a href="data-visualization-with-r.html#cb250-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;italic&quot;</span>),</span>
<span id="cb250-22"><a href="data-visualization-with-r.html#cb250-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code></pre></div>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="data-visualization-with-r.html#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb251-2"><a href="data-visualization-with-r.html#cb251-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb251-3"><a href="data-visualization-with-r.html#cb251-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr) <span class="co"># read dataset from file</span></span>
<span id="cb251-4"><a href="data-visualization-with-r.html#cb251-4" aria-hidden="true" tabindex="-1"></a><span class="co"># df</span></span>
<span id="cb251-5"><a href="data-visualization-with-r.html#cb251-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/mpg.csv&quot;</span>) </span>
<span id="cb251-6"><a href="data-visualization-with-r.html#cb251-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-7"><a href="data-visualization-with-r.html#cb251-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb251-8"><a href="data-visualization-with-r.html#cb251-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb251-9"><a href="data-visualization-with-r.html#cb251-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;loess&#39;</span>)<span class="sc">+</span></span>
<span id="cb251-10"><a href="data-visualization-with-r.html#cb251-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>manufacturer)<span class="sc">+</span></span>
<span id="cb251-11"><a href="data-visualization-with-r.html#cb251-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Relationship between displacment and highway of 38 different car models&quot;</span>,</span>
<span id="cb251-12"><a href="data-visualization-with-r.html#cb251-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Feul economy data from 1999 to 2008&quot;</span>,</span>
<span id="cb251-13"><a href="data-visualization-with-r.html#cb251-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;source: https://fueleconomy.gov/&quot;</span>,</span>
<span id="cb251-14"><a href="data-visualization-with-r.html#cb251-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">&quot;Engine displacement in liters&quot;</span>,</span>
<span id="cb251-15"><a href="data-visualization-with-r.html#cb251-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Highway mileage&quot;</span>,</span>
<span id="cb251-16"><a href="data-visualization-with-r.html#cb251-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;vehicle class&quot;</span>)<span class="sc">+</span></span>
<span id="cb251-17"><a href="data-visualization-with-r.html#cb251-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubr</span>()<span class="sc">+</span></span>
<span id="cb251-18"><a href="data-visualization-with-r.html#cb251-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grids</span>(<span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span></span>
<span id="cb251-19"><a href="data-visualization-with-r.html#cb251-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;grey20&quot;</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb251-20"><a href="data-visualization-with-r.html#cb251-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;grey20&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb251-21"><a href="data-visualization-with-r.html#cb251-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;italic&quot;</span>),</span>
<span id="cb251-22"><a href="data-visualization-with-r.html#cb251-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code></pre></div>
</div>
<div id="bar-plot" class="section level3 hasAnchor" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> Bar Plot<a href="data-visualization-with-r.html#bar-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Stacked, clustered, or segmented bar charts are commonly used to show the relationship between two categorical variables.</p>
<div id="stacked-bar-chart" class="section level4 hasAnchor" number="4.1.3.1">
<h4><span class="header-section-number">4.1.3.1</span> Stacked bar chart<a href="data-visualization-with-r.html#stacked-bar-chart" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For the autos in the Fuel economy dataset, plot the association between automotive class and drive type (front-wheel, rear-wheel, or 4-wheel drive).</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="data-visualization-with-r.html#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb252-2"><a href="data-visualization-with-r.html#cb252-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb252-3"><a href="data-visualization-with-r.html#cb252-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr) <span class="co"># read dataset from file</span></span>
<span id="cb252-4"><a href="data-visualization-with-r.html#cb252-4" aria-hidden="true" tabindex="-1"></a><span class="co"># df</span></span>
<span id="cb252-5"><a href="data-visualization-with-r.html#cb252-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/mpg.csv&quot;</span>) </span>
<span id="cb252-6"><a href="data-visualization-with-r.html#cb252-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb252-7"><a href="data-visualization-with-r.html#cb252-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> class, <span class="at">fill=</span>drv)) <span class="sc">+</span> </span>
<span id="cb252-8"><a href="data-visualization-with-r.html#cb252-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">&quot;stack&quot;</span>) <span class="sc">+</span> </span>
<span id="cb252-9"><a href="data-visualization-with-r.html#cb252-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Vehicle class frequency by drive type for 38 different automobile models&quot;</span>,</span>
<span id="cb252-10"><a href="data-visualization-with-r.html#cb252-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Feul economy data from 1999 to 2008&quot;</span>,</span>
<span id="cb252-11"><a href="data-visualization-with-r.html#cb252-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;source: https://fueleconomy.gov/&quot;</span>,</span>
<span id="cb252-12"><a href="data-visualization-with-r.html#cb252-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;vehicle class&quot;</span>,</span>
<span id="cb252-13"><a href="data-visualization-with-r.html#cb252-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Count&quot;</span>)<span class="sc">+</span></span>
<span id="cb252-14"><a href="data-visualization-with-r.html#cb252-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubclean</span>()<span class="sc">+</span></span>
<span id="cb252-15"><a href="data-visualization-with-r.html#cb252-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grids</span>(<span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span></span>
<span id="cb252-16"><a href="data-visualization-with-r.html#cb252-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span><span class="fu">guide_legend</span>(<span class="st">&quot;Drive Type&quot;</span>))<span class="sc">+</span></span>
<span id="cb252-17"><a href="data-visualization-with-r.html#cb252-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;grey20&quot;</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb252-18"><a href="data-visualization-with-r.html#cb252-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;grey20&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb252-19"><a href="data-visualization-with-r.html#cb252-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;italic&quot;</span>),</span>
<span id="cb252-20"><a href="data-visualization-with-r.html#cb252-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code></pre></div>
<p><img src="Rmanual_files/figure-html/bar_mpg1-1.png" width="672" /></p>
</div>
<div id="grouped-bar-chart" class="section level4 hasAnchor" number="4.1.3.2">
<h4><span class="header-section-number">4.1.3.2</span> Grouped bar chart<a href="data-visualization-with-r.html#grouped-bar-chart" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="data-visualization-with-r.html#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb253-2"><a href="data-visualization-with-r.html#cb253-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb253-3"><a href="data-visualization-with-r.html#cb253-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr) <span class="co"># read dataset from file</span></span>
<span id="cb253-4"><a href="data-visualization-with-r.html#cb253-4" aria-hidden="true" tabindex="-1"></a><span class="co"># df</span></span>
<span id="cb253-5"><a href="data-visualization-with-r.html#cb253-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/mpg.csv&quot;</span>) </span>
<span id="cb253-6"><a href="data-visualization-with-r.html#cb253-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-7"><a href="data-visualization-with-r.html#cb253-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> class, <span class="at">fill=</span>drv)) <span class="sc">+</span> </span>
<span id="cb253-8"><a href="data-visualization-with-r.html#cb253-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span> </span>
<span id="cb253-9"><a href="data-visualization-with-r.html#cb253-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Vehicle class frequency by drive type for 38 different automobile models&quot;</span>,</span>
<span id="cb253-10"><a href="data-visualization-with-r.html#cb253-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Feul economy data from 1999 to 2008&quot;</span>,</span>
<span id="cb253-11"><a href="data-visualization-with-r.html#cb253-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;source: https://fueleconomy.gov/&quot;</span>,</span>
<span id="cb253-12"><a href="data-visualization-with-r.html#cb253-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;vehicle class&quot;</span>,</span>
<span id="cb253-13"><a href="data-visualization-with-r.html#cb253-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Count&quot;</span>)<span class="sc">+</span></span>
<span id="cb253-14"><a href="data-visualization-with-r.html#cb253-14" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme_pubclean</span>()<span class="sc">+</span></span>
<span id="cb253-15"><a href="data-visualization-with-r.html#cb253-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grids</span>(<span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span></span>
<span id="cb253-16"><a href="data-visualization-with-r.html#cb253-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span><span class="fu">guide_legend</span>(<span class="st">&quot;Drive Type&quot;</span>))<span class="sc">+</span></span>
<span id="cb253-17"><a href="data-visualization-with-r.html#cb253-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;grey20&quot;</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb253-18"><a href="data-visualization-with-r.html#cb253-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;grey20&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb253-19"><a href="data-visualization-with-r.html#cb253-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;italic&quot;</span>),</span>
<span id="cb253-20"><a href="data-visualization-with-r.html#cb253-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code></pre></div>
<p><img src="Rmanual_files/figure-html/bar_mpg2-1.png" width="672" /></p>
<p>Notice that front-wheel drive is standard on all Minivans. Zero count bars are removed by default, and the remaining bars are made broader. This may not be the desired behavior. The <code>position = position dodge(preserve = "single")</code> option can be used to change this.</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="data-visualization-with-r.html#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb254-2"><a href="data-visualization-with-r.html#cb254-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb254-3"><a href="data-visualization-with-r.html#cb254-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr) <span class="co"># read dataset from file</span></span>
<span id="cb254-4"><a href="data-visualization-with-r.html#cb254-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb254-5"><a href="data-visualization-with-r.html#cb254-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb254-6"><a href="data-visualization-with-r.html#cb254-6" aria-hidden="true" tabindex="-1"></a><span class="co"># df</span></span>
<span id="cb254-7"><a href="data-visualization-with-r.html#cb254-7" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/mpg.csv&quot;</span>) </span>
<span id="cb254-8"><a href="data-visualization-with-r.html#cb254-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-9"><a href="data-visualization-with-r.html#cb254-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> class, <span class="at">fill=</span>drv)) <span class="sc">+</span> </span>
<span id="cb254-10"><a href="data-visualization-with-r.html#cb254-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">preserve =</span> <span class="st">&quot;single&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb254-11"><a href="data-visualization-with-r.html#cb254-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Vehicle class frequency by drive type for 38 different automobile models&quot;</span>,</span>
<span id="cb254-12"><a href="data-visualization-with-r.html#cb254-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Feul economy data from 1999 to 2008&quot;</span>,</span>
<span id="cb254-13"><a href="data-visualization-with-r.html#cb254-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;source: https://fueleconomy.gov/&quot;</span>,</span>
<span id="cb254-14"><a href="data-visualization-with-r.html#cb254-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;vehicle class&quot;</span>,</span>
<span id="cb254-15"><a href="data-visualization-with-r.html#cb254-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Count&quot;</span>,</span>
<span id="cb254-16"><a href="data-visualization-with-r.html#cb254-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill=</span><span class="st">&quot;Drive type&quot;</span>)<span class="sc">+</span></span>
<span id="cb254-17"><a href="data-visualization-with-r.html#cb254-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubclean</span>()<span class="sc">+</span></span>
<span id="cb254-18"><a href="data-visualization-with-r.html#cb254-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grids</span>(<span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span></span>
<span id="cb254-19"><a href="data-visualization-with-r.html#cb254-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;grey20&quot;</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb254-20"><a href="data-visualization-with-r.html#cb254-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;grey20&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb254-21"><a href="data-visualization-with-r.html#cb254-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;italic&quot;</span>),</span>
<span id="cb254-22"><a href="data-visualization-with-r.html#cb254-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code></pre></div>
<p><img src="Rmanual_files/figure-html/bar_mpg3-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="boxplots" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Boxplots<a href="data-visualization-with-r.html#boxplots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A boxplot displays the <span class="math inline">\(25^{th}\)</span> percentile, median, and <span class="math inline">\(75^{th}\)</span> percentile of a distribution. The whiskers (vertical lines) capture roughly 99% of a normal distribution, and observations outside this range are plotted as points representing outliers (see the figure below).</p>
<div class="figure">
<img src="image/boxplot.png" width="600" alt="" />
<p class="caption">Boxplot schematics</p>
</div>
<p>We can use boxplots to visualize the distribution of weight within each species:</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="data-visualization-with-r.html#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb255-2"><a href="data-visualization-with-r.html#cb255-2" aria-hidden="true" tabindex="-1"></a><span class="co">#read the visual treatment for patients dataset</span></span>
<span id="cb255-3"><a href="data-visualization-with-r.html#cb255-3" aria-hidden="true" tabindex="-1"></a>df_vt <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;./data/visual_treatment.csv&quot;</span>)</span>
<span id="cb255-4"><a href="data-visualization-with-r.html#cb255-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df_vt, </span>
<span id="cb255-5"><a href="data-visualization-with-r.html#cb255-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color=</span>Day)) <span class="sc">+</span></span>
<span id="cb255-6"><a href="data-visualization-with-r.html#cb255-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb255-7"><a href="data-visualization-with-r.html#cb255-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>)</span></code></pre></div>
<p><img src="Rmanual_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
<ul>
<li>R appears to be unaware that the order should be <strong>One -&gt; Two -&gt; Three</strong>. Because the column Day is shown as <strong>chr&gt;</strong>, which indicates character, R chose to follow the alphabetical order.</li>
<li>When you want to display characters in a non-alphabetical order, factors are crucial. Factors are variables with a small number of possible values.</li>
<li>Individual data can sometimes be plotted on top of the boxplot. This can be accomplished in a variety of ways.</li>
<li>Using <em>geom jitter()</em>, here is a simple solution. For more information, type ?geom_jitter.</li>
</ul>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="data-visualization-with-r.html#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb256-2"><a href="data-visualization-with-r.html#cb256-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb256-3"><a href="data-visualization-with-r.html#cb256-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb256-4"><a href="data-visualization-with-r.html#cb256-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-5"><a href="data-visualization-with-r.html#cb256-5" aria-hidden="true" tabindex="-1"></a><span class="co">#read the visual treatment for patients dataset</span></span>
<span id="cb256-6"><a href="data-visualization-with-r.html#cb256-6" aria-hidden="true" tabindex="-1"></a>df_vt <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;./data/visual_treatment.csv&quot;</span>)</span>
<span id="cb256-7"><a href="data-visualization-with-r.html#cb256-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ordering the treatment</span></span>
<span id="cb256-8"><a href="data-visualization-with-r.html#cb256-8" aria-hidden="true" tabindex="-1"></a>df_vt<span class="sc">$</span>Day <span class="ot">&lt;-</span> <span class="fu">factor</span>(df_vt<span class="sc">$</span>Day, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;One&quot;</span>,<span class="st">&quot;Two&quot;</span>,<span class="st">&quot;Three&quot;</span>))</span>
<span id="cb256-9"><a href="data-visualization-with-r.html#cb256-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-10"><a href="data-visualization-with-r.html#cb256-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-11"><a href="data-visualization-with-r.html#cb256-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df_vt, </span>
<span id="cb256-12"><a href="data-visualization-with-r.html#cb256-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Value, <span class="at">color=</span>Day)) <span class="sc">+</span></span>
<span id="cb256-13"><a href="data-visualization-with-r.html#cb256-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb256-14"><a href="data-visualization-with-r.html#cb256-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width=</span><span class="fl">0.15</span>)<span class="sc">+</span> <span class="co"># show individual data</span></span>
<span id="cb256-15"><a href="data-visualization-with-r.html#cb256-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubclean</span>()<span class="sc">+</span> <span class="co"># change theme</span></span>
<span id="cb256-16"><a href="data-visualization-with-r.html#cb256-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grids</span>(<span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span> <span class="co"># modify grids type</span></span>
<span id="cb256-17"><a href="data-visualization-with-r.html#cb256-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Visual improvement after treatment&#39;</span>)<span class="sc">+</span> <span class="co"># add title </span></span>
<span id="cb256-18"><a href="data-visualization-with-r.html#cb256-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;grey20&quot;</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb256-19"><a href="data-visualization-with-r.html#cb256-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;grey20&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb256-20"><a href="data-visualization-with-r.html#cb256-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;italic&quot;</span>),</span>
<span id="cb256-21"><a href="data-visualization-with-r.html#cb256-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code></pre></div>
<p><img src="Rmanual_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
</div>
<div id="plotting-time-series-data" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Plotting time series data<a href="data-visualization-with-r.html#plotting-time-series-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s calculate number of counts per year for each genus. First we need to group the data and count records within each group:</p>
</div>
<div id="line-plot" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Line Plot<a href="data-visualization-with-r.html#line-plot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="data-visualization-with-r.html#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(country.map, <span class="at">package =</span> <span class="st">&quot;choroplethrMaps&quot;</span>)</span>
<span id="cb257-2"><a href="data-visualization-with-r.html#cb257-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">unique</span>(country.map<span class="sc">$</span>region), <span class="dv">30</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;afghanistan&quot; &quot;angola&quot;      &quot;azerbaijan&quot;  &quot;moldova&quot;     &quot;madagascar&quot; 
##  [6] &quot;mexico&quot;      &quot;macedonia&quot;   &quot;mali&quot;        &quot;myanmar&quot;     &quot;montenegro&quot; 
## [11] &quot;mongolia&quot;    &quot;mozambique&quot;  &quot;mauritania&quot;  &quot;burundi&quot;     &quot;malawi&quot;     
## [16] &quot;malaysia&quot;    &quot;namibia&quot;     &quot;france&quot;      &quot;niger&quot;       &quot;nigeria&quot;    
## [21] &quot;nicaragua&quot;   &quot;netherlands&quot; &quot;norway&quot;      &quot;nepal&quot;       &quot;belgium&quot;    
## [26] &quot;new zealand&quot; &quot;oman&quot;        &quot;pakistan&quot;    &quot;panama&quot;      &quot;peru&quot;</code></pre>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="data-visualization-with-r.html#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb259-2"><a href="data-visualization-with-r.html#cb259-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb259-3"><a href="data-visualization-with-r.html#cb259-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb259-4"><a href="data-visualization-with-r.html#cb259-4" aria-hidden="true" tabindex="-1"></a>gap <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/gapminder.csv&quot;</span>)</span>
<span id="cb259-5"><a href="data-visualization-with-r.html#cb259-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb259-6"><a href="data-visualization-with-r.html#cb259-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Select US cases</span></span>
<span id="cb259-7"><a href="data-visualization-with-r.html#cb259-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb259-8"><a href="data-visualization-with-r.html#cb259-8" aria-hidden="true" tabindex="-1"></a>plotdata <span class="ot">&lt;-</span> <span class="fu">filter</span>(gap, </span>
<span id="cb259-9"><a href="data-visualization-with-r.html#cb259-9" aria-hidden="true" tabindex="-1"></a>                   country <span class="sc">==</span> <span class="st">&quot;Ethiopia&quot;</span>)</span>
<span id="cb259-10"><a href="data-visualization-with-r.html#cb259-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb259-11"><a href="data-visualization-with-r.html#cb259-11" aria-hidden="true" tabindex="-1"></a><span class="co"># simple line plot</span></span>
<span id="cb259-12"><a href="data-visualization-with-r.html#cb259-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plotdata, </span>
<span id="cb259-13"><a href="data-visualization-with-r.html#cb259-13" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> year, </span>
<span id="cb259-14"><a href="data-visualization-with-r.html#cb259-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb259-15"><a href="data-visualization-with-r.html#cb259-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb259-16"><a href="data-visualization-with-r.html#cb259-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubr</span>()<span class="sc">+</span></span>
<span id="cb259-17"><a href="data-visualization-with-r.html#cb259-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grids</span>(<span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>)</span></code></pre></div>
<p><img src="Rmanual_files/figure-html/unnamed-chunk-57-1.png" width="672" /></p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="data-visualization-with-r.html#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb260-2"><a href="data-visualization-with-r.html#cb260-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb260-3"><a href="data-visualization-with-r.html#cb260-3" aria-hidden="true" tabindex="-1"></a>gap <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/gapminder.csv&quot;</span>)</span>
<span id="cb260-4"><a href="data-visualization-with-r.html#cb260-4" aria-hidden="true" tabindex="-1"></a><span class="co"># line plot with points</span></span>
<span id="cb260-5"><a href="data-visualization-with-r.html#cb260-5" aria-hidden="true" tabindex="-1"></a><span class="co"># and improved labeling</span></span>
<span id="cb260-6"><a href="data-visualization-with-r.html#cb260-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plotdata, </span>
<span id="cb260-7"><a href="data-visualization-with-r.html#cb260-7" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> year, </span>
<span id="cb260-8"><a href="data-visualization-with-r.html#cb260-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb260-9"><a href="data-visualization-with-r.html#cb260-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>, </span>
<span id="cb260-10"><a href="data-visualization-with-r.html#cb260-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;lightgrey&quot;</span>) <span class="sc">+</span></span>
<span id="cb260-11"><a href="data-visualization-with-r.html#cb260-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, </span>
<span id="cb260-12"><a href="data-visualization-with-r.html#cb260-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;steelblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb260-13"><a href="data-visualization-with-r.html#cb260-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Life Expectancy (years)&quot;</span>, </span>
<span id="cb260-14"><a href="data-visualization-with-r.html#cb260-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb260-15"><a href="data-visualization-with-r.html#cb260-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Life expectancy changes over time&quot;</span>,</span>
<span id="cb260-16"><a href="data-visualization-with-r.html#cb260-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Ethiopia (1952-2007)&quot;</span>,</span>
<span id="cb260-17"><a href="data-visualization-with-r.html#cb260-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;Source: http://www.gapminder.org/data/&quot;</span>)<span class="sc">+</span></span>
<span id="cb260-18"><a href="data-visualization-with-r.html#cb260-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubclean</span>()<span class="sc">+</span></span>
<span id="cb260-19"><a href="data-visualization-with-r.html#cb260-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grids</span>(<span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>)</span></code></pre></div>
<p><img src="Rmanual_files/figure-html/unnamed-chunk-58-1.png" width="672" /></p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="data-visualization-with-r.html#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare dataset</span></span>
<span id="cb261-2"><a href="data-visualization-with-r.html#cb261-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(gapminder, <span class="at">package =</span> <span class="st">&quot;gapminder&quot;</span>)</span>
<span id="cb261-3"><a href="data-visualization-with-r.html#cb261-3" aria-hidden="true" tabindex="-1"></a>plotdata <span class="ot">&lt;-</span> gapminder <span class="sc">%&gt;%</span></span>
<span id="cb261-4"><a href="data-visualization-with-r.html#cb261-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span></span>
<span id="cb261-5"><a href="data-visualization-with-r.html#cb261-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">region =</span> country,</span>
<span id="cb261-6"><a href="data-visualization-with-r.html#cb261-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">value =</span> lifeExp) <span class="sc">%&gt;%</span></span>
<span id="cb261-7"><a href="data-visualization-with-r.html#cb261-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">region =</span> <span class="fu">tolower</span>(region)) <span class="sc">%&gt;%</span></span>
<span id="cb261-8"><a href="data-visualization-with-r.html#cb261-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">region =</span> <span class="fu">recode</span>(region,</span>
<span id="cb261-9"><a href="data-visualization-with-r.html#cb261-9" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;united states&quot;</span>    <span class="ot">=</span> <span class="st">&quot;united states of america&quot;</span>,</span>
<span id="cb261-10"><a href="data-visualization-with-r.html#cb261-10" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;congo, dem. rep.&quot;</span> <span class="ot">=</span> <span class="st">&quot;democratic republic of the congo&quot;</span>,</span>
<span id="cb261-11"><a href="data-visualization-with-r.html#cb261-11" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;congo, rep.&quot;</span>      <span class="ot">=</span> <span class="st">&quot;republic of congo&quot;</span>,</span>
<span id="cb261-12"><a href="data-visualization-with-r.html#cb261-12" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;korea, dem. rep.&quot;</span> <span class="ot">=</span> <span class="st">&quot;south korea&quot;</span>,</span>
<span id="cb261-13"><a href="data-visualization-with-r.html#cb261-13" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;korea. rep.&quot;</span>      <span class="ot">=</span> <span class="st">&quot;north korea&quot;</span>,</span>
<span id="cb261-14"><a href="data-visualization-with-r.html#cb261-14" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;tanzania&quot;</span>         <span class="ot">=</span> <span class="st">&quot;united republic of tanzania&quot;</span>,</span>
<span id="cb261-15"><a href="data-visualization-with-r.html#cb261-15" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;serbia&quot;</span>           <span class="ot">=</span> <span class="st">&quot;republic of serbia&quot;</span>,</span>
<span id="cb261-16"><a href="data-visualization-with-r.html#cb261-16" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;slovak republic&quot;</span>  <span class="ot">=</span> <span class="st">&quot;slovakia&quot;</span>,</span>
<span id="cb261-17"><a href="data-visualization-with-r.html#cb261-17" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;ethiopia&quot;</span>         <span class="ot">=</span> <span class="st">&quot;democratic republic of ethiopia&quot;</span>,</span>
<span id="cb261-18"><a href="data-visualization-with-r.html#cb261-18" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;yemen, rep.&quot;</span>      <span class="ot">=</span> <span class="st">&quot;yemen&quot;</span>))</span></code></pre></div>
<p>Now lets create the map</p>
</div>
<div id="histograpm" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Histograpm<a href="data-visualization-with-r.html#histograpm" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="data-visualization-with-r.html#cb262-1" aria-hidden="true" tabindex="-1"></a>Marriage <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/marriage.csv&quot;</span>)</span>
<span id="cb262-2"><a href="data-visualization-with-r.html#cb262-2" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the histogram with a binwidth of 5</span></span>
<span id="cb262-3"><a href="data-visualization-with-r.html#cb262-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Marriage, <span class="fu">aes</span>(<span class="at">x =</span> age)) <span class="sc">+</span></span>
<span id="cb262-4"><a href="data-visualization-with-r.html#cb262-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">&quot;cornflowerblue&quot;</span>, </span>
<span id="cb262-5"><a href="data-visualization-with-r.html#cb262-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb262-6"><a href="data-visualization-with-r.html#cb262-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">binwidth =</span> <span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb262-7"><a href="data-visualization-with-r.html#cb262-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Participants by age&quot;</span>, </span>
<span id="cb262-8"><a href="data-visualization-with-r.html#cb262-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;binwidth = 5 years&quot;</span>,</span>
<span id="cb262-9"><a href="data-visualization-with-r.html#cb262-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Age&quot;</span>)</span></code></pre></div>
<p><img src="Rmanual_files/figure-html/unnamed-chunk-60-1.png" width="672" /></p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="data-visualization-with-r.html#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(gapminder, <span class="at">package=</span><span class="st">&quot;gapminder&quot;</span>)</span>
<span id="cb263-2"><a href="data-visualization-with-r.html#cb263-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-3"><a href="data-visualization-with-r.html#cb263-3" aria-hidden="true" tabindex="-1"></a><span class="co"># subset Asian countries in 2007</span></span>
<span id="cb263-4"><a href="data-visualization-with-r.html#cb263-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb263-5"><a href="data-visualization-with-r.html#cb263-5" aria-hidden="true" tabindex="-1"></a>plotdata <span class="ot">&lt;-</span> gapminder <span class="sc">%&gt;%</span></span>
<span id="cb263-6"><a href="data-visualization-with-r.html#cb263-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(continent <span class="sc">==</span> <span class="st">&quot;Africa&quot;</span> <span class="sc">&amp;</span> </span>
<span id="cb263-7"><a href="data-visualization-with-r.html#cb263-7" aria-hidden="true" tabindex="-1"></a>         year <span class="sc">==</span> <span class="dv">2007</span>)</span>
<span id="cb263-8"><a href="data-visualization-with-r.html#cb263-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-9"><a href="data-visualization-with-r.html#cb263-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Sorted Cleveland plot</span></span>
<span id="cb263-10"><a href="data-visualization-with-r.html#cb263-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plotdata, </span>
<span id="cb263-11"><a href="data-visualization-with-r.html#cb263-11" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span>lifeExp, </span>
<span id="cb263-12"><a href="data-visualization-with-r.html#cb263-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">y=</span><span class="fu">reorder</span>(country, lifeExp))) <span class="sc">+</span></span>
<span id="cb263-13"><a href="data-visualization-with-r.html#cb263-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">&quot;blue&quot;</span>, </span>
<span id="cb263-14"><a href="data-visualization-with-r.html#cb263-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb263-15"><a href="data-visualization-with-r.html#cb263-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">40</span>, </span>
<span id="cb263-16"><a href="data-visualization-with-r.html#cb263-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">xend =</span> lifeExp, </span>
<span id="cb263-17"><a href="data-visualization-with-r.html#cb263-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="fu">reorder</span>(country, lifeExp), </span>
<span id="cb263-18"><a href="data-visualization-with-r.html#cb263-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">yend =</span> <span class="fu">reorder</span>(country, lifeExp)),</span>
<span id="cb263-19"><a href="data-visualization-with-r.html#cb263-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;lightgrey&quot;</span>) <span class="sc">+</span></span>
<span id="cb263-20"><a href="data-visualization-with-r.html#cb263-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span> (<span class="at">x =</span> <span class="st">&quot;Life Expectancy (years)&quot;</span>,</span>
<span id="cb263-21"><a href="data-visualization-with-r.html#cb263-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb263-22"><a href="data-visualization-with-r.html#cb263-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">&quot;Life Expectancy by Country&quot;</span>,</span>
<span id="cb263-23"><a href="data-visualization-with-r.html#cb263-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">subtitle =</span> <span class="st">&quot;GapMinder data for Africa - 2007&quot;</span>) <span class="sc">+</span></span>
<span id="cb263-24"><a href="data-visualization-with-r.html#cb263-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb263-25"><a href="data-visualization-with-r.html#cb263-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb263-26"><a href="data-visualization-with-r.html#cb263-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="Rmanual_files/figure-html/unnamed-chunk-61-1.png" width="672" /></p>
<ul>
<li>Reunion clearly has the highest life expectancy, while Afghanistan has the lowest by far. This last plot is also called a lollipop graph (you can see why).</li>
</ul>
</div>
<div id="arranging-plots-into-a-grid" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> Arranging plots into a grid<a href="data-visualization-with-r.html#arranging-plots-into-a-grid" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The cowplot package provides the function plot_grid() to arrange plots into a grid and label them.</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="data-visualization-with-r.html#cb264-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(disp, mpg, <span class="at">color=</span><span class="fu">as.factor</span>(cyl))) <span class="sc">+</span> </span>
<span id="cb264-2"><a href="data-visualization-with-r.html#cb264-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb264-3"><a href="data-visualization-with-r.html#cb264-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb264-4"><a href="data-visualization-with-r.html#cb264-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">&#39;Engine displament in litters&#39;</span>,</span>
<span id="cb264-5"><a href="data-visualization-with-r.html#cb264-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span> <span class="st">&quot;Mileage Per Hour&quot;</span>,</span>
<span id="cb264-6"><a href="data-visualization-with-r.html#cb264-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">color=</span><span class="st">&quot;Vehicle Cylinder Type&quot;</span>)<span class="sc">+</span></span>
<span id="cb264-7"><a href="data-visualization-with-r.html#cb264-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>()<span class="sc">+</span></span>
<span id="cb264-8"><a href="data-visualization-with-r.html#cb264-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&#39;grey20&#39;</span>,</span>
<span id="cb264-9"><a href="data-visualization-with-r.html#cb264-9" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">size=</span><span class="dv">10</span>,</span>
<span id="cb264-10"><a href="data-visualization-with-r.html#cb264-10" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">angle =</span> <span class="dv">0</span>,</span>
<span id="cb264-11"><a href="data-visualization-with-r.html#cb264-11" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">hjust=</span><span class="fl">0.5</span>,</span>
<span id="cb264-12"><a href="data-visualization-with-r.html#cb264-12" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">vjust=</span><span class="fl">0.5</span>),</span>
<span id="cb264-13"><a href="data-visualization-with-r.html#cb264-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&#39;grey20&#39;</span>,</span>
<span id="cb264-14"><a href="data-visualization-with-r.html#cb264-14" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb264-15"><a href="data-visualization-with-r.html#cb264-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&#39;italic&#39;</span>),</span>
<span id="cb264-16"><a href="data-visualization-with-r.html#cb264-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb264-17"><a href="data-visualization-with-r.html#cb264-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-18"><a href="data-visualization-with-r.html#cb264-18" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(qsec, mpg, <span class="at">color=</span><span class="fu">as.factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb264-19"><a href="data-visualization-with-r.html#cb264-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb264-20"><a href="data-visualization-with-r.html#cb264-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb264-21"><a href="data-visualization-with-r.html#cb264-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&#39;Souce: https://fueleconomy.gov&#39;</span>,</span>
<span id="cb264-22"><a href="data-visualization-with-r.html#cb264-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">&#39;Engine displament in litters&#39;</span>,</span>
<span id="cb264-23"><a href="data-visualization-with-r.html#cb264-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span> <span class="st">&quot;Mileage Per Hour&quot;</span>,</span>
<span id="cb264-24"><a href="data-visualization-with-r.html#cb264-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">color=</span><span class="st">&quot;Vehicle Cylider Type&quot;</span>)<span class="sc">+</span></span>
<span id="cb264-25"><a href="data-visualization-with-r.html#cb264-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>()<span class="sc">+</span></span>
<span id="cb264-26"><a href="data-visualization-with-r.html#cb264-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&#39;grey20&#39;</span>,</span>
<span id="cb264-27"><a href="data-visualization-with-r.html#cb264-27" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">size=</span><span class="dv">10</span>,</span>
<span id="cb264-28"><a href="data-visualization-with-r.html#cb264-28" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">angle =</span> <span class="dv">0</span>,</span>
<span id="cb264-29"><a href="data-visualization-with-r.html#cb264-29" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">hjust=</span><span class="fl">0.5</span>,</span>
<span id="cb264-30"><a href="data-visualization-with-r.html#cb264-30" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">vjust=</span><span class="fl">0.5</span>),</span>
<span id="cb264-31"><a href="data-visualization-with-r.html#cb264-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&#39;grey20&#39;</span>,</span>
<span id="cb264-32"><a href="data-visualization-with-r.html#cb264-32" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb264-33"><a href="data-visualization-with-r.html#cb264-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&#39;italic&#39;</span>),</span>
<span id="cb264-34"><a href="data-visualization-with-r.html#cb264-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb264-35"><a href="data-visualization-with-r.html#cb264-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-36"><a href="data-visualization-with-r.html#cb264-36" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(p1, p2, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;A&#39;</span>, <span class="st">&#39;B&#39;</span>), <span class="at">label_size =</span> <span class="dv">12</span>,<span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">&quot;h&quot;</span>)</span></code></pre></div>
<p><img src="Rmanual_files/figure-html/unnamed-chunk-62-1.png" width="672" /></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-analysis-with-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="special-ggplot2-plotting-extensions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/mesfind/Proposal/edit/master/Chapter3.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["Rmanual.pdf", "PDF"], ["Rmanual.epub", "EPUB"], ["Rmanual.docx", "Word"]],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
